(this.webpackJsonppiek=this.webpackJsonppiek||[]).push([[0],{101:function(e,t,n){e.exports={attendanceLayout:"attendance_attendanceLayout__3ZkJT",tableWrapper:"attendance_tableWrapper__32pvV",attendanceTable:"attendance_attendanceTable__36c11",interval:"attendance_interval__3CNBY","status-101":"attendance_status-101__3aCi6",tableSearchInput:"attendance_tableSearchInput__hHxoD",tableFooter:"attendance_tableFooter__3W2nf"}},111:function(e,t,n){e.exports={inputWrapper:"archive_inputWrapper__3nHE2",archiveTable:"archive_archiveTable__1BwU5",filterFormControl:"archive_filterFormControl__1DXa5",filterInputBase:"archive_filterInputBase__2Du59"}},127:function(e,t,n){e.exports={tableSearchInput:"search_tableSearchInput__mHzTe",filter:"search_filter__1BI6Q",filterPlaceholder:"search_filterPlaceholder__2NcNB",filterIndicator:"search_filterIndicator__Rfc0e",circle:"search_circle__2PIMx",pulsate:"search_pulsate__pgEiY"}},128:function(e,t,n){e.exports={actionsWrapper:"OrderItemActions_actionsWrapper__1mryM",deleteButton:"OrderItemActions_deleteButton__14fyW",moreVertIcon:"OrderItemActions_moreVertIcon__3Qdex",inputListItem:"OrderItemActions_inputListItem__22HbZ"}},172:function(e,t,n){e.exports={themeToggleButtons:"SettingsDrawer_themeToggleButtons__hIzSP",user:"SettingsDrawer_user__3iVNA",logoutButton:"SettingsDrawer_logoutButton__2_Id_"}},209:function(e,t,n){e.exports={heading:"recently_heading__2gRdv",recentlyTable:"recently_recentlyTable__3NJpR"}},308:function(e,t,n){e.exports={preOrdersTableWrapper:"preorders_preOrdersTableWrapper__2ELAZ"}},357:function(e,t){},359:function(e,t){},374:function(e,t){},376:function(e,t){},404:function(e,t){},406:function(e,t){},407:function(e,t){},412:function(e,t){},414:function(e,t){},420:function(e,t){},422:function(e,t){},441:function(e,t){},453:function(e,t){},456:function(e,t){},46:function(e,t,n){e.exports={commentsListWrapper:"Comments_commentsListWrapper__25Ylk",commentInputForm:"Comments_commentInputForm__2W6Of",checklistUnit:"Comments_checklistUnit__2rS_e",checklistUnit_complited:"Comments_checklistUnit_complited__1J6jW",saveButton:"Comments_saveButton__FkrZB",commentUnit:"Comments_commentUnit__1L_o5",actions:"Comments_actions__2pxUd",commentContent:"Comments_commentContent__EsGgq",commentHeader:"Comments_commentHeader__3aEgO",sender:"Comments_sender__3ld3S",time:"Comments_time__2egg6"}},497:function(e,t,n){},509:function(e,t,n){},510:function(e,t,n){},511:function(e,t,n){},512:function(e,t,n){},513:function(e,t,n){},514:function(e,t,n){},533:function(e,t,n){},534:function(e,t,n){},544:function(e,t,n){"use strict";n.r(t),n.d(t,"Context",(function(){return Tr}));var r=n(7),a=n(26),c=n(25),i=n.n(c),s=n(33),o=n(1),d=n(64),u=n.n(d),l=n(302),j=n.n(l),b=n(10),O=n(315),m=n(38),p=n(0),h=["component"],f=function(e){var t=e.component,n=Object(a.a)(e,h),c=Object(o.useContext)(Tr).store,d=Object(o.useState)(!1),u=Object(b.a)(d,2),l=u[0],j=u[1],O=Object(o.useState)(c.inMemoryToken),f=Object(b.a)(O,2),x=f[0],v=f[1];function g(){return(g=Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.checkAuth().then((function(e){v(e),j(!0)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(o.useEffect)((function(){x?j(!0):function(){g.apply(this,arguments)}()}),[]),Object(p.jsx)(m.b,Object(r.a)(Object(r.a)({},n),{},{render:function(e){if(l)return x?Object(p.jsx)(t,Object(r.a)({},e)):Object(p.jsx)(m.a,{to:"/login"})}}))},x=n(161),v=n.n(x),g=n(625),I=n(639),D=(n(497),n(498),function(){var e=Object(o.useState)(""),t=Object(b.a)(e,2),n=t[0],r=t[1],a=Object(o.useState)(""),c=Object(b.a)(a,2),d=c[0],u=c[1],l=Object(o.useContext)(Tr).store,j=Object(m.g)(),O=function(){var e=Object(s.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.login(n,d);case 2:200===(null===(t=e.sent)||void 0===t?void 0:t.status)?j.push("/"):(console.error("Invalig email or password"),r="warning",a="Unauthorized error",c="Invalig email or password",x.store.addNotification({title:a,message:c,type:r,insert:"bottom",container:"top-right",dismiss:{duration:4e3}}));case 4:case"end":return e.stop()}var r,a,c}),e)})));return function(){return e.apply(this,arguments)}}();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(v.a,{}),Object(p.jsxs)("div",{className:"loginCard",children:[Object(p.jsx)(g.a,{className:"loginInput",variant:"filled",label:"Email",onChange:function(e){return r(e.target.value.trim())}}),Object(p.jsx)(g.a,{label:"Password",type:"password",variant:"filled",className:"loginInput",onChange:function(e){return u(e.target.value.trim())}}),Object(p.jsx)(I.a,{className:"Button",variant:"outlined",width:"300px",onClick:O,children:"\u0412\u043e\u0439\u0442\u0438"})]})]})}),y=n(3);function _(e,t){switch(t.type){case"orders":case"preOrders":case"selectedTab":case"searchKeyword":case"managerFilter":return Object(r.a)(Object(r.a)({},e),{},Object(y.a)({},t.type,t.payload));case"resetFilters":return Object(r.a)(Object(r.a)({},e),{},{searchKeyword:"",managerFilter:0});default:return Object(r.a)({},e)}}var N,C,k,w=n(24),S=n(21),M=n(20),A=Object(M.a)(N||(N=Object(S.a)(["\nsubscription{\n    erp_Orders(where: {OrderStatusID: {_in: [1,2]} }) {\n      OrderID\n      Entity\n      InvoiceNumber\n      City\n      ShippingDate\n      AcceptanceDate\n      PaidAmount\n      TotalAmount\n      AwaitingDispatch\n      NeedAttention\n      CreatingDate\n      ManagerID\n      OrderStatus {\n        Name\n        ID\n      }\n      OrderItems(order_by: {OrderItemID: asc}){\n        Quantity\n        OrderItemID\n        Name\n        OrderID\n      } \n      User {\n        FirstName\n        LastName\n      }\n\n    }  \n  }\n"]))),T=Object(M.a)(C||(C=Object(S.a)(["\nquery getUsers {\n  erp_Users{\n    FirstName\n    LastName\n    UserID\n    AccessLevelID\n  }\n}\n"]))),F=Object(M.b)(k||(k=Object(S.a)(["\nmutation MyMutation($managerID: Int!, $orderStatusID: Int!) {\n  insert_erp_Orders(objects: {ManagerID: $managerID, OrderStatusID:  $orderStatusID}) {\n    returning {\n      OrderID\n    }\n  }\n}\n"]))),L=n(620),$=n(640),P=n(633),U=n(8),H=n(596),E=n(60),R=n.n(E),q=n(35),W=n(41),B=n(45),Y=n.n(B),z=[{Header:"",id:"index",accessor:function(e,t){return t+1}},{Header:"\u041d\u0430\u0438\u043c.",id:"orderItems",accessor:function(e){return 0===e.OrderItems.length?Object(p.jsx)(W.b,{to:"/orders/".concat(e.OrderID),children:Object(p.jsx)("div",{children:"\u041d\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e"})}):Object(p.jsx)(W.b,{to:"/orders/".concat(e.OrderID),children:e.OrderItems.map((function(e){return Object(p.jsx)("div",{children:Object(p.jsx)("span",{children:e.Name})},e.OrderItemID)}))})}},{Header:"\u041a\u043e\u043b-\u0432\u043e",accessor:function(e){return e.OrderItems.map((function(e){return Object(p.jsx)("div",{children:Object(p.jsx)("div",{children:e.Quantity})},e.OrderItemID)}))}},{Header:"\u041e\u0442\u0433\u0440\u0443\u0437\u043a\u0430",accessor:function(e){return Object(p.jsxs)(p.Fragment,{children:[" ",e.ShippingDate&&Y()(e.ShippingDate).format("DD.MM.YY")," "]})}},{Header:"\u041a\u043e\u043c\u043f\u0430\u043d\u0438\u044f / \u0433\u043e\u0440\u043e\u0434",accessor:function(e){return Object(p.jsxs)("div",{className:R.a.customerTableInfo,children:[Object(p.jsx)("div",{children:e.Entity}),Object(p.jsx)("div",{children:e.City})]})}},{Header:"\u0421\u0447\u0435\u0442- \u043e\u043f\u043b\u0430\u0442\u0430",accessor:function(e){return e.InvoiceNumber+(t=e.TotalAmount,n=e.PaidAmount,t&&n?" - "+(n/t*100).toFixed(0)+"%":" - 0%");var t,n}},{Header:"\u041c\u0434\u0436.",accessor:function(e){var t;return Object(p.jsxs)(p.Fragment,{children:[" ",(null===(t=e.User)||void 0===t?void 0:t.FirstName[0])||""," "]})}}],Q=n(123);function K(e){var t=e.columns,n=e.data,a=e.className,c=Object(Q.useTable)({columns:t,data:n}),i=c.getTableProps,s=c.getTableBodyProps,o=c.headerGroups,d=c.rows,u=c.prepareRow;return 0===n.length?null:Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("table",Object(r.a)(Object(r.a)({className:"".concat(R.a.tableMain," ").concat(a)},i()),{},{children:[Object(p.jsx)("thead",{children:o.map((function(e,t){return Object(p.jsx)("tr",Object(r.a)(Object(r.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e,t){return Object(p.jsx)("th",Object(r.a)(Object(r.a)({},e.getHeaderProps()),{},{children:e.render("Header")}))}))}),t)}))}),Object(p.jsx)("tbody",Object(r.a)(Object(r.a)({},s()),{},{children:d.map((function(e,t){return u(e),Object(p.jsx)("tr",Object(r.a)(Object(r.a)({className:(n=e.original,n.NeedAttention?R.a.needAttention:n.AwaitingDispatch?R.a.awaitingDispatch:"")},e.getRowProps()),{},{children:e.cells.map((function(e,t){return Object(p.jsx)("td",Object(r.a)(Object(r.a)({},e.getCellProps()),{},{children:e.render("Cell")}))}))}));var n}))}))]}))})}var V=n(593),G=n(127),J=n.n(G),Z=n(636),X=n(621),ee=n(630),te=function(e){var t=e.state,n=e.dispatch,r=e.users;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:J.a.tableSearchInput,children:[Object(p.jsx)(V.a,{}),Object(p.jsx)("input",{type:"text",placeholder:"\u0421\u0447\u0435\u0442 \u0438\u043b\u0438 \u044e\u0440\u043b\u0438\u0446\u043e",onChange:function(e){n({type:"searchKeyword",payload:e.target.value})},autoFocus:!0,defaultValue:t.searchKeyword}),r&&Object(p.jsxs)("div",{className:J.a.filter,children:[Object(p.jsx)("span",{className:J.a.filterPlaceholder,children:"manager"}),Object(p.jsx)(Z.a,{children:Object(p.jsxs)(X.a,{name:"managerFilter",value:t.managerFilter,onChange:function(e){n({type:"managerFilter",payload:e.target.value})},children:[Object(p.jsx)(ee.a,{value:0,children:"\u0412\u0441\u0435"}),r.map((function(e){return Object(p.jsxs)(ee.a,{value:e.UserID,children:[" ","".concat(e.FirstName," ").concat(e.LastName)," "]},e.UserID)}))]})})]})]}),function(){if(0!==t.managerFilter)return Object(p.jsxs)("div",{className:J.a.filterIndicator,children:[Object(p.jsx)("div",{className:J.a.circle}),Object(p.jsx)("p",{children:"\u0412\u044b\u0434\u0430\u0447\u0430 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u043c"})]})}(t.managerFilter)]})};function ne(e){for(var t=!1,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.map((function(n){n&&n.toLowerCase().includes(e.toLowerCase())&&(t=!0)})),!!t}var re,ae,ce=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if(r=""!==t?e.filter((function(e){return ne(t,e.InvoiceNumber,e.Entity)})):e,0!==n){var a=[];return r.map((function(e){e.ManagerID===n&&a.push(e)})),a}return r},ie=Object(M.b)(re||(re=Object(S.a)(["\n    mutation MyMutation($OrderID: Int!, $AcceptanceDate: timestamptz!){\n    update_erp_Orders_by_pk(\n      pk_columns: {OrderID: $OrderID},\n       _set: {\n         OrderStatusID: 2,\n         AcceptanceDate: $AcceptanceDate,\n         }\n      ) {\n        OrderID\n    }\n  }\n\n"]))),se=n(594),oe=n(308),de=n.n(oe),ue=function(e){var t=e.state,n=e.dispatch,r=t.preOrders,a=Object(w.useMutation)(ie),c=Object(b.a)(a,1)[0],i=function(e){r.splice(r.indexOf(e),1),n({type:"preOrders",payload:r}),c({variables:{OrderID:e.OrderID,AcceptanceDate:(new Date).toLocaleString("en-US",{timeZone:"Europe/Moscow"})}})},s=Object(q.a)(z),o=ce(r,t.searchKeyword);return s.push({Header:"\u041f\u0440\u0438\u043d\u044f\u0442\u044c",accessor:function(e){return Object(p.jsx)(I.a,{onClick:function(){return i(e)},variant:"iconic",children:Object(p.jsx)(se.a,{})})}}),Object(p.jsxs)("div",{className:"".concat(R.a.tableWrapper," ").concat(de.a.preOrdersTableWrapper),children:[Object(p.jsx)(te,{state:t,dispatch:n}),o&&Object(p.jsx)(K,{columns:s,data:o})]})},le=function(e){var t=e.users,n=e.state,r=e.dispatch,a=Object(o.useMemo)((function(){return z}),[]),c=n.orders.sort((function(e,t){return new Date(e.ShippingDate)-new Date(t.ShippingDate)})),i=ce(c,n.searchKeyword,n.managerFilter);return Object(p.jsxs)("div",{className:R.a.tableWrapper,children:[t&&Object(p.jsx)(te,{state:n,dispatch:r,users:t.filter((function(e){return[1,2].includes(null===e||void 0===e?void 0:e.AccessLevelID)}))}),i&&Object(p.jsx)(K,{columns:a,data:i})]})},je=n(310),be=n(174),Oe=n(209),me=n.n(Oe),pe=function(e){var t=e.state,n=(e.dispatch,function(e){var t,n=[{name:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",date:Y()().subtract(0,"day").format("YYYY-MM-DD"),objs:[]},{name:"\u0412\u0447\u0435\u0440\u0430",date:Y()().subtract(1,"day").format("YYYY-MM-DD"),objs:[]},{name:"",objs:[]}],r=Object(je.a)(e);try{for(r.s();!(t=r.n()).done;){var a,c=t.value,i=null===(a=c.AcceptanceDate)||void 0===a?void 0:a.split("T")[0];i===n[0].date?n[0].objs.push(c):i===n[1].date?n[1].objs.push(c):n[2].objs.push(c)}}catch(s){r.e(s)}finally{r.f()}return n}(t.orders.sort((function(e,t){return new Date(t.AcceptanceDate)-new Date(e.AcceptanceDate)})))),r=Object(o.useMemo)((function(){return z}),[]);ce(n[2].objs,t.searchKeyword);return Object(p.jsxs)("div",{children:[Object(p.jsx)(be.a,{color:"textSecondary",variant:"subtitle1",m:"10px 0",children:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f"}),n[0].objs.length?Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(K,{columns:r,data:n[0].objs,className:me.a.recentlyTable})}):null,Object(p.jsx)(be.a,{color:"textSecondary",variant:"subtitle1",m:"10px 0",children:"\u0412\u0447\u0435\u0440\u0430"}),n[1].objs.length?Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(K,{columns:r,data:n[1].objs,className:me.a.recentlyTable})}):null]})},he=Object(M.b)(ae||(ae=Object(S.a)(["\n  query ($keyword: String!, $OrderStatus: Int!){\n  erp_Orders(where: {\n    _or: [\n      { Entity: {_ilike: $keyword} }, \n      { InvoiceNumber: {_ilike: $keyword} }\n\n      ],\n    OrderStatusID: {_eq: $OrderStatus}\n    }) {\n      ActualShippingDate\n      AwaitingDispatch\n      OrderID\n      Entity\n      InvoiceNumber\n      City\n      ShippingDate\n      PaidAmount\n      TotalAmount\n      CreatingDate\n      ManagerID\n      OrderItems {\n        Quantity\n        OrderItemID\n        Name\n      } \n      User {\n        FirstName\n      }\n  }\n}\n"]))),fe=n(111),xe=n.n(fe);function ve(e){var t=e.columns,n=e.data,a=e.className,c=Object(Q.useTable)({columns:t,data:n}),i=c.getTableProps,s=c.getTableBodyProps,o=c.headerGroups,d=c.rows,u=c.prepareRow;return 0===n.length?Object(p.jsx)(be.a,{color:"textSecondary",variant:"subtitle2",children:"-> \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"}):Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("table",Object(r.a)(Object(r.a)({className:"".concat(R.a.tableMain," ").concat(a)},i()),{},{children:[Object(p.jsx)("thead",{children:o.map((function(e,t){return Object(p.jsx)("tr",Object(r.a)(Object(r.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e,t){return Object(p.jsx)("th",Object(r.a)(Object(r.a)({},e.getHeaderProps()),{},{children:e.render("Header")}))}))}),t)}))}),Object(p.jsx)("tbody",Object(r.a)(Object(r.a)({},s()),{},{children:d.map((function(e,t){u(e);var n=e.original.unpaid;return Object(p.jsx)("tr",Object(r.a)(Object(r.a)({className:n?R.a.unpaidOrder:""},e.getRowProps()),{},{children:e.cells.map((function(e,t){return Object(p.jsx)("td",Object(r.a)(Object(r.a)({},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]}))})}var ge,Ie,De,ye=n(56),_e=Object(M.b)(ge||(ge=Object(S.a)(["\nquery{\n  erp_Orders(\n    where: {OrderStatusID: {_eq: 3}},\n    order_by: {OrderID: desc},\n    limit: 1000,\n    ){\n\t\tOrderID\n    PaidAmount\n    TotalAmount\n  }\n}\n"]))),Ne=Object(M.b)(Ie||(Ie=Object(S.a)(["\nquery($limit: Int!, $OrderStatus: Int!){\n  erp_Orders(\n    order_by: {ActualShippingDate: desc_nulls_last}\n    where: { OrderStatusID: {_eq: $OrderStatus } } \n    limit: $limit\n    ){\n    ActualShippingDate\n    ShippingDate\n    AwaitingDispatch\n    OrderID\n    Entity\n    InvoiceNumber\n    City\n    PaidAmount\n    TotalAmount\n    CreatingDate\n    ManagerID\n    OrderItems {\n      Quantity\n      OrderItemID\n      Name\n    } \n    User {\n      FirstName\n    }\n  }\n}\n"]))),Ce=Object(M.b)(De||(De=Object(S.a)(["\nquery MyQuery($unpaidIDs: [Int!], $OrderStatus: Int!) {\n    erp_Orders(where: { OrderStatusID: {_eq: $OrderStatus}, OrderID: {_in: $unpaidIDs } } ) {\n      OrderID\n      Entity\n      InvoiceNumber\n      City\n      ShippingDate\n      PaidAmount\n      TotalAmount\n      AwaitingDispatch\n      ActualShippingDate\n      CreatingDate\n      ManagerID\n      OrderItems {\n        Quantity\n        OrderItemID\n        Name\n      } \n      User {\n        FirstName\n      }\n    }\n  }\n"]))),ke=function(e){var t=e.state,n=e.dispatch,a=e.columns,c=Object(q.a)(a);c[3]={Header:"\u0424\u0430\u043a\u0442 \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0430",accessor:function(e){return Object(p.jsxs)(p.Fragment,{children:[" ",e.ActualShippingDate&&Y()(e.ActualShippingDate).format("DD.MM.YY")]})}};var i=Object(w.useQuery)(Ne,{variables:{limit:15,OrderStatus:t.reqOrderStatus},fetchPolicy:"cache-and-network"}),s=i.data,o=void 0===s?[]:s,d=(i.loading,Object(w.useQuery)(_e,{onCompleted:function(e){n({type:"unpaidIDs",payload:e.erp_Orders.filter((function(e){return e.PaidAmount/e.TotalAmount<.999})).map((function(e){return e.OrderID}))})}}).loading,Object(w.useQuery)(Ce,{variables:{unpaidIDs:t.unpaidIDs,OrderStatus:t.reqOrderStatus}})),u=d.data,l=void 0===u?[]:u;d.loading;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(be.a,{color:"textSecondary",variant:"subtitle1",m:"10px 0",children:"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 15"}),Object(p.jsx)(ve,{columns:c,data:l.erp_Orders&&o.erp_Orders?[].concat(Object(q.a)(l.erp_Orders.map((function(e){return Object(r.a)(Object(r.a)({},e),{},{unpaid:!0})}))),Object(q.a)(o.erp_Orders.filter((function(e){return!t.unpaidIDs.includes(e.OrderID)})).sort((function(e,t){return new Date(t.ActualShippingDate)-new Date(e.ActualShippingDate)})))):[],className:xe.a.archiveTable})]})},we=n(626),Se=n(86),Me=function e(){Object(Se.a)(this,e)};function Ae(e,t){switch(t.type){case"reqOrderStatus":case"searchKeyword":case"unpaidIDs":return Object(r.a)(Object(r.a)({},e),{},Object(y.a)({},t.type,t.payload));default:return Object(r.a)({},e)}}Me.ordRegistration=1,Me.ordProduction=2,Me.ordArchived=3,Me.reclInbox=10,Me.reclDecision=11,Me.reclProduction=12,Me.reclArchived=13;var Te,Fe,Le,$e,Pe,Ue,He,Ee=function(){var e=Object(o.useReducer)(Ae,{reqOrderStatus:Me.ordArchived,unpaidIDs:[],searchKeyword:""}),t=Object(b.a)(e,2),n=t[0],r=t[1],a=Object(w.useQuery)(he,{variables:{keyword:"%"+n.searchKeyword+"%"}}).data,c=void 0===a?[]:a,i=Object(o.useMemo)((function(){return z}),[]);return Object(p.jsxs)("div",{children:[Object(p.jsx)(ye.c,{className:xe.a.inputWrapper,onChange:function(e){setTimeout((function(){r({type:"searchKeyword",payload:e.target.value})}),400)},placeholder:"\u043d\u043e\u043c\u0435\u0440 \u0441\u0447\u0435\u0442\u0430 \u0438\u043b\u0438 \u044e\u0440\u043b\u0438\u0446\u043e",autoFocus:!0}),Object(p.jsxs)(Z.a,{className:xe.a.filterFormControl,children:[Object(p.jsx)(we.a,{variant:"filter",children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e "}),Object(p.jsxs)(X.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:n.reqOrderStatus,label:"Age",className:xe.a.filterInputBase,onChange:function(e){r({type:"reqOrderStatus",payload:e.target.value})},children:[Object(p.jsx)(ee.a,{value:Me.ordArchived,children:"\u0417\u0430\u043a\u0430\u0437\u044b"}),Object(p.jsx)(ee.a,{value:Me.reclArchived,children:"\u0420\u0435\u043a\u043b\u0430\u043c\u0430\u0446\u0438\u0438"})]})]}),!n.searchKeyword&&Object(p.jsx)(ke,{state:n,dispatch:r,columns:i}),n.searchKeyword&&c.erp_Orders&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(be.a,{color:"textSecondary",variant:"subtitle1",m:"10px 0",children:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u0430\u0440\u0445\u0438\u0432\u0443"}),Object(p.jsx)(ve,{columns:i,data:c.erp_Orders,className:xe.a.archiveTable})]})]})},Re=["children","value","index"],qe=Object(U.a)((function(e){return Object(p.jsx)(L.a,Object(r.a)({},e))}))((function(e){e.theme;return{margin:"0 0 1rem","& .MuiTabs-indicator":{display:"none"}}})),We=Object(U.a)((function(e){return Object(p.jsx)($.a,Object(r.a)({},e))}))((function(e){var t=e.theme;return{textTransform:"none",fontWeight:400,color:t.palette.text.secondary,fontSize:t.typography.pxToRem(15),marginRight:t.spacing(1),borderBottomRightRadius:"8px",borderBottomLeftRadius:"8px",border:"1px solid transparent","&.Mui-selected":{backgroundColor:"var(--L1)",color:t.palette.primary,border:"1px solid var(--borderLight)"}}})),Be=function(e){var t=Object(o.useContext)(Tr).store,n=Object(o.useReducer)(_,function(e,t,n){return{orders:t||[],preOrders:n||[],selectedTab:e,searchKeyword:"",managerFilter:0}}(t.priorityTab,t.cachedOrders,t.cachedPreOrders)),c=Object(b.a)(n,2),i=c[0],s=c[1],d=i.selectedTab,u=Object(m.g)();Object(w.useSubscription)(A,{onSubscriptionData:function(e){e.subscriptionData.data.erp_Orders.sort((function(e,t){return new Date(e.ShippingDate)-new Date(t.ShippingDate)}));var n=[],r=[];e.subscriptionData.data.erp_Orders.forEach((function(e){1===e.OrderStatus.ID?r.push(e):2===e.OrderStatus.ID&&n.push(e)})),t.setCachedOrders(n),t.setCachedPreOrders(r),s({type:"preOrders",payload:r}),s({type:"orders",payload:n})},fetchPolicy:"cache-first",nextFetchPolicy:"cache-first"});var l=Object(w.useQuery)(T).data,j=void 0===l?[]:l,O=Object(w.useMutation)(F,{variables:{managerID:t.user.UserID,orderStatusID:1}}),h=Object(b.a)(O,1)[0];function f(e){var t=e.children,n=e.value,c=e.index,i=Object(a.a)(e,Re);return Object(p.jsx)("div",Object(r.a)(Object(r.a)({role:"tabpanel",hidden:n!==c,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c)},i),{},{children:n===c&&Object(p.jsx)(P.a,{mb:"30px",children:t})}))}function x(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}return Object(p.jsxs)("div",{className:R.a.OrderListLayout,children:[Object(p.jsxs)(qe,{value:d,onChange:function(e,n){s({type:"selectedTab",payload:n}),s({type:"resetFilters"}),t.setPriorutyTab(n)},"aria-label":"simple tabs example",className:"orderListLayoutTabs",children:[Object(p.jsx)(We,Object(r.a)({label:"\u041f\u0440\u0435\u0434\u0437\u0430\u043a\u0430\u0437\u044b"},x(0))),Object(p.jsx)(We,Object(r.a)({label:"\u041e\u0447\u0435\u0440\u0435\u0434\u043e\u0441\u0442\u044c"},x(1))),Object(p.jsx)(We,Object(r.a)({label:"\u041d\u0435\u0434\u0430\u0432\u043d\u0438\u0435"},x(2))),Object(p.jsx)(We,Object(r.a)({label:"\u0410\u0440\u0445\u0438\u0432"},x(3))),Object(p.jsx)(I.a,{onClick:function(){h().then((function(e){u.push("/orders/".concat(e.data.insert_erp_Orders.returning[0].OrderID,"?edit=true"))}))},sx:{marginLeft:"auto"},variant:"iconic",children:Object(p.jsx)(H.a,{})})]}),Object(p.jsx)(f,{value:d,index:0,children:Object(p.jsx)(ue,{state:i,dispatch:s})}),Object(p.jsx)(f,{value:d,index:1,children:Object(p.jsx)(le,{state:i,dispatch:s,users:j.erp_Users})}),Object(p.jsx)(f,{value:d,index:2,children:Object(p.jsx)(pe,{state:i,dispatch:s})}),Object(p.jsx)(f,{value:d,index:3,children:Object(p.jsx)(Ee,{state:i,dispatch:s})})]})},Ye=n(317),ze=Object(M.a)(Te||(Te=Object(S.a)(["\nquery MyQuery($OrderID: Int!) {\n  erp_Orders(\n    where: {OrderID: {_eq: $OrderID}}\n    ){\n    AwaitingDispatch\n    ActualShippingDate\n    AcceptanceDate\n    OrderID\n    ManagerID\n    OrderStatusID\n    City\n    ShippingDate\n    CreatingDate\n    Comment\n    Entity\n    InvoiceNumber\n    NeedAttention\n    OrderNumber\n    PaidAmount\n    TotalAmount\n    User {\n      FirstName\n      LastName\n      UserID\n    }\n    OrderItems(order_by: {OrderItemID: asc}) {\n      Fitter\n      Name\n      FullName\n      OrderItemID\n      OrderID\n      Quantity\n      SerialNumber\n    }\n    CheckListUnits(order_by: {CheckListUnitID: desc}) {\n      CheckListUnitID\n      OrderID\n      IsComplited\n      Point\n    }\n    Docs {\n      Key\n      FileName\n    }\n    PaymentHistories(\n      where: {PaidAmount: {_neq: 0}}\n    ){\n      PaidAmount\n      Date\n    }\n  }\n}\n"]))),Qe=Object(M.b)(Fe||(Fe=Object(S.a)(["\nmutation MyMutation($objects: [erp_Docs_insert_input!]!) {\n  insert_erp_Docs(objects: $objects) {\n    returning {\n      ID\n    }\n  }\n}\n"]))),Ke=Object(M.b)(Le||(Le=Object(S.a)(["\n    mutation MyMutation($key: String!) {\n    delete_erp_Docs(where: {Key: {_eq: $key} }) {\n        returning {\n        Key\n        }\n    }\n    }\n"]))),Ve=Object(M.b)($e||($e=Object(S.a)(["\n mutation MyMutation($name: String!, $orderID: Int!, $quantity: Int!, $fullName: String!) {\n  insert_erp_OrderItems_one(object: {\n    OrderID: $orderID,\n    Name: $name,\n    FullName: $fullName,\n    Quantity: $quantity,\n    }) {\n    OrderItemID\n    OrderID\n  }\n}\n"]))),Ge=Object(M.b)(Pe||(Pe=Object(S.a)(["\nmutation MyMutation($orderItemID: Int!) {\n  delete_erp_OrderItems_by_pk(OrderItemID: $orderItemID) {\n\t\tOrderItemID\n  }\n}\n"]))),Je=Object(M.b)(Ue||(Ue=Object(S.a)(["\nmutation($OrderItemID: Int!, $FullName: String!, $Name: String!, $Quantity: Int!) {\n  update_erp_OrderItems_by_pk(\n    pk_columns: {OrderItemID: $OrderItemID},\n    _set: {FullName: $FullName, Name: $Name, Quantity: $Quantity}) {\n    Name\n    FullName\n    OrderItemID\n    Quantity\n  }\n}\n\n"]))),Ze=Object(M.b)(He||(He=Object(S.a)(["\nmutation($OrderItemID: Int!, $Fitter: String!, $SerialNumber: String!) {\n  update_erp_OrderItems_by_pk(\n    pk_columns: {OrderItemID: $OrderItemID},\n     _set: {Fitter: $Fitter, SerialNumber: $SerialNumber}\n  ){\n    OrderItemID\n  }\n}\n"]))),Xe=n(641),et=n(642),tt=n(643),nt=n(644),rt=n(95),at=n.n(rt),ct=n(318),it=n(597),st=n(128),ot=n.n(st),dt=function(e){var t=e.editState,n=e.item,a=e.editItemHandler,c=e.deleteItemHandler,i=e.updateItem,s=e.setOIDialog,d=Object(o.useState)(null),u=Object(b.a)(d,2),l=u[0],j=u[1],O=Object(o.useState)({serialNumber:n.SerialNumber,fitter:n.Fitter}),m=Object(b.a)(O,2),h=m[0],f=m[1],x=function(){j(null),n.SerialNumber===h.serialNumber&&n.Fitter===h.fitter||i({variables:{OrderItemID:n.OrderItemID,Fitter:h.fitter,SerialNumber:h.serialNumber.toString()}})};return Object(p.jsxs)("div",{className:"noprint",children:[Object(p.jsx)(I.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){j(e.currentTarget)},size:"small",children:Object(p.jsx)(it.a,{className:ot.a.moreVertIcon})}),Object(p.jsxs)(ct.a,{id:"simple-menu",anchorEl:l,keepMounted:!0,open:Boolean(l),PaperProps:{sx:{boxShadow:"0 10px 50px 0 var(--bs)",background:"var(--LI)",borderRadius:"var(--br)"}},onClose:x,children:[Object(p.jsx)(ee.a,{className:ot.a.inputListItem,children:Object(p.jsx)(g.a,{type:"number",label:"\u0421\u0435\u0440\u0438\u0439\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",multiline:!0,variant:"filled",size:"small",onChange:function(e){return f((function(t){return Object(r.a)(Object(r.a)({},t),{},{serialNumber:e.target.value})}))},defaultValue:h.serialNumber})}),Object(p.jsx)(ee.a,{className:ot.a.inputListItem,children:Object(p.jsx)(g.a,{label:"\u0421\u0431\u043e\u0440\u0449\u0438\u043a",variant:"filled",size:"small",onChange:function(e){return f((function(t){return Object(r.a)(Object(r.a)({},t),{},{fitter:e.target.value})}))},defaultValue:h.fitter})}),t&&Object(p.jsxs)("div",{className:ot.a.actionsWrapper,children:[Object(p.jsx)(ee.a,{onClick:function(e){s(!0),x(),a(e,n)},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(p.jsx)(ee.a,{className:ot.a.deleteButton,onClick:function(){x(),c(n.OrderItemID)},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})]})]})},ut={name:"",fullName:"",quantity:"",id:null};function lt(e,t){switch(t.type){case"name":case"fullName":case"quantity":return Object(r.a)(Object(r.a)({},e),{},Object(y.a)({},t.type,t.payload));case"reset":return ut;case"editItem":return{id:t.payload[0],name:t.payload[1],fullName:t.payload[2],quantity:t.payload[3]};default:return Object(r.a)({},e)}}var jt,bt,Ot,mt,pt,ht,ft=function(e){var t=e.data,n=e.editState,a=e.refetch,c=e.orderID,i=e.OIDialog,s=e.setOIDialog,d=Object(w.useMutation)(Ge),u=Object(b.a)(d,1)[0],l=Object(w.useMutation)(Ve),j=Object(b.a)(l,1)[0],O=Object(w.useMutation)(Je),m=Object(b.a)(O,1)[0],h=Object(w.useMutation)(Ze),f=Object(b.a)(h,1)[0],x=Object(o.useReducer)(lt,ut),v=Object(b.a)(x,2),D=v[0],y=v[1],_=function(e){u({variables:{orderItemID:e}}),a()},N=function(e,t){y({type:"editItem",payload:[t.OrderItemID,t.Name,t.FullName,t.Quantity]})},C=function(){s(!1)};Object(o.useEffect)((function(){n||""===D.name||""===D.quantity||k()}),[n]);var k=function(){if(C(),""===D.quantity||""===D.name)return null;j({variables:{orderID:c,name:D.name,quantity:parseInt(D.quantity),fullName:D.fullName}}).then((function(){y({type:"reset"}),a()}))};return Object(p.jsxs)(p.Fragment,{children:[t.map((function(t,n){return Object(p.jsxs)("div",{className:at.a.Unit,children:[Object(p.jsx)("span",{className:at.a.index,children:n+1}),Object(p.jsxs)(be.a,{color:"textPrimary",className:at.a.name,children:[" ",t.Name," "]}),Object(p.jsxs)("span",{className:at.a.quantity,children:[" ",t.Quantity]}),Object(p.jsx)(dt,Object(r.a)(Object(r.a)({},e),{},{item:t,editItemHandler:N,deleteItemHandler:_,updateItem:f})),Object(p.jsxs)("div",{className:at.a.fullName,children:[" ",t.FullName]})]},t.OrderItemID)})),Object(p.jsxs)(Xe.a,{maxWidth:"md",fullWidth:!0,open:i,onClose:C,children:[Object(p.jsx)(et.a,{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0437\u0438\u0446\u0438\u044e"}),Object(p.jsx)(tt.a,{children:Object(p.jsxs)(P.a,{className:at.a.addOrderItem,children:[Object(p.jsx)(g.a,{label:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",value:D.name,variant:"filled",sx:{mb:"8px"},onChange:function(e){return y({type:"name",payload:e.target.value})}}),Object(p.jsx)(g.a,{label:"\u041f\u043e\u043b\u043d\u043e\u0435 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",multiline:!0,variant:"filled",sx:{mb:"8px"},className:at.a.fullNameInput,value:D.fullName,onChange:function(e){return y({type:"fullName",payload:e.target.value})}}),Object(p.jsx)(g.a,{label:"\u041a\u043e\u043b-\u0432\u043e",type:"number",variant:"filled",sx:{mb:"8px"},className:at.a.quantityInput,value:D.quantity,onChange:function(e){return y({type:"quantity",payload:e.target.value})}})]})}),Object(p.jsxs)(nt.a,{sx:{justifyContent:"start"},children:[D.name&&D.quantity&&(D.id?Object(p.jsx)(P.a,{children:Object(p.jsx)(I.a,{variant:"contained",onClick:function(){if(""===D.quantity||""===D.name)return null;C(),m({variables:{OrderItemID:D.id,Name:D.name,Quantity:parseInt(D.quantity),FullName:D.fullName}}).then((function(){y({type:"reset"}),a()}))},children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"})}):Object(p.jsxs)(P.a,{children:[Object(p.jsx)(I.a,{variant:"contained",onClick:k,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})," "]})),Object(p.jsx)(P.a,{children:Object(p.jsx)(I.a,{onClick:function(){C(),y({type:"reset"})},children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})})]})]})]})},xt=(n(509),function(e){var t=e.heading,n=e.secondaryHeading;return Object(p.jsxs)(P.a,{className:"OrderInfoCard",sx:{color:"text.primary"},children:[Object(p.jsxs)("div",{className:"row",children:[Object(p.jsx)("div",{className:"heading",children:t}),Object(p.jsx)("div",{className:"secondaryHeading noprint",children:n})]}),Object(p.jsx)("div",{className:"body",children:e.children})]})}),vt=Object(U.a)((function(e){return Object(p.jsx)(be.a,Object(r.a)({},e))}))((function(e){return{color:e.theme.palette.text.secondary,fontSize:".8rem"}})),gt=function(e){var t,n,r=e.data;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("div",{className:"wrap",children:[Object(p.jsxs)(P.a,{className:"significantInfo",sx:{color:"text.primary"},children:[Object(p.jsxs)("div",{className:"bold",children:[Object(p.jsx)(vt,{children:"\u041f\u043b\u0430\u043d. \u043e\u0442\u0433\u0443\u0437\u043a\u0430"}),r.ShippingDate&&Y()(r.ShippingDate).format("DD.MM.YY")]}),Object(p.jsxs)("div",{className:"bold",children:[Object(p.jsx)(vt,{children:"\u041d\u043e\u043c\u0435\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),r.OrderNumber]}),Object(p.jsxs)("div",{className:"bold",children:[Object(p.jsx)(vt,{children:"\u0421\u0447\u0435\u0442 / \u043e\u043f\u043b\u0430\u0442\u0430"}),"\u2116 "+(r.InvoiceNumber||"")+(t=r.TotalAmount,n=r.PaidAmount,t&&n?" - "+(n/t*100).toFixed(0)+"%":" ")]})]}),Object(p.jsxs)("div",{className:"OrderComment",children:[Object(p.jsx)(vt,{children:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"}),r.Comment]}),function(){var e,t,n=[{heading:"\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440",data:"".concat(null===(e=r.User)||void 0===e?void 0:e.FirstName," ").concat((null===(t=r.User)||void 0===t?void 0:t.LastName)||"undefined")},{heading:"\u0421\u043e\u0437\u0434\u0430\u043d",data:Y()(r.CreatingDate).format("DD.MM.YY")},{heading:"\u0412 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u0438",data:Y()(r.AcceptanceDate).format("DD.MM.YY")},{heading:"\u0424\u0430\u043a\u0442. \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0430",data:Y()(r.ActualShippingDate).format("DD.MM.YY")}];return Object(p.jsx)(xt,{heading:"\u041e \u0437\u0430\u043a\u0430\u0437\u0435",children:Object(p.jsx)("table",{children:Object(p.jsx)("tbody",{children:n.map((function(e){return e.data&&"Invalid date"!==e.data?Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:e.heading}),Object(p.jsx)("td",{children:e.data})]},"".concat(e.heading," ").concat(e.data)):null}))})})})}(),0!=r.PaymentHistories.length&&r.PaidAmount&&r.TotalAmount?Object(p.jsx)(xt,{className:"noprint",heading:"\u041f\u043b\u0430\u0442\u0435\u0436\u0438",secondaryHeading:"".concat(r.TotalAmount," \u20bd"),children:Object(p.jsx)("table",{className:"paidVisualization",children:Object(p.jsx)("tbody",{children:r.PaymentHistories.map((function(e){return Object(p.jsxs)("tr",{children:[Object(p.jsxs)("td",{children:[(e.PaidAmount/r.TotalAmount*100).toFixed(0)," % "]}),Object(p.jsx)("td",{children:Y()(e.Date).format("DD.MM.YY")})]},e.Date)}))})})}):null]})})},It=(n(510),Object(M.b)(jt||(jt=Object(S.a)(["\n mutation MyMutation($OrderID: Int!, $fields: erp_Orders_set_input) {\n  update_erp_Orders_by_pk(pk_columns: {OrderID: $OrderID}, _set: $fields) {\n\t\tOrderID\n  }\n}\n"])))),Dt=Object(M.b)(bt||(bt=Object(S.a)(["\n mutation MyMutation($OrderID: Int!, $AwaitingDispatch: Boolean!) {\n  update_erp_Orders_by_pk(\n    pk_columns: {OrderID: $OrderID},\n   _set: { AwaitingDispatch: $AwaitingDispatch }\n  ) {\n\t\tOrderID\n    AwaitingDispatch\n  }\n}\n"]))),yt=Object(M.b)(Ot||(Ot=Object(S.a)(["\nmutation MyMutation($OrderID: Int!, $NeedAttention: Boolean!) {\n  update_erp_Orders_by_pk(\n    pk_columns: {OrderID: $OrderID},\n   _set: { NeedAttention: $NeedAttention }\n  ) {\n\t\tOrderID\n    NeedAttention\n  }\n}\n"]))),_t=Object(M.b)(mt||(mt=Object(S.a)(["\n  mutation MyMutation($OrderID: Int!, $ActualShippingDate: timestamptz!, $OrderStatusID: Int!) {\n    update_erp_Orders_by_pk(\n      pk_columns: {OrderID: $OrderID}, \n      _set: {\n        OrderStatusID: $OrderStatusID,\n        AwaitingDispatch: false,\n        ActualShippingDate: $ActualShippingDate,\n        }){\n      OrderID\n      OrderStatusID\n    }\n  }\n"]))),Nt=Object(M.b)(pt||(pt=Object(S.a)(["\n    mutation MyMutation($OrderID: Int!, $AcceptanceDate: timestamptz!){\n    update_erp_Orders_by_pk(\n      pk_columns: {OrderID: $OrderID},\n       _set: {\n         OrderStatusID: 2,\n         AcceptanceDate: $AcceptanceDate,\n         }\n      ) {\n        OrderID\n        OrderStatusID\n    }\n  }\n\n"]))),Ct=Object(M.b)(ht||(ht=Object(S.a)(["\n  mutation($PaidAmount: numeric!, $Date: timestamptz!, $OrderID: Int!) {\n    insert_erp_PaymentHistory_one(object: {PaidAmount: $PaidAmount, OrderID: $OrderID, Date: $Date}) {\n      ID\n      OrderID\n    }\n}\n"]))),kt=n(210),wt=n(618),St=["inputRef","onChange"],Mt=["inputRef","onChange"],At={};function Tt(e){var t=e.inputRef,n=e.onChange,c=Object(a.a)(e,St);return Object(p.jsx)(kt.a,Object(r.a)(Object(r.a)({},c),{},{getInputRef:t,onValueChange:function(t){n({target:{name:e.name,value:t.value}})},format:"##.##.##"}))}function Ft(e){var t=e.inputRef,n=e.onChange,c=Object(a.a)(e,Mt);return Object(p.jsx)(kt.a,Object(r.a)(Object(r.a)({},c),{},{getInputRef:t,onValueChange:function(t){n({target:{name:e.name,value:t.value}})},prefix:"\u20bd ",thousandSeparator:!0}))}var Lt=function(e){var t=e.data,n=e.orderID,a=e.refetch,c=e.users,i=function(e){return At[e.target.name]=e.target.value},s=Object(w.useMutation)(It),d=Object(b.a)(s,1)[0],u=Object(w.useMutation)(Ct),l=Object(b.a)(u,1)[0];return Object(o.useEffect)((function(){return At={},function(){console.log("doing mutation for order",n,At),d({variables:{OrderID:n,fields:At}}),At.PaidAmount&&l({variables:{Date:new Date,OrderID:n,PaidAmount:At.PaidAmount}}),a()}}),[]),Object(p.jsx)("form",{className:"EditableInfo",children:Object(p.jsxs)("div",{className:"wrap",children:[Object(p.jsx)(g.a,{label:"\u041f\u043b\u0430\u043d. \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0430",name:"ShippingDate",defaultValue:Y()(t.ShippingDate).format("DD.MM.YY"),onChange:function(e){e.target.value=Y()(e.target.value,"DD-MM-YY").format("YYYY-MM-DD"),i(e)},placeholder:"dd.mm.yy",InputProps:{inputComponent:Tt}}),Object(p.jsx)(g.a,{label:"\u041d\u043e\u043c\u0435\u0440 \u0441\u0447\u0435\u0442\u0430",type:"number",name:"InvoiceNumber",defaultValue:t.InvoiceNumber,onChange:i}),Object(p.jsx)(g.a,{label:"\u041d\u043e\u043c\u0435\u0440 \u0437\u0430\u043a\u0430\u0437\u0430",name:"OrderNumber",defaultValue:t.OrderNumber,onChange:i}),Object(p.jsx)(wt.a,{id:"combo-box-demo",options:c.filter((function(e){return 3!=e.AccessLevelID})),getOptionLabel:function(e){return"".concat(e.FirstName," ").concat(e.LastName)},renderInput:function(e){return Object(p.jsx)(g.a,Object(r.a)(Object(r.a)({},e),{},{label:"\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440"}))},defaultValue:function(){return function(e,t){if(!e)return null;var n=e.indexOf(e.find((function(e){return e.UserID===t})));return e[n]}(c,t.ManagerID)},onChange:function(e,t){At.ManagerID=(null===t||void 0===t?void 0:t.UserID)||null}}),Object(p.jsx)(g.a,{label:"\u042e\u0440 \u043b\u0438\u0446\u043e",name:"Entity",defaultValue:t.Entity,onChange:i}),Object(p.jsx)(g.a,{label:"\u0413\u043e\u0440\u043e\u0434",name:"City",defaultValue:t.City,onChange:i}),Object(p.jsx)(g.a,{label:"\u0421\u0443\u043c\u043c\u0430 \u0437\u0430\u043a\u0430\u0437\u0430",name:"TotalAmount",defaultValue:t.TotalAmount,onChange:i,InputProps:{inputComponent:Ft}}),Object(p.jsx)(g.a,{label:"\u041e\u043f\u043b\u0430\u0447\u0435\u043d\u043e",name:"PaidAmount",defaultValue:t.PaidAmount,onChange:i,InputProps:{inputComponent:Ft}}),Object(p.jsx)(g.a,{label:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",multiline:!0,name:"Comment",defaultValue:t.Comment,onChange:i})]})})},$t=(n(511),n(645));function Pt(e){var t=e.filename,n=e.open,r=e.handleClose;e.onConfirmF;return Object(p.jsx)("div",{children:Object(p.jsxs)(Xe.a,{open:n,minWidth:"xs",onClose:r,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(p.jsx)(tt.a,{children:Object(p.jsxs)($t.a,{id:"alert-dialog-description",sx:{color:"var(--lowContrast) !important",span:{color:"var(--highContrast) !important"}},children:["\u0423\u0434\u0430\u043b\u0438\u0442\u044c ",Object(p.jsx)("span",{children:t})," ?"]})}),Object(p.jsxs)(nt.a,{children:[Object(p.jsx)(I.a,{color:"info",onClick:r,children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),Object(p.jsx)(I.a,{color:"secondary",onClick:function(){r(),e.onConfirmF()},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})]})})}var Ut,Ht,Et,Rt,qt,Wt=function(e){var t=e.data,n=e.onUpload,r=e.editState,a=e.refetch,c=Object(o.useContext)(Tr).store,d=Object(o.useState)(!1),u=Object(b.a)(d,2),l=u[0],j=u[1],O=Object(o.useState)(),m=Object(b.a)(O,2),h=m[0],f=m[1],x=Object(w.useMutation)(Ke),v=Object(b.a)(x,1)[0],g=function(){return j(!1)};Object(o.useEffect)((function(){j(!1)}),[r]);var I=function(){var e=Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(),e.next=3,c.deleteFile(h.Key,v);case 3:a();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=t.map((function(e){return r?Object(p.jsx)("div",{children:Object(p.jsxs)("div",{onClick:function(){return function(e){f(e),j(!0)}(e)},className:"file-name delete-file",children:[" ",e.FileName," "]})},e.Key):Object(p.jsxs)("a",{href:"".concat("https://factory.piek.ru/api","/s3/get/").concat(e.Key),target:"_blank",rel:"noreferrer",className:"file-name",children:[" ",e.FileName," "]},e.Key)}));return Object(p.jsxs)("div",{className:"Docs",children:[Object(p.jsxs)("div",{className:"filesContainer",children:[D,function(){if(0===n.length)return null;var e=n.map((function(e){return Object(p.jsx)("div",{children:e.path},e.path)}));return Object(p.jsx)("div",{className:"onUploadIcon",children:e})}()]}),Object(p.jsx)("div",{children:Object(p.jsx)(Pt,{filename:null===h||void 0===h?void 0:h.FileName,open:l,handleClose:g,onConfirmF:I})})]})},Bt=Object(M.b)(Ut||(Ut=Object(S.a)(["\nmutation($OrderID: Int!, $Text: String!, $UserID: Int!) {\n  insert_erp_Comments_one(\n    object: {OrderID: $OrderID, Text: $Text, UserID: $UserID}) \n    {\n    CommentID\n    OrderID\n    Text\n    Timestamp\n    UserID\n  }\n}\n"]))),Yt=Object(M.b)(Ht||(Ht=Object(S.a)(["\n mutation($CommentID: Int!) {\n  delete_erp_Comments_by_pk(CommentID: $CommentID) {\n    CommentID\n  }\n}\n"]))),zt=Object(M.b)(Et||(Et=Object(S.a)(["\nmutation($CommentID: Int!, $Text: String!, $Timestamp: timestamptz!) {\n  update_erp_Comments_by_pk(\n    pk_columns: {CommentID: $CommentID},\n    _set: {Text: $Text, Timestamp: $Timestamp}) \n    {\n    OrderID\n    Text\n    Timestamp\n    UserID\n    CommentID\n  }\n  }\n"]))),Qt=Object(M.a)(Rt||(Rt=Object(S.a)(["\n  subscription MySubscritp($OrderID: Int!) {\n    erp_Comments(where: {OrderID: {_eq: $OrderID}}, order_by: {CommentID: desc}) {\n      CommentID\n      Text\n      Timestamp\n      User {\n        UserID\n        FirstName\n        LastName\n      }\n    }\n  }\n"]))),Kt=n(46),Vt=n.n(Kt),Gt=function(e){var t=e.data,n=e.userID,r=e.updateComment,a=e.deleteComment,c=e.nowEditing,o=e.setNowEditing;return Object(p.jsxs)("div",{className:Vt.a.commentUnit,children:[Object(p.jsxs)("div",{className:Vt.a.commentHeader,children:[Object(p.jsxs)("div",{className:Vt.a.sender,children:[" ","".concat(t.User.FirstName," ").concat(t.User.LastName)," "]}),Object(p.jsx)("div",{className:Vt.a.actions,children:function(){if(n===t.User.UserID&&(null===c||void 0===c?void 0:c.CommentID)!==t.CommentID)return Object(p.jsx)("div",{onClick:function(){return a(t.CommentID)},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})}()}),Object(p.jsxs)("div",{className:Vt.a.time,children:[" ",function(){var e=Y()(t.Timestamp);return e.format("MMM D")+" at "+e.format("hh:mm")}()," "]})]}),n===t.User.UserID?Object(p.jsx)("div",{contentEditable:"true",className:Vt.a.commentContent,suppressContentEditableWarning:"true",onBlur:function(){var e=Object(s.a)(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t.CommentID,n.target.innerHTML);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onMouseLeave:function(){var e=Object(s.a)(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t.CommentID,n.target.innerHTML);case 2:o(null);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),dangerouslySetInnerHTML:{__html:t.Text}},t.CommentID):Object(p.jsx)("div",{onClick:function(e){e.currentTarget.innerHTML.toString().includes(Vt.a.checklistUnit,0)&&r(t.CommentID,e.currentTarget.innerHTML)},dangerouslySetInnerHTML:{__html:t.Text},className:Vt.a.commentContent})]})},Jt=n(599),Zt=function(e){var t=e.anchorEl,n=e.open,r=e.handleClose;return Object(p.jsxs)(ct.a,{id:"Comments__commandMenu","aria-labelledby":"Comments__commandMenu__button",anchorEl:t,open:n,elevation:5,onClose:r,sx:{border:"1px solid var(--border) !important",".MuiList-root":{padding:"10px"}},children:[Object(p.jsx)(ee.a,{onClick:function(){r(),function(){var e=document.getElementById("Comments__commandMenu__button"),t=document.createElement("div");t.classList.add(Vt.a.checklistUnit),e.appendChild(t)}()},children:"\u0427\u0435\u043a\u043b\u0438\u0441\u0442"}),Object(p.jsx)(ee.a,{onClick:r,sx:{color:"var(--border)"},children:"\u0423\u043f\u043e\u043c\u044f\u043d\u0443\u0442\u044c"})]})},Xt=function(e){var t=e.orderID,n=e.user,r=Object(w.useMutation)(Bt),a=Object(b.a)(r,1)[0],c=Object(w.useMutation)(zt),i=Object(b.a)(c,1)[0],s=Object(w.useMutation)(Yt),d=Object(b.a)(s,1)[0],u=Object(o.useRef)(),l=Object(o.useState)(),j=Object(b.a)(l,2),O=j[0],m=j[1],h=Object(w.useSubscription)(Qt,{variables:{OrderID:t}}),f=h.data,x=void 0===f?[]:f,v=h.loading,g=Object(o.useState)(null),I=Object(b.a)(g,2),D=I[0],y=I[1],_=Boolean(D);function N(e,t){i({variables:{CommentID:e,Text:t,Timestamp:new Date}})}function C(e){d({variables:{CommentID:e}})}function k(e){e.target.classList.toggle(Vt.a.checklistUnit_complited)}return Object(o.useEffect)((function(){var e=Object(q.a)(document.querySelectorAll("div.".concat(Vt.a.commentUnit," div.").concat(Vt.a.checklistUnit)));return e.forEach((function(e){e.addEventListener("click",k,!1)}),{once:!0}),function(){e.forEach((function(e){e.removeEventListener("click",k,!1)}))}}),[x]),Object(p.jsxs)("div",{className:Vt.a.commentsListWrapper,children:[Object(p.jsxs)("div",{className:Vt.a.commentInputForm,children:[Object(p.jsx)(Zt,{anchorEl:D,open:_,handleClose:function(){y(null)}}),Object(p.jsx)(P.a,{id:"Comments__commandMenu__button","aria-controls":"Comments__commandMenu","aria-haspopup":"true",contentEditable:"true",ref:u,sx:{minHeight:20,padding:"10px 5px"},"data-ph":"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439 \u0438\u043b\u0438 ' / ' \u0434\u043b\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u044b",suppressContentEditableWarning:!0,onInput:function(e){"/"===e.target.innerText.trim()&&(y(e.target),e.target.innerHTML="")}}),Object(p.jsx)("div",{onClick:function(){var e=u.current.innerHTML;if(!e)return null;a({variables:{OrderID:t,UserID:n.UserID,Text:e}}),u.current.innerText=""},className:Vt.a.saveButton,children:Object(p.jsx)(Jt.a,{})})]}),!v&&x.erp_Comments.map((function(e){return Object(p.jsx)(Gt,{data:e,userID:n.UserID,deleteComment:C,updateComment:N,nowEditing:O,setNowEditing:m},e.CommentID)}))]})},en=n(617),tn=n(637),nn=n(606),rn=n(638),an=Object(M.b)(qt||(qt=Object(S.a)(["\nmutation MyMutation($OrderID: Int!) {\n  delete_erp_Orders_by_pk(OrderID: $OrderID) {\n    OrderID\n  }\n}\n"]))),cn=n(600),sn=n(602),on=n(601);function dn(e){var t=o.useState(!1),n=Object(b.a)(t,2),r=n[0],a=n[1],c=function(){a(!1)};return Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{onClick:function(){a(!0)},children:"\u041e\u0442\u0433\u0440\u0443\u0436\u0435\u043d"}),Object(p.jsxs)(Xe.a,{open:r,maxWidth:"xs",onClose:c,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(p.jsx)(et.a,{id:"alert-dialog-title",children:"\u041f\u0435\u0440\u0435\u043d\u0435\u0441\u0442\u0438 \u0432 \u0430\u0440\u0445\u0438\u0432?"}),Object(p.jsx)(tt.a,{children:Object(p.jsx)($t.a,{id:"alert-dialog-description",children:"\u0417\u0430\u043a\u0430\u0437 \u0443\u0434\u0430\u043b\u0438\u0442\u0441\u044f \u0438\u0437 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u0438, \u043d\u043e \u0435\u0433\u043e \u0432 \u043b\u044e\u0431\u043e\u0435 \u0432\u0440\u0435\u043c\u044f \u043c\u043e\u0436\u043d\u043e \u0431\u0443\u0434\u0435\u0442 \u043d\u0430\u0439\u0442\u0438 \u0432 \u0430\u0440\u0445\u0438\u0432\u0435 \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 \u0441\u0447\u0435\u0442\u0430, \u044e\u0440\u043b\u0438\u0446\u0443, \u043c\u0430\u0440\u043a\u0438\u0440\u043e\u0432\u043a\u0435 \u043f\u0440\u0438\u0432\u043e\u0434\u0430."})}),Object(p.jsxs)(nt.a,{children:[Object(p.jsx)(I.a,{color:"info",onClick:c,children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),Object(p.jsx)(I.a,{color:"secondary",onClick:function(){c(),e.onConfirmF()},children:"\u041f\u0435\u0440\u0435\u043d\u0435\u0441\u0442\u0438"})]})]})]})}var un=function(e){var t=e.order,n=e.transferOrderToArchive;return[Me.ordProduction].includes(t.OrderStatusID)?Object(p.jsxs)(ee.a,{children:[Object(p.jsx)(cn.a,{children:Object(p.jsx)(on.a,{})}),Object(p.jsx)(sn.a,{children:Object(p.jsx)(dn,{onConfirmF:function(){return n(3)}})})]}):null},ln=n(603),jn=function(e){var t=e.order,n=e.transferOrderToPriority,r=e.mutationDeleteOrderHandler;return[Me.ordRegistration].includes(t.OrderStatusID)?Object(p.jsxs)("div",{children:[Object(p.jsxs)(ee.a,{children:[Object(p.jsx)(cn.a,{children:Object(p.jsx)(se.a,{})}),Object(p.jsx)(sn.a,{onClick:n,children:"\u0412 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u044c"})]}),Object(p.jsxs)(ee.a,{sx:{color:"var(--danger)",svg:{color:"var(--danger)"}},children:[Object(p.jsx)(cn.a,{children:Object(p.jsx)(ln.a,{})}),Object(p.jsx)(sn.a,{onClick:r,children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0440\u0435\u0434\u0430\u0437\u043a\u0430\u0437"})]})]}):null},bn=n(604),On=n(605),mn=function(e){var t=e.order,n=e.needAttentionHandler,r=e.awaitingDispatchHandler;return[Me.ordProduction,Me.reclInbox,Me.reclDecision,Me.reclProduction].includes(t.OrderStatusID)?Object(p.jsxs)("div",{children:[Object(p.jsxs)(ee.a,{className:t.AwaitingDispatch?"awaitingDispatch":"",onClick:r,children:[Object(p.jsx)(cn.a,{children:Object(p.jsx)(bn.a,{})}),Object(p.jsx)(sn.a,{children:"\u041e\u0436\u0438\u0434\u0430\u0435\u0442 \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0438"})]}),Object(p.jsxs)(ee.a,{className:t.NeedAttention?"needAttention":"",onClick:n,children:[Object(p.jsx)(cn.a,{children:Object(p.jsx)(On.a,{})}),Object(p.jsx)(sn.a,{children:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u044f"})]})]}):null},pn=function(e){var t=e.order,n=e.transferOrderToArchive,r=e.mutationDeleteOrderHandler;return Object(p.jsxs)(p.Fragment,{children:[function(){if(t.OrderStatusID===Me.reclProduction)return!0}()&&Object(p.jsxs)(ee.a,{children:[Object(p.jsx)(cn.a,{children:Object(p.jsx)(on.a,{})}),Object(p.jsx)(sn.a,{children:Object(p.jsx)(dn,{onConfirmF:function(){return n(13)}})})]}),function(){if(t.OrderStatusID===Me.reclInbox)return!0}()&&Object(p.jsxs)(ee.a,{sx:{color:"var(--danger)",svg:{color:"var(--danger)"}},children:[Object(p.jsx)(cn.a,{children:Object(p.jsx)(ln.a,{})}),Object(p.jsx)(sn.a,{onClick:r,children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})]})},hn=function(e){var t=e.order.OrderID,n=e.OAMenu,r=e.setOAMenu,a=e.OAMenuRef,c=e.order,o=e.refetch,d=Object(w.useMutation)(Dt),u=Object(b.a)(d,1)[0],l=Object(w.useMutation)(yt),j=Object(b.a)(l,1)[0],O=Object(w.useMutation)(_t),h=Object(b.a)(O,1)[0],f=Object(w.useMutation)(Nt),x=Object(b.a)(f,1)[0],v=Object(w.useMutation)(an),g=Object(b.a)(v,1)[0],I=Object(m.g)(),D=function(){return[1,2].includes(c.OrderStatusID)?"/":[10,11,12].includes(c.OrderStatusID)?"/reclamation":void 0};function y(e){return _.apply(this,arguments)}function _(){return(_=Object(s.a)(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h({variables:{OrderID:t,ActualShippingDate:new Date,OrderStatusID:n}}).then((function(e){e.data.update_erp_Orders_by_pk.OrderID&&I.push(D())}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x({variables:{OrderID:t,AcceptanceDate:new Date}}).then((function(e){e.data.update_erp_Orders_by_pk.OrderID&&o()}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){g({variables:{OrderID:t}}).then((function(e){e.data.delete_erp_Orders_by_pk.OrderID&&I.push(D())}))}return Object(p.jsx)(en.a,{open:n,anchorEl:a.current,children:Object(p.jsx)(tn.a,{sx:{boxShadow:"0 10px 50px 0 var(--bs)",background:"var(--LI)",width:200,maxWidth:"100%",borderRadius:"var(--br)"},children:Object(p.jsx)(nn.a,{onClickAway:function(e){r(!1)},children:Object(p.jsxs)(rn.a,{children:[Object(p.jsx)(mn,{order:c,awaitingDispatchHandler:function(){u({variables:{OrderID:t,AwaitingDispatch:!c.AwaitingDispatch},optimisticResponse:{erp_Orders:{__typename:"erp_Orders",OrderID:c.OrderID,AwaitingDispatch:!c.AwaitingDispatch}}})},needAttentionHandler:function(){j({variables:{OrderID:t,NeedAttention:!c.NeedAttention},optimisticResponse:{erp_Orders:{__typename:"erp_Orders",OrderID:c.OrderID,NeedAttention:!c.NeedAttention}}})}}),Object(p.jsx)(jn,{order:c,transferOrderToPriority:function(){return N.apply(this,arguments)},mutationDeleteOrderHandler:C}),Object(p.jsx)(un,{order:c,transferOrderToArchive:y}),Object(p.jsx)(pn,{order:c,transferOrderToArchive:y,mutationDeleteOrderHandler:C})]})})})})},fn=n(607),xn=function(e){var t,n=document.getElementById("dropzone");if(e)return n.classList.add("isDragAccept"),Object(p.jsx)("div",{children:Object(p.jsx)(fn.a,{className:"inCloudconIcon"})});null===n||void 0===n||null===(t=n.classList)||void 0===t||t.remove("isDragAccept")},vn=(n(512),n(608)),gn=n(609),In=function e(){Object(Se.a)(this,e)};function Dn(e){return e.OrderStatusID===Me.ordRegistration?" | \u041f\u0440\u0435\u0434\u0437\u0430\u043a\u0430\u0437":e.OrderStatusID===Me.ordArchived?" | \u0412 \u0430\u0440\u0445\u0438\u0432\u0435":[Me.reclInbox,Me.reclDecision,Me.reclProduction].includes(e.OrderStatusID)?" | \u0420\u0435\u043a\u043b\u0430\u043c\u0430\u0446\u0438\u044f":void 0}In.general=1,In.management=2,In.bookkeeping=4,In.manufacture=3;var yn,_n=function(e){var t=Object(o.useContext)(Tr).store,n=Object(o.useState)([]),a=Object(b.a)(n,2),c=a[0],i=a[1],s=new URLSearchParams(Object(m.h)().search).get("edit"),d=Object(o.useState)(s),u=Object(b.a)(d,2),l=u[0],j=u[1],O=Object(o.useState)(!1),h=Object(b.a)(O,2),f=h[0],x=h[1],v=Object(o.useState)(!1),g=Object(b.a)(v,2),D=g[0],y=g[1],_=Object(o.useRef)(null),N=Object(w.useMutation)(Qe),C=Object(b.a)(N,1)[0],k=Object(m.i)().id,S=Object(o.useCallback)((function(e){i(e),t.uploadFile(e).then((function(e){if(200!==e.status)console.log("S3 file upload error");else{for(var t=[],n=0;n<e.data.length;n+=2)t.push({Key:e.data[n].key,OrderID:k,FileName:e.data[n].originalname});C({variables:{objects:t}})}i([]),L()}))}),[]),M=Object(w.useQuery)(ze,{variables:{OrderID:k}}),A=M.data,F=void 0===A?[]:A,L=M.refetch,$=Object(w.useQuery)(T).data,U=void 0===$?[]:$,E=Object(Ye.a)({className:"dropzone",onDrop:S}),R=E.getRootProps,q=E.isDragActive;return Object(p.jsxs)("div",{children:[xn(q),F.erp_Orders&&U.erp_Users?Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("section",Object(r.a)(Object(r.a)({className:"OrderLayout"},R()),{},{id:"dropzone",children:[Object(p.jsxs)("div",{className:"LeftSideContent",children:[Object(p.jsxs)("div",{className:"page-header",children:[Object(p.jsxs)(be.a,{sx:{fontWeight:600,fontSize:"1rem"},children:[F.erp_Orders[0].Entity," __ ",F.erp_Orders[0].City,Object(p.jsx)("span",{className:"preorderTitle",children:Dn(F.erp_Orders[0])})]}),Object(p.jsxs)(P.a,{className:"orderActions_box",children:[l&&Object(p.jsx)(I.a,{variant:"iconic",onClick:function(){return x(!0)},children:Object(p.jsx)(H.a,{})}),[In.general,In.management,In.bookkeeping].includes(t.user.AccessLevelID)&&Object(p.jsx)(I.a,{variant:"iconic",onClick:function(){return j(!l)},children:Object(p.jsx)(vn.a,{})}),Object(p.jsx)(I.a,{"aria-haspopup":"true",ref:_,variant:"iconic",onClick:function(){return y(!0)},children:Object(p.jsx)(gn.a,{})})]})]}),Object(p.jsx)("div",{className:"Composition",children:Object(p.jsx)(ft,{data:F.erp_Orders[0].OrderItems,editState:l,refetch:L,OIDialog:f,setOIDialog:x,orderID:k})}),Object(p.jsx)(Xt,{orderID:k,user:t.user,data:F.erp_Orders[0].Comments}),Object(p.jsx)(Wt,{data:F.erp_Orders[0].Docs,onUpload:c,editState:l,refetch:L})]}),Object(p.jsx)("div",{className:"Info",children:l?Object(p.jsx)(Lt,{data:F.erp_Orders[0],orderID:k,refetch:L,users:U.erp_Users}):Object(p.jsx)(gt,{data:F.erp_Orders[0],editState:l,orderID:k})}),Object(p.jsx)(hn,{refetch:L,order:F.erp_Orders[0],OAMenu:D,setOAMenu:y,OAMenuRef:_})]}))}):null]})},Nn=Object(M.a)(yn||(yn=Object(S.a)(["\nquery MyQuery($gte: timestamp!, $lte: timestamp!) {\n  attendance_users_aggregate(\n    order_by: {lastname: asc}\n    ){\n    nodes {\n      id\n      card\n      firstname\n      lastname\n      intervalsPools(where: {entrance: {_gte: $gte,  _lte: $lte}}) {\n        entrance\n        exit\n        card\n        interval\n        status\n      }\n    }\n  }\n}  \n"])));function Cn(e){var t=Object(b.a)(e,2),n=t[0],r=t[1];return new Date(r,n+1,0).getDate()}var kn=n(101),wn=n.n(kn);function Sn(e,t,n){function r(e){var t=e.getMinutes();return t<10?"0".concat(t):t}var a=t.find((function(t){return new Date(t.entrance).getDate()==e}));if(a){var c=new Date(a.entrance),i=new Date(a.exit);return[c.getHours()+":"+r(c),i.getHours()+":"+r(i),function(e,t){e-=t/60;var n=Math.floor(e),r=e-n,a=1/60;r=a*Math.round(r/a);var c=Math.floor(60*r)+"";return c.length<2&&(c="0"+c),n+":"+c}(a.interval,n),a.status]}return[null,null,null,null]}function Mn(e){var t=e.columns,n=e.data,a=e.className,c=Object(Q.useTable)({columns:t,data:n}),i=c.getTableProps,s=c.getTableBodyProps,o=c.headerGroups,d=c.rows,u=c.prepareRow;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("table",Object(r.a)(Object(r.a)({className:a},i()),{},{children:[Object(p.jsx)("thead",{children:o.map((function(e,t){return Object(p.jsx)("tr",Object(r.a)(Object(r.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e,t){return Object(p.jsx)("th",Object(r.a)(Object(r.a)({},e.getHeaderProps()),{},{children:e.render("Header")}))}))}),t)}))}),Object(p.jsx)("tbody",Object(r.a)(Object(r.a)({},s()),{},{children:d.map((function(e,t){return u(e),Object(p.jsx)("tr",Object(r.a)(Object(r.a)({},e.getRowProps()),{},{children:e.cells.map((function(e,t){return Object(p.jsx)("td",Object(r.a)(Object(r.a)({},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]}))})}n(513);function An(e,t){var n=e;return(n=new Date(e.getFullYear(),e.getMonth(),1)).setMonth(n.getMonth()+(t+1)),n.setDate(n.getDate()-1),e.getDate()<n.getDate()&&n.setDate(e.getDate()),n}var Tn,Fn,Ln,$n=function(e){var t=e.state,n=e.dispatch,r=new Date,a=["\u044f\u043d\u0432","\u0444\u0435\u0432","\u043c\u0430\u0440","\u0430\u043f\u0440","\u043c\u0430\u0439","\u0438\u044e\u043d","\u0438\u044e\u043b","\u0430\u0432\u0433","\u0441\u0435\u043d","\u043e\u043a\u0442","\u043d\u043e\u044f","\u0434\u0435\u043a"],c=function(e){var t=new Date(e.target.attributes.date.value);n({type:"selectedMonth",payload:[t.getMonth(),t.getFullYear()]})};return Object(p.jsxs)("div",{className:"reportConfigurator",children:[function(){for(var e=[],n=0;n<6;n++){var i=An(r,-n);e.push(Object(p.jsxs)("div",{onClick:c,className:i.getMonth()==t.selectedMonth[0]?"active":"",date:i,children:[" ",a[i.getMonth()]," "]}))}return Object(p.jsx)("div",{className:"chooseMonth",children:e})}(),Object(p.jsx)("div",{className:"arguments",children:Object(p.jsxs)("div",{className:"wrap",children:[Object(p.jsx)("span",{children:"\u043e\u0431\u0435\u0434"}),Object(p.jsx)("input",{type:"text",defaultValue:t.timeDeduction,onChange:function(e){n({type:"timeDeduction",payload:parseInt(e.target.value.trim())})}}),Object(p.jsx)("span",{children:"\u043c\u0438\u043d"})]})})]})},Pn=n(610),Un=null,Hn=function(e){var t=new Date;Object(o.useContext)(Tr).store;var n=Object(o.useReducer)((function(e,t){switch(t.type){case"selectedMonth":case"timeDeduction":case"filtredData":return Object(r.a)(Object(r.a)({},e),{},Object(y.a)({},t.type,t.payload));default:throw new Error}}),{timeDeduction:30,selectedMonth:[t.getMonth()-1,t.getFullYear()]}),a=Object(b.a)(n,2),c=a[0],i=a[1],s=c.timeDeduction,d=c.selectedMonth,u=c.filtredData,l=function(e){var t=Object(b.a)(e,2),n=t[0],r=t[1],a=(parseInt(n)+1).toString().replace(/(^|\D)(\d)(?!\d)/g,"$10$2");return{gte:r+"-"+a+"-01T00:00:00",lte:r+"-"+a+"-"+Cn(e)+"T23:59:59"}}(d),j=l.gte,O=l.lte;Object(w.useQuery)(Nn,{variables:{gte:j,lte:O},onCompleted:function(e){Un=e.attendance_users_aggregate.nodes,i({type:"filtredData",payload:Un})}}).loading;Object(o.useEffect)((function(){return function(){Un=null}}),[]);var m=Object(o.useMemo)((function(){return function(e,t){for(var n=[{Header:"\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a",accessor:function(e){return Object(p.jsxs)("div",{children:[Object(p.jsxs)("span",{children:[e.lastname," "]}),Object(p.jsxs)("span",{children:[e.firstname," "]})]})}},{Header:"\u0418\u0442\u043e\u0433\u043e",Cell:function(e){var n=0,r=e.row.original.intervalsPools;return r.forEach((function(e){n+=e.interval})),n-=t/60*r.length,Object(p.jsx)("div",{children:n.toFixed(0)})}}],r=1;r<=Cn(e);r++)n.push({Header:r.toString(),Cell:function(e){var n=Sn(e.column.Header,e.row.original.intervalsPools,t),r=Object(b.a)(n,4),a=r[0],c=r[1],i=r[2],s=r[3];return Object(p.jsxs)("div",{className:"status-"+s,children:[Object(p.jsx)("div",{children:a}),Object(p.jsx)("div",{children:c}),Object(p.jsx)("div",{className:wn.a.interval,children:i})]})}});return n}(d,s)}),[d,s]);return Object(p.jsxs)("div",{className:wn.a.attendanceLayout,children:[Object(p.jsxs)("div",{className:"pageLayout__header",children:[Object(p.jsx)(Pn.a,{className:"pageLayout__icon"}),Object(p.jsx)("div",{className:"pageLayout__title",children:"\u0420\u0430\u0431\u043e\u0447\u0435\u0435 \u0432\u0440\u0435\u043c\u044f"})]}),Object(p.jsx)($n,{state:c,dispatch:i}),Object(p.jsxs)("div",{className:wn.a.tableWrapper,children:[Object(p.jsxs)("div",{className:wn.a.tableSearchInput,children:[Object(p.jsx)(V.a,{}),Object(p.jsx)("input",{type:"text",placeholder:"\u043f\u043e\u0438\u0441\u043a (\u043d\u043e\u043c\u0435\u0440 \u0441\u0447\u0435\u0442\u0430 \u0438\u043b\u0438 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f)",onChange:function(e){return function(e){var t=e.target.value.trim();if(""!==t){var n=Un.filter((function(e){return function(e,t){return!!e.lastname.toLowerCase().startsWith(t.toLowerCase())||!!e.firstname.toLowerCase().startsWith(t.toLowerCase())}(e,t)}));i({type:"filtredData",payload:n})}else i({type:"filtredData",payload:Un})}(e)},autoFocus:!0})]}),u&&m&&Object(p.jsx)(Mn,{columns:m,data:u,className:wn.a.attendanceTable}),Object(p.jsxs)("div",{className:"".concat(wn.a.tableFooter," legend"),children:[Object(p.jsx)("div",{className:"status-101",children:"\u041f\u0440\u0435\u0440\u0432\u0430\u043d\u043d\u044b\u0439 \u0440\u0430\u0431\u043e\u0447\u0438\u0439 \u0434\u0435\u043d\u044c"}),Object(p.jsx)("div",{className:"status-102",children:"\u041d\u0435 \u043e\u0442\u043c\u0435\u0447\u0435\u043d \u043a\u043e\u043d\u0435\u0446 \u0441\u043c\u0435\u043d\u044b"}),Object(p.jsxs)("span",{className:"reportMeta",children:["\u041e\u0442\u0447\u0435\u0442 \u0437\u0430 ",d[0]+1," \u043c\u0435\u0441\u044f\u0446 ",d[1]," \u0433\u043e\u0434\u0430"]})]})]})]})},En=n(77),Rn=n.n(En),qn=n(611),Wn=n(173),Bn={inbox:[],decision:[],inproduction:[]};function Yn(e,t){switch(t.type){case"inbox":case"decision":case"inproduction":return Object(r.a)(Object(r.a)({},e),{},Object(y.a)({},t.type,t.payload));case"reset":return Bn;default:return Object(r.a)({},e)}}var zn=Object(M.a)(Tn||(Tn=Object(S.a)(["\nsubscription{\n    erp_Orders(where: {OrderStatusID: {_in: [10,11,12]} }) {\n      AwaitingDispatch\n      NeedAttention\n      OrderID\n      Entity\n      City\n      OrderStatusID\n      OrderItems(order_by: {OrderItemID: asc}){\n        OrderItemID\n        Name\n      }   \n    }  \n  }\n"]))),Qn=Object(M.a)(Fn||(Fn=Object(S.a)(["\n    mutation MyMutation($OrderID: Int!, $OrderStatusID: Int!){\n    update_erp_Orders_by_pk(\n      pk_columns: {OrderID: $OrderID},\n       _set: {\n         OrderStatusID: $OrderStatusID,\n         }\n      ) {\n        OrderID\n        OrderStatusID\n    }\n  }\n\n"]))),Kn=Object(M.a)(Ln||(Ln=Object(S.a)(["\nmutation MyMutation($managerID: Int, $orderStatusID: Int!) {\n  insert_erp_Orders(objects: {ManagerID: $managerID, OrderStatusID:  $orderStatusID}) {\n    returning {\n      OrderID\n    }\n  }\n}\n"]))),Vn=function(e){var t=Object(o.useReducer)(Yn,Bn),n=Object(b.a)(t,2),a=n[0],c=n[1],i=a.inbox,s=a.decision,d=a.inproduction,u=Object(m.g)(),l=function(e){return"inbox"===e?i:"decision"===e?s:"inproduction"===e?d:void 0},j=[{columnName:"\u0412\u0445\u043e\u0434\u044f\u0449\u0438\u0435",droppableId:"inbox",data:i,orderStatusID:10},{columnName:"\u041f\u0440\u0438\u043d\u044f\u0442\u0438\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u044f",droppableId:"decision",data:s,orderStatusID:11},{columnName:"\u0412 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0441\u0442\u0432\u0435",droppableId:"inproduction",data:d,orderStatusID:12}],O=Object(w.useMutation)(Qn),h=Object(b.a)(O,1)[0],f=Object(w.useMutation)(Kn,{variables:{orderStatusID:j[0].orderStatusID}}),x=Object(b.a)(f,1)[0];Object(w.useSubscription)(zn,{onSubscriptionData:function(e){var t=e.subscriptionData.data.erp_Orders;t.map((function(e){return e.id=e.OrderID.toString(),e})),j.forEach((function(e){c({type:e.droppableId,payload:t.filter((function(t){return t.OrderStatusID===e.orderStatusID}))})}))}});function v(e){return e.NeedAttention?Rn.a.needAttention:e.AwaitingDispatch?Rn.a.awaitingDispatch:void 0}return Object(p.jsxs)("div",{className:Rn.a.reclatationLayout,children:[Object(p.jsxs)("div",{className:"pageLayout__header",children:[Object(p.jsx)(qn.a,{className:"pageLayout__icon"}),Object(p.jsx)("div",{className:"pageLayout__title",children:"\u0420\u0435\u043a\u043b\u0430\u043c\u0430\u0446\u0438\u044f"}),Object(p.jsxs)("div",{className:"pageLayout__actions",children:[Object(p.jsx)(I.a,{variant:"iconic",onClick:function(){x().then((function(e){u.push("/orders/".concat(e.data.insert_erp_Orders.returning[0].OrderID,"?edit=true"))}))},children:Object(p.jsx)(H.a,{})}),Object(p.jsx)(I.a,{variant:"iconic",children:Object(p.jsx)(on.a,{})})]})]}),Object(p.jsx)(Wn.a,{onDragEnd:function(e){var t=e.source,n=e.destination;if(n)if(t.droppableId===n.droppableId){var r=function(e,t,n){var r=Array.from(e),a=r.splice(t,1),c=Object(b.a)(a,1)[0];return r.splice(n,0,c),r}(l(t.droppableId),t.index,n.index);c({type:t.droppableId,payload:r})}else{var a=function(e,t,n,r){var a=Array.from(e),c=Array.from(t),i=a.splice(n.index,1),s=Object(b.a)(i,1)[0];c.splice(r.index,0,s);var o={};return o[n.droppableId]=a,o[r.droppableId]=c,{result:o,movedObj:s}}(l(t.droppableId),l(n.droppableId),t,n),i=a.result,s=a.movedObj;Object.entries(i).map((function(e){e[0]===e[0]&&c({type:e[0],payload:e[1]})})),h({variables:{OrderID:s.OrderID,OrderStatusID:j.find((function(e){return e.droppableId===n.droppableId})).orderStatusID}})}},children:Object(p.jsx)(P.a,{className:Rn.a.columnWrapper,children:j.map((function(e){return Object(p.jsxs)("div",{className:Rn.a.reclColumn,children:[Object(p.jsx)(be.a,{className:Rn.a.heading,children:e.columnName}),Object(p.jsx)(Wn.c,{droppableId:e.droppableId,children:function(t,n){return Object(p.jsxs)("div",{ref:t.innerRef,className:Rn.a.draggableWrapper,children:[e.data.map((function(e,t){return Object(p.jsx)(Wn.b,{draggableId:e.id,index:t,children:function(t,n){return Object(p.jsx)("div",Object(r.a)(Object(r.a)(Object(r.a)({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{style:(c=n.isDragging,i=t.draggableProps.style,Object(r.a)({userSelect:"none",background:c?"var(--accentLight)":"transparent"},i)),children:(a=e,0===a.OrderItems.length?Object(p.jsx)(W.b,{to:"/orders/".concat(a.OrderID),className:Rn.a.item,children:Object(p.jsx)("div",{children:"\u041d\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e"})}):Object(p.jsxs)(W.b,{to:"/orders/".concat(a.OrderID),className:"".concat(Rn.a.item," ").concat(v(a)),children:[Object(p.jsx)("div",{className:Rn.a.items,children:a.OrderItems.map((function(e){return Object(p.jsx)("div",{className:Rn.a.orderItem,children:e.Name},e.OrderItemID)}))}),Object(p.jsx)("div",{children:a.Entity}),Object(p.jsx)("div",{children:a.City})]}))}));var a,c,i}},e.id)})),t.placeholder]})}})]},e.columnName)}))})})]})},Gn=function(){return Object(p.jsxs)(m.d,{children:[Object(p.jsx)(m.b,{path:"/login",component:D}),Object(p.jsx)(f,{exact:!0,path:"/",component:Be}),Object(p.jsx)(f,{path:"/attendance",component:Hn}),Object(p.jsx)(f,{path:"/reclamation",component:Vn}),Object(p.jsx)(f,{path:"/orders/:id",component:_n}),"#if required route was not found",Object(p.jsx)(m.a,{to:"/"})]})},Jn=function(e){return Object(p.jsxs)("div",{className:"base-container",children:[Object(p.jsx)(Gn,{}),e.children]})},Zn=(n(514),n(616)),Xn=n(627),er=n(632),tr=n(623),nr=n(612),rr=n(613),ar=n(614),cr=n(615),ir=n(631),sr=n(646),or=n(172),dr=n.n(or),ur=n(312),lr="dark";var jr=function(e,t){var n=Object(ur.useMediaQuery)({query:"(prefers-color-scheme: dark)"},void 0),r=e;return Object(o.useEffect)((function(){"dark"===e?document.documentElement.classList.add(lr):"light"===e?document.documentElement.classList.remove(lr):"system"===e&&(n?document.documentElement.classList.add(lr):document.documentElement.classList.remove(lr))}),[e,n]),"system"===e&&(r=n?"dark":"light"),{appTheme:e,mode:r,changeTheme:function(e){var n=new Date;n.setFullYear(n.getFullYear()+1),document.cookie="theme=".concat(e,"; expires=").concat(n,"; path=/"),t(e)}}},br=Object(U.a)(ir.a)((function(e){e.theme;return{"& .MuiToggleButtonGroup-grouped":{border:"1px solid var(--border)",padding:8,textTransform:"none","&:not(:first-of-type)":{},"&:first-of-type":{borderTopLeftRadius:"var(--br)",borderBottomLeftRadius:"var(--br)"},"&:last-of-type":{borderTopRightRadius:"var(--br)",borderBottomRightRadius:"var(--br)"}}}}));function Or(e){var t="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===t.length)return t.pop().split(";").shift()}function mr(){var e=Object(o.useContext)(Tr).store,t=Object(o.useState)(!1),n=Object(b.a)(t,2),r=n[0],a=n[1],c=Object(m.g)(),d=jr(e.UItheme.state,e.UItheme.dispatch).changeTheme;function u(){return l.apply(this,arguments)}function l(){return(l=Object(s.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.logout();case 2:c.push("/login");case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var j,O=function(e,t){d(t)},h=function(e){return function(t){a(e)}};return Object(p.jsxs)("div",{children:[Object(p.jsx)("div",{onClick:h(!0),children:Object(p.jsx)(cr.a,{})}),Object(p.jsx)(Xn.a,{open:r,onClose:h(!1),children:(j="left",Object(p.jsxs)(P.a,{sx:{width:"top"===j||"bottom"===j?"auto":400},role:"presentation",onKeyDown:h(!1),children:[Object(p.jsxs)(er.a,{children:[Object(p.jsx)(tr.a,{className:dr.a.user,children:Object(p.jsxs)("div",{children:["\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c, ",e.user.FirstName," ",e.user.LastName,"!"]})}),Object(p.jsx)(tr.a,{children:Object(p.jsxs)(br,{className:dr.a.themeToggleButtons,color:"primary",value:Or("theme"),exclusive:!0,fullWidth:!0,onChange:O,children:[Object(p.jsxs)(sr.a,{value:"light",children:[" ",Object(p.jsx)(nr.a,{})," Light"]}),Object(p.jsxs)(sr.a,{value:"system",children:[" ",Object(p.jsx)(rr.a,{}),"System"]}),Object(p.jsxs)(sr.a,{value:"dark",children:[" ",Object(p.jsx)(ar.a,{})," Dark"]})]})})]}),Object(p.jsx)("div",{className:dr.a.logoutButton,children:Object(p.jsx)("button",{onClick:u,children:"\u0412\u044b\u0439\u0442\u0438"})})]}))})]})}var pr=function(){return Object(p.jsxs)("div",{className:"Sidebar noprint",children:[Object(p.jsx)(W.c,{exact:!0,to:"/",activeClassName:"sidebar-active",className:"action-icon",children:Object(p.jsx)(Zn.a,{})}),Object(p.jsx)(W.c,{to:"/reclamation",activeClassName:"sidebar-active",className:"action-icon",children:Object(p.jsx)(qn.a,{})}),Object(p.jsx)(W.c,{to:"/attendance",activeClassName:"sidebar-active",className:"action-icon",children:Object(p.jsx)(Pn.a,{})}),Object(p.jsx)("div",{className:"action-icon settings",children:Object(p.jsx)(mr,{})})]})},hr=n(316),fr=n(624);var xr=Object(O.a)((function(){var e=Object(o.useContext)(Tr).store,t=Object(o.useState)((function(){return function(e){var t="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===t.length)return t.pop().split(";").shift()}("theme")})),n=Object(b.a)(t,2),a=n[0],c=n[1];e.setUItheme(a,c);var i=jr(a,c).mode,s=Object(o.useMemo)((function(){return Object(hr.a)(function(e){return{palette:Object(r.a)({mode:e},"light"===e?{primary:{main:"#3763FE",light:"#E7E9FB"},secondary:{main:"#e5534b"}}:{primary:{main:"#99affc",light:"#43435c"},secondary:{main:"#e5534b"}}),typography:{fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',sans-serif",subtitle1:{fontSize:".7rem",textTransform:"uppercase",fontWeight:600,letterSpacing:".5px"}}}}(i))}),[i]);return s=Object(hr.a)(s,function(e){return{components:{MuiDialog:{styleOverrides:{paper:{background:"var(--L0) !important",borderRadius:"var(--br) !important"}}},MuiDialogTitle:{styleOverrides:{root:{color:e.palette.text.primary}}},MuiMenuItem:{styleOverrides:{root:{fontSize:".8rem"}},defaultProps:{disableRipple:!0}},MuiListItemText:{styleOverrides:{primary:{fontSize:".8rem"}}},MuiListItemIcon:{styleOverrides:{root:{minWidth:"25px !important",svg:{width:"17px"},path:{strokeWidth:.8,stroke:"var(--L0)"}}}},MuiButton:{styleOverrides:{root:{fontSize:".8rem",textTransform:"none !important"},textInfo:{color:"var(--lowContrast) !important"},iconic:{minWidth:"40px",padding:"5px",path:{color:e.palette.text.primary,strokeWidth:.8,stroke:"var(--L0)"},"&:hover":{background:"var(--accentLight)"}}},defaultProps:{disableElevation:!0,disableRipple:!0}},MuiTextField:{defaultProps:{variant:"standard",autoComplete:"off"}},MuiInputLabel:{styleOverrides:{root:{color:"var(--lowContrast) !important"},filter:{fontSize:".8rem",transform:"none",position:"relative"}},defaultProps:{shrink:!0}},MuiFilledInput:{defaultProps:{disableUnderline:"true",size:"small"},styleOverrides:{root:{background:"var(--L1)",border:"1px solid var(--borderLight)",borderRadius:"10px",":hover":{background:"var(--L1)"}}}},MuiInput:{defaultProps:{disableUnderline:"true"}},MuiInputBase:{styleOverrides:{root:{color:"var(--highContrast) !important"}}},MuiOutlinedInput:{styleOverrides:{notchedOutline:{border:"none"}}},MuiPopover:{styleOverrides:{paper:{background:"var(--L0)",borderRadius:"var(--br) !important"}}},MuiSelect:{styleOverrides:{select:{fontSize:".8rem",boxSizing:"border-box",border:"none !important",outline:"none !important",boxShadow:"none !important",padding:0}}},MuiTab:{defaultProps:{disableRipple:!0}},MuiCheckbox:{defaultProps:{disableRipple:!0}}}}}(s)),Object(p.jsx)(fr.a,{theme:s,children:Object(p.jsxs)("div",{className:"App",children:[e.inMemoryToken&&Object(p.jsx)(pr,{}),Object(p.jsx)(Jn,{})]})})})),vr=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,647)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))},gr=n(122),Ir=n(44),Dr=n(112),yr=n.n(Dr),_r="https://factory.piek.ru/api",Nr=yr.a.create({withCredentials:!0,baseURL:_r}),Cr=function(){function e(){Object(Se.a)(this,e)}return Object(gr.a)(e,null,[{key:"login",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Nr.post("/login",{email:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Nr.post("/logout"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),kr=function(){function e(){Object(Se.a)(this,e),this.user={},this.isLoading=!1,this.UItheme={state:null,dispatch:null},this.inMemoryToken=void 0,this.priorityTab=1,this.cachedOrders=[],this.cachedPreOrders=[],this.pageParams=[{url:"/reclamation",icon:Object(p.jsx)(qn.a,{}),title:"\u0420\u0435\u043a\u043b\u0430\u043c\u0430\u0446\u0438\u044f"},{url:"/attendance",icon:Object(p.jsx)(Pn.a,{}),title:"\u0420\u0430\u0431\u043e\u0447\u0435\u0435 \u0432\u0440\u0435\u043c\u044f"}],Object(Ir.d)(this)}return Object(gr.a)(e,[{key:"setAuth",value:function(e){this.isAuth=e}},{key:"setUser",value:function(e){this.user=e}},{key:"setLoading",value:function(e){this.isLoading=e}},{key:"setInMemoryToken",value:function(e){this.inMemoryToken=e}},{key:"setPriorutyTab",value:function(e){this.priorityTab=e}},{key:"setCachedOrders",value:function(e){this.cachedOrders=e}},{key:"setCachedPreOrders",value:function(e){this.cachedPreOrders=e}},{key:"setUItheme",value:function(e,t){this.UItheme={state:e,dispatch:t}}},{key:"login",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Cr.login(t,n);case 3:if(200!==(r=e.sent).status){e.next=8;break}return this.setInMemoryToken(r.data.accessToken),this.setUser(r.data.user),e.abrupt("return",r);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Cr.logout();case 3:this.setInMemoryToken(null),this.setUser({}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(null===(t=e.t0.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNewToken",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",yr.a.get("".concat(_r,"/refresh"),{withCredentials:!0}).then((function(e){return t.setInMemoryToken(e.data.accessToken),e.data.accessToken})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"checkAuth",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setLoading(!0),e.prev=1,e.next=4,yr.a.get("".concat(_r,"/refresh"),{withCredentials:!0}).then((function(e){200===e.status&&(console.log(e),t.setUser(e.data.user),t.setInMemoryToken(e.data.accessToken),console.log("token validation complited"))}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:return e.prev=9,this.setLoading(!1),e.abrupt("return",this.inMemoryToken);case 13:case"end":return e.stop()}}),e,this,[[1,6,9,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"uploadFile",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FormData,t.map((function(e){return n.append("files",e)})),e.next=4,yr.a.post("".concat("https://factory.piek.ru/api","/s3/upload"),n,{headers:{"Content-Type":"multipart/form-data"}});case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"downloadFile",value:function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://factory.piek.ru/api","/s3/get/").concat(t.Key));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteFile",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yr.a.get("".concat("https://factory.piek.ru/api","/s3/delete/").concat(t));case 2:if(200!==e.sent.status){e.next=8;break}return e.next=6,n({variables:{key:t}});case 6:r=e.sent,console.log(r.data);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getPageParams",value:function(e){return this.pageParams.find((function(t){return t.url===e}))}}]),e}(),wr=(n(533),n(534),n(319)),Sr=n(313),Mr=["headers"],Ar=new kr,Tr=Object(o.createContext)({store:Ar}),Fr=new wr.a({uri:"wss://hasura.piek.ru/v1/graphql",options:{reconnect:!0,lazy:!0,reconnectionAttempts:5,inactivityTimeout:1e7,connectionCallback:function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&console.log(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),connectionParams:function(){return{headers:{Authorization:"Bearer ".concat(Ar.inMemoryToken)}}}}}),Lr=Object(Sr.a)(function(){var e=Object(s.a)(i.a.mark((function e(t,n){var c,s,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=n.headers,s=Object(a.a)(n,Mr),o=null,!(Date.now()>=1e3*j.a.decode(Ar.inMemoryToken).exp)){e.next=7;break}return console.log("Existed access token was expired, request for new token.."),e.next=6,Ar.getNewToken();case 6:o=e.sent;case 7:return e.abrupt("return",Object(r.a)({headers:Object(r.a)(Object(r.a)({},c),o?{Authorization:"Bearer ".concat(o)}:{})},s));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),$r=new w.ApolloClient({link:Object(w.from)([Lr,Fr]),cache:new w.InMemoryCache({typePolicies:{erp_Orders:{keyFields:["OrderID"]},erp_CheckListUnits:{keyFields:["CheckListUnitID"]},erp_Comments:{keyFields:["CommentID"]}}})}),Pr=document.getElementById("root");u.a.render(Object(p.jsx)(w.ApolloProvider,{client:$r,children:Object(p.jsx)(W.a,{children:Object(p.jsx)(xr,{sessionData:Pr.dataset.session,children:Object(p.jsx)(Tr.Provider,{value:Ar})})})}),Pr),vr()},60:function(e,t,n){e.exports={OrderListLayout:"main_OrderListLayout__3KzFa",tableWrapper:"main_tableWrapper__3lHmG",tableFooter:"main_tableFooter__1Egk2",tableMain:"main_tableMain__GJwKh",awaitingDispatch:"main_awaitingDispatch__ZF9uh",needAttention:"main_needAttention__io1X5",unpaidOrder:"main_unpaidOrder__22HJx",customerTableInfo:"main_customerTableInfo__JKJM7"}},77:function(e,t,n){e.exports={reclatationLayout:"ReclamationLayout_reclatationLayout__FiTwi",columnWrapper:"ReclamationLayout_columnWrapper__1SCgf",reclColumn:"ReclamationLayout_reclColumn__2kHvs",draggableWrapper:"ReclamationLayout_draggableWrapper__10OPa",heading:"ReclamationLayout_heading__1S6l3",item:"ReclamationLayout_item__2uY2m",orderItem:"ReclamationLayout_orderItem__3U0kY",needAttention:"ReclamationLayout_needAttention__2S9H-",awaitingDispatch:"ReclamationLayout_awaitingDispatch__GUQT9"}},95:function(e,t,n){e.exports={name:"composition_name__1O75u",quantity:"composition_quantity__2YtVw",unitName:"composition_unitName__3YGne",addOrderItem:"composition_addOrderItem__2AnFf",quantityInput:"composition_quantityInput__2zcBe",Unit:"composition_Unit__2Fqng",index:"composition_index__2aXz6",fullName:"composition_fullName__NObJ0"}}},[[544,1,2]]]);
//# sourceMappingURL=main.d615f6d7.chunk.js.map