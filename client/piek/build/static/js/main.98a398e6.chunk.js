(this.webpackJsonppiek=this.webpackJsonppiek||[]).push([[0],{148:function(e,t,n){},149:function(e,t,n){},228:function(e,t,n){},235:function(e,t,n){},236:function(e,t,n){},237:function(e,t,n){},238:function(e,t,n){},239:function(e,t,n){},267:function(e,t,n){"use strict";n.r(t),n.d(t,"Context",(function(){return Ye}));var r,a=n(140),c=n(1),s=n(71),i=n.n(s),o=(n(99),n(148),n(84)),l=n(277),u=n(19),d=n(16),j=n(278),b=n(294),O=n(279),h=n(296),p=(n(149),n(0)),m=Object(o.a)((function(e){var t=Object(c.useState)(""),n=Object(d.a)(t,2),r=n[0],a=n[1],s=Object(c.useState)(""),i=Object(d.a)(s,2),o=i[0],u=i[1],m=Object(c.useContext)(Ye).store;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(l.a,{className:"loginCard",children:[Object(p.jsx)(j.a,{marginBottom:24,size:20,fontWeight:900,color:"var(--text1) ",children:"\u0412\u043e\u0439\u0442\u0438"}),Object(p.jsx)(b.a,{className:"LoginInput",width:"300px",inputHeight:Object(O.a)(10),label:"Email",value:r,onChange:function(e){return a(e.target.value)}}),Object(p.jsx)(b.a,{label:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"LoginInput",inputHeight:Object(O.a)(10),value:o,onChange:function(e){return u(e.target.value)}}),Object(p.jsx)(h.a,{className:"Button",width:"300px",size:"large",onClick:function(){return m.login(r,o)},children:"\u0412\u043e\u0439\u0442\u0438"})]})})})),x=n(24),g=n(42),f=n(25),v=Object(f.a)(r||(r=Object(g.a)(["\nsubscription GetOrders {\n    erp_Orders(where: {OrderStatusID: {_neq: 4}}) {\n      OrderID\n      Entity\n      InvoiceNumber\n      City\n      ShippingDate\n      PaidAmount\n      TotalAmount\n      OrderStatus {\n        Name\n        ID\n      }\n      OrderItems {\n        Quantity\n        OrderItemID\n        Name\n        OrderID\n        \n      }\n      \n    }\n  }\n\n"]))),D=n(8),N=n(80),y=n(30),I=function(e,t){return e&&t?" - "+(t/e*100).toFixed(0)+"%":" "},C=function(e){return e.split("-")[2]+"."+e.split("-")[1]+"."+e.split("-")[0].slice(2)},k=[{Header:"",id:"index",accessor:function(e,t){return t+1}},{Header:"\u041d\u0430\u0438\u043c.",id:"orderItems",accessor:function(e){return Object(p.jsx)(y.b,{to:"/order/".concat(e.OrderID),children:e.OrderItems.map((function(e){return Object(p.jsx)("div",{children:Object(p.jsx)("span",{children:e.Name})},e.OrderItemID)}))})}},{Header:"\u041a\u043e\u043b-\u0432\u043e",accessor:function(e){return e.OrderItems.map((function(e){return Object(p.jsx)("div",{children:Object(p.jsx)("div",{children:e.Quantity})},e.OrderItemID)}))}},{Header:"\u041e\u0442\u0433\u0440\u0443\u0437\u043a\u0430",accessor:function(e){return C(e.ShippingDate)}},{Header:"\u0421\u0447\u0435\u0442- \u043e\u043f\u043b\u0430\u0442\u0430",accessor:function(e){return"\u2116 "+e.InvoiceNumber+I(e.TotalAmount,e.PaidAmount)}},{Header:"\u041a\u043e\u043c\u043f\u0430\u043d\u0438\u044f",accessor:"Entity"},{Header:"\u0413\u043e\u0440.",accessor:"City"},{Header:"\u041f\u0435\u0440\u0432. \u043f\u043b\u0430\u0442\u0435\u0436",accessor:"ShippingDate"}];function w(e){var t=e.columns,n=e.data,r=e.id,a=e.heading,c=Object(N.useTable)({columns:t,data:n}),s=c.getTableProps,i=c.getTableBodyProps,o=c.headerGroups,l=c.rows,u=c.prepareRow;return 0==n.length?null:Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(j.a,{className:"group-heading",children:a}),Object(p.jsxs)("table",Object(D.a)(Object(D.a)({id:r,className:"priority-table"},s()),{},{children:[Object(p.jsx)("thead",{children:o.map((function(e,t){return Object(p.jsx)("tr",Object(D.a)(Object(D.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e,t){return Object(p.jsx)("th",Object(D.a)(Object(D.a)({},e.getHeaderProps()),{},{children:e.render("Header")}))}))}),t)}))}),Object(p.jsx)("tbody",Object(D.a)(Object(D.a)({},i()),{},{children:l.map((function(e,t){return u(e),Object(p.jsx)("tr",Object(D.a)(Object(D.a)({},e.getRowProps()),{},{children:e.cells.map((function(e,t){return Object(p.jsx)("td",Object(D.a)(Object(D.a)({},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]}))]})}var S,P,_,M,L=n(141),F=n(281),A=n(282),H=(n(228),Object(f.b)(S||(S=Object(g.a)(["\n    mutation MyMutation($OrderID: Int!, $OrderStatus: Int!){\n    update_erp_Orders_by_pk(pk_columns: {OrderID: $OrderID}, _set: {OrderStatusID: $OrderStatus}) {\n        OrderID\n    }\n  }\n\n"])))),T=function(e){var t=Object(c.useState)(!1),n=Object(d.a)(t,2),r=n[0],a=n[1],s=Object(x.useMutation)(H),i=Object(d.a)(s,2),o=i[0],l=(i[1].data,e.preOrders),u=function(){var e;a(!r);var t=document.getElementById("grow");0==t.clientHeight?t.style.height=(null===(e=document.getElementById("measuringWrapper"))||void 0===e?void 0:e.clientHeight)+10+"px":t.style.height=0},b=Object(L.a)(k);return b.push({Header:" ",accessor:function(e){return Object(p.jsx)("div",{onClick:function(){return function(e){o({variables:{OrderID:e.OrderID,OrderStatus:1}}),l.splice(l.indexOf(e),1),0==l.length&&u()}(e)},className:"acceptOrderButton",children:Object(p.jsx)(F.a,{})})}}),Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("div",{className:r?"preorders-container active":"preorders-container",children:[Object(p.jsxs)(j.a,{onClick:u,className:"group-heading preorders-heading",children:[" \u041f\u0440\u0435\u0434\u0437\u0430\u043a\u0430\u0437\u044b ",Object(p.jsx)("span",{children:Object(p.jsx)(A.a,{})})]}),Object(p.jsx)("div",{id:"grow",children:Object(p.jsx)(w,{id:"measuringWrapper",columns:b,data:e.preOrders})})]})})},U=n(295),$=function(e){return Object(p.jsxs)("div",{className:"base-container page-header",children:[Object(p.jsx)("span",{children:e.pageParams.icon}),Object(p.jsx)(j.a,{children:e.pageParams.title}),Object(p.jsx)("div",{className:"search-box",children:Object(p.jsx)(U.a,{height:Object(O.a)(10),onChange:function(t){return e.search(t)},className:"search-input"})})]})},E=n(283),B=n(284),R=function(e){return Object(p.jsxs)("div",{className:"action-block",children:[Object(p.jsx)("div",{"data-for":"global","data-tip":"\u0420\u0430\u0441\u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c",className:"action-icon",children:Object(p.jsx)(E.a,{})}),Object(p.jsx)("div",{"data-for":"global","data-tip":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",className:"action-icon",children:Object(p.jsx)(F.a,{})}),Object(p.jsx)("div",{"data-for":"global","data-tip":"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f",className:"action-icon",children:Object(p.jsx)(B.a,{})})]})},Y=function(e){var t=[],n=[],r=Object(c.useContext)(Ye).store,a=Object(x.useSubscription)(v),s=(a.error,a.loading,a.data),i=void 0===s?[]:s;i.erp_Orders&&(i.erp_Orders.sort((function(e,t){return t.ShippingDate<e.ShippingDate?1:-1})),i.erp_Orders.forEach((function(e){3==e.OrderStatus.ID?t.push(e):1==e.OrderStatus.ID&&n.push(e)})));var o=Object(c.useMemo)((function(){return k}),[]);return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(R,{}),Object(p.jsxs)("div",{className:"Container-1200",children:[Object(p.jsx)($,{pageParams:r.getPageParams(window.location.pathname)}),i.erp_Orders&&t?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(T,{preOrders:t}),Object(p.jsx)(w,{columns:o,data:n})]}):r.preloader]})]})},Q=(n(235),n(137)),q=n(95),G=n.n(q),W=function(e){var t=[],n=[],r=Object(c.useContext)(Ye).store,a=null,s=Object(x.useSubscription)(v),i=(s.error,s.loading,s.data),o=void 0===i?{}:i;o.erp_Orders&&(o.erp_Orders.sort((function(e,t){return t.ShippingDate<e.ShippingDate?1:-1})),o.erp_Orders.forEach((function(e){3==e.OrderStatus.ID?t.push(e):1==e.OrderStatus.ID&&n.push(e)})),a=function(e){var t=[{name:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",date:G()().subtract(0,"day").format("YYYY-MM-DD"),objs:[]},{name:"\u0412\u0447\u0435\u0440\u0430",date:G()().subtract(1,"day").format("YYYY-MM-DD"),objs:[]},{name:"",objs:[]}];if(e){var n,r=Object(Q.a)(e);try{var a=function(){var e=n.value,r=!1;t.forEach((function(t){e.ShippingDate===t.date?(t.objs.push(e),r=!0):""!==t.name||r||t.objs.push(e)}))};for(r.s();!(n=r.n()).done;)a()}catch(c){r.e(c)}finally{r.f()}}return t}(n));var l=Object(c.useMemo)((function(){return k}),[]);return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(R,{}),Object(p.jsxs)("div",{className:"Container-1200",children:[Object(p.jsx)($,{pageParams:r.getPageParams(window.location.pathname)}),a?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(T,{preOrders:t}),console.log(a),Object(p.jsx)(w,{columns:l,data:a[0].objs,heading:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f"}),Object(p.jsx)(w,{columns:l,data:a[1].objs,heading:"\u0412\u0447\u0435\u0440\u0430"}),Object(p.jsx)(w,{columns:k,data:a[2].objs})]}):r.preloader]}),e.children]})},J=Object(f.a)(P||(P=Object(g.a)(["\nquery MyQuery($OrderID: Int!) {\n  erp_Orders(where: {OrderID: {_eq: $OrderID}}) {\n    City\n    CreatingDate\n    Comment\n    Entity\n    InvoiceNumber\n    IsReclamation\n    ManagerID\n    OrderID\n    OrderNumber\n    OrderStatusID\n    PaidAmount\n    ShipmentComment\n    ShippingDate\n    TotalAmount\n    User {\n      FirstName\n      LastName\n      UserID\n    }\n    OrderItems {\n      Fitter\n      Name\n      OrderItemID\n      OrderID\n      Quantity\n      SerialNumber\n    }\n    CheckListUnits {\n      IsComplited\n      OrderID\n      Point\n      CheckListUnitID\n    }\n  }\n}\n"]))),z=(n(236),function(e){return Object(p.jsx)("div",{className:"Composition",children:e.data.map((function(e){return Object(p.jsxs)("div",{className:"Unit",children:[Object(p.jsxs)("div",{className:"Name",children:[" ",e.Name," "]}),Object(p.jsxs)("div",{className:"Quantity",children:[" ",e.Quantity]}),Object(p.jsx)("div",{children:"\u0421\u0431\u043e\u0440\u0449\u0438\u043a"}),Object(p.jsx)("div",{children:"\u0421\u0435\u0440 \u043d\u043e\u043c\u0435\u0440"})]},e.OrderItemID)}))})}),V=n(285),K=(n(237),function(e){e.data.ShippingDate.split("-")[2],e.data.ShippingDate.split("-")[1],e.data.ShippingDate.split("-")[0].slice(2);return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{className:"SignificantInfo",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("pre",{children:"\u041f\u043b\u0430\u043d. \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0430"}),C(e.data.ShippingDate)]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("pre",{children:"\u0421\u0447\u0435\u0442 / \u043e\u043f\u043b\u0430\u0442\u0430"}),"\u2116 "+e.data.InvoiceNumber+I(e.data.TotalAmount,e.data.PaidAmount),Object(p.jsx)("span",{className:"PaymentHistory",children:Object(p.jsx)(V.a,{})})]})]}),Object(p.jsxs)("div",{className:"MetaWrapper",children:[Object(p.jsxs)("div",{className:"Left",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("pre",{children:"\u041d\u043e\u043c\u0435\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),e.data.OrderNumber]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("pre",{children:"\u0421\u043e\u0437\u0434\u0430\u043d"}),e.data.ShippingDate]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("pre",{children:"\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440"}),e.data.User.FirstName," ",e.data.User.LastName]})]}),Object(p.jsxs)("div",{className:"Right",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("pre",{children:"\u042e\u0440 \u041b\u0438\u0446\u043e"}),e.data.Entity]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("pre",{children:"\u0413\u043e\u0440"}),e.data.City]})]})]}),Object(p.jsxs)("div",{className:"OrderComment",children:[Object(p.jsx)("pre",{children:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"}),e.data.Comment]})]})}),X=Object(f.b)(_||(_=Object(g.a)(["\nmutation MyMutation($CheckListUnitID: Int!, $IsCompluted: Boolean!) {\n  update_erp_CheckListUnits_by_pk(pk_columns: {CheckListUnitID: $CheckListUnitID}, _set: {IsComplited: $IsCompluted}) {\n    CheckListUnitID\n    IsComplited\n    Point\n  }\n}\n"]))),Z=function(e){var t=Object(x.useMutation)(X),n=Object(d.a)(t,2),r=n[0],a=(n[1].loading,JSON.parse(JSON.stringify(e.data)));a.sort((function(e,t){return t.Point<e.Point?1:-1}));var c=a.map((function(e){return Object(p.jsx)("div",{className:e.IsComplited?"CheckListUnit complited":"CheckListUnit",onClick:function(t){return function(e,t){e.target.classList.toggle("complited"),r({variables:{CheckListUnitID:t.CheckListUnitID,IsCompluted:!t.IsComplited}})}(t,e)},children:e.Point},e.CheckListUnitID)}));return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("div",{children:c})})},ee=n(18),te=n.n(ee),ne=n(31),re=function(e){var t=Object(c.useContext)(Ye).store,n=Object(c.useState)(" "),r=Object(d.a)(n,2),a=r[0],s=r[1],i=function(){var e=Object(ne.a)(te.a.mark((function e(n){var r;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),(r=new FormData).append("file",a),t.uploadFile(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("div",{children:Object(p.jsxs)("form",{onSubmit:i,method:"post",encType:"multipart/form-data",children:[Object(p.jsx)("input",{onChange:function(e){var t=e.target.files[0];s(t),console.log("sets file",t)},type:"file",name:"file"}),Object(p.jsx)("button",{type:"submit",children:"Submit"})]})})})},ae=function(e){var t=Object(c.useContext)(Ye).store,n=Object(x.useQuery)(J,{fetchPolicy:"no-cache",variables:{OrderID:Object(u.g)().id}}),r=(n.loading,n.error,n.data),a=void 0===r?[]:r;return console.log("\u0437\u0430\u043f\u0440\u043e\u0441 "),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(R,{}),a.erp_Orders?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{className:"page-header",children:Object(p.jsxs)(j.a,{children:[a.erp_Orders[0].Entity," __  ",a.erp_Orders[0].City]})}),Object(p.jsxs)("section",{className:"OrderLayout",children:[Object(p.jsxs)("div",{className:"Main",children:[Object(p.jsx)(z,{data:a.erp_Orders[0].OrderItems}),Object(p.jsxs)("div",{className:"WrapperTwoCol",children:[Object(p.jsx)("div",{className:"CheckList",children:Object(p.jsx)(Z,{data:a.erp_Orders[0].CheckListUnits})}),Object(p.jsx)("div",{className:"Docs",children:Object(p.jsx)(re,{data:a.erp_Orders[0].Docs})})]})]}),Object(p.jsx)("div",{className:"Meta",children:Object(p.jsx)(K,{data:a.erp_Orders[0]})})]})]}):t.preloader]})},ce=Object(f.a)(M||(M=Object(g.a)(["\nsubscription MyQuery($gte: timestamp!, $lte: timestamp!, $search: String!) {\n  attendance_users_aggregate(\n    order_by: {lastname: asc},\n    where: {_or: [ {firstname: {_ilike: $search}}, {lastname: {_ilike: $search}} ] }\n    ){\n    nodes {\n      id\n      card\n      firstname\n      lastname\n      intervalsPools(where: {entrance: {_gte: $gte,  _lte: $lte}}) {\n        entrance\n        exit\n        card\n        interval\n        status\n      }\n    }\n  }\n}  \n"])));function se(e){var t=Object(d.a)(e,2),n=t[0],r=t[1];return new Date(r,n+1,0).getDate()}function ie(e,t,n){function r(e){var t=e.getMinutes();return t<10?"0".concat(t):t}var a=t.find((function(t){return new Date(t.entrance).getDate()==e}));if(a){var c=new Date(a.entrance),s=new Date(a.exit);return[c.getHours()+":"+r(c),s.getHours()+":"+r(s),function(e,t){e-=t/60;var n=Math.floor(e),r=e-n,a=1/60;r=a*Math.round(r/a);var c=Math.floor(60*r)+"";return c.length<2&&(c="0"+c),n+":"+c}(a.interval,n),a.status]}return[null,null,null,null]}function oe(e){var t=e.columns,n=e.data,r=e.id,a=(e.heading,Object(N.useTable)({columns:t,data:n})),c=a.getTableProps,s=a.getTableBodyProps,i=a.headerGroups,o=a.rows,l=a.prepareRow;return 0==n.length?null:Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("table",Object(D.a)(Object(D.a)({id:r,className:"attendance-table"},c()),{},{children:[Object(p.jsx)("thead",{children:i.map((function(e,t){return Object(p.jsx)("tr",Object(D.a)(Object(D.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e,t){return Object(p.jsx)("th",Object(D.a)(Object(D.a)({},e.getHeaderProps()),{},{children:e.render("Header")}))}))}),t)}))}),Object(p.jsx)("tbody",Object(D.a)(Object(D.a)({},s()),{},{children:o.map((function(e,t){return l(e),Object(p.jsx)("tr",Object(D.a)(Object(D.a)({},e.getRowProps()),{},{children:e.cells.map((function(e,t){return Object(p.jsx)("td",Object(D.a)(Object(D.a)({},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]}))})}n(238);function le(e,t){var n=e;return(n=new Date(e.getFullYear(),e.getMonth(),1)).setMonth(n.getMonth()+(t+1)),n.setDate(n.getDate()-1),e.getDate()<n.getDate()&&n.setDate(e.getDate()),n}var ue=function(e){var t=new Date,n=["\u044f\u043d\u0432","\u0444\u0435\u0432","\u043c\u0430\u0440","\u0430\u043f\u0440","\u043c\u0430\u0439","\u0438\u044e\u043d","\u0438\u044e\u043b","\u0430\u0432\u0433","\u0441\u0435\u043d","\u043e\u043a\u0442","\u043d\u043e\u044f","\u0434\u0435\u043a"];console.log("\u0440\u0435\u043d\u0434\u0435\u0440 \u0440\u0435\u0431\u0435\u043d\u043a\u0430");var r=function(t){var n=new Date(t.target.attributes.date.value);e.setSelectedMonth([n.getMonth(),n.getFullYear()])};return Object(p.jsxs)("div",{className:"reportConfigurator",children:[function(){for(var a=[],c=0;c<9;c++){var s=le(t,-c);a.push(Object(p.jsxs)("div",{onClick:r,className:s.getMonth()==e.selectedMonth[0]?"active":"",date:s,children:[" ",n[s.getMonth()]," "]}))}return Object(p.jsx)("div",{className:"chooseMonth",children:a})}(),Object(p.jsxs)("div",{className:"arguments",children:[Object(p.jsxs)("div",{className:"wrap",children:[Object(p.jsx)("span",{children:"\u043e\u0431\u0435\u0434"}),Object(p.jsx)("input",{type:"text",defaultValue:e.timeDeduction,onMouseLeave:function(t){return e.setTimeDeduction(t.target.value)}}),Object(p.jsx)("span",{children:"\u043c\u0438\u043d"})]}),Object(p.jsxs)("div",{className:"wrap",children:[Object(p.jsx)("span",{children:"\u043d\u043e\u0440\u043c\u0430"}),Object(p.jsx)("input",{type:"text",defaultValue:e.timeDeduction}),Object(p.jsx)("span",{children:"\u0447"})]})]})]})},de=function(e){var t=new Date,n=Object(c.useContext)(Ye).store,r=Object(c.useState)([t.getMonth()-1,t.getFullYear()]),a=Object(d.a)(r,2),s=a[0],i=a[1],o=Object(c.useState)(30),l=Object(d.a)(o,2),u=l[0],j=l[1],b=Object(c.useState)(""),O=Object(d.a)(b,2),h=O[0],m=O[1];console.log(u,"\u0440\u0435\u043d\u0434\u0435\u0440 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0433\u043e \u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430");var g=function(e){var t=Object(d.a)(e,2),n=t[0],r=t[1],a=(parseInt(n)+1).toString().replace(/(^|\D)(\d)(?!\d)/g,"$10$2");return{gte:r+"-"+a+"-01T00:00:00",lte:r+"-"+a+"-"+se(e)+"T23:59:59"}}(s),f=g.gte,v=g.lte,D=Object(x.useSubscription)(ce,{variables:{gte:f,lte:v,search:"%"+h+"%"}}),N=D.loading,y=(D.error,D.data),I=void 0===y?[]:y,C=Object(c.useMemo)((function(){return function(e,t){for(var n=[{Header:"\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a",accessor:function(e){return Object(p.jsxs)("div",{children:[Object(p.jsxs)("span",{children:[e.lastname," "]}),Object(p.jsxs)("span",{children:[e.firstname," "]})]})}},{Header:"\u0418\u0442\u043e\u0433\u043e",Cell:function(e){var n=0,r=e.row.original.intervalsPools;return r.forEach((function(e){n+=e.interval})),n-=t/60*r.length,Object(p.jsx)("div",{children:n.toFixed(0)})}}],r=1;r<=se(e);r++)n.push({Header:r.toString(),Cell:function(e){var n=ie(e.column.Header,e.row.original.intervalsPools,t),r=Object(d.a)(n,4),a=r[0],c=r[1],s=r[2],i=r[3];return Object(p.jsxs)("div",{className:"status-"+i,children:[Object(p.jsx)("div",{className:"eventTime",children:a}),Object(p.jsx)("div",{className:"eventTime",children:c}),Object(p.jsx)("div",{className:"interval",children:s})]})}});return n}(s,u)}),[u]);return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)($,{pageParams:n.getPageParams(window.location.pathname),search:function(e){var t=e.target.value.replace(/\s/g,"");m(t)}}),Object(p.jsx)(ue,{setSelectedMonth:i,selectedMonth:s,timeDeduction:u,setTimeDeduction:j}),Object(p.jsxs)("div",{className:"legend",children:[Object(p.jsx)("div",{className:"status-101",children:"\u041f\u0440\u0435\u0440\u0432\u0430\u043d\u043d\u044b\u0439 \u0440\u0430\u0431\u043e\u0447\u0438\u0439 \u0434\u0435\u043d\u044c"}),Object(p.jsx)("div",{className:"status-102",children:"\u041d\u0435 \u043e\u0442\u043c\u0435\u0447\u0435\u043d \u043a\u043e\u043d\u0435\u0446 \u0441\u043c\u0435\u043d\u044b"})]}),!N&&C&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(oe,{columns:C,data:I.attendance_users_aggregate.nodes}),Object(p.jsxs)("span",{className:"reportMeta",children:["\u041e\u0442\u0447\u0435\u0442 \u0437\u0430 ",s[0]+1," \u043c\u0435\u0441\u044f\u0446 ",s[1]," \u0433\u043e\u0434\u0430 "]})]})]})},je=n(6),be=["component"],Oe=function(e){var t=e.component,n=Object(je.a)(e,be),r=Object(c.useState)(void 0),a=Object(d.a)(r,2),s=a[0],i=a[1],o=Object(c.useState)(void 0),l=Object(d.a)(o,2),j=l[0],b=l[1];function O(){return(O=Object(ne.a)(te.a.mark((function e(){var t;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.store.checkAuth();case 2:t=e.sent,b(t.isAuth),i(t.isLoaded);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){localStorage.getItem("token")?function(){O.apply(this,arguments)}():window.location.href="/login"}),[]),Object(p.jsx)(u.b,Object(D.a)(Object(D.a)({},n),{},{render:function(e){if(s)return j?(console.log("PrivateRoute: return a component"),Object(p.jsx)(t,Object(D.a)({},e))):Object(p.jsx)(u.a,{to:"/login"});console.log("PrivateRoute: awaiting a response from checkAuth() ")}}))},he=function(e){return Object(p.jsxs)(u.d,{children:[Object(p.jsx)(u.b,{path:"/login",component:m}),Object(p.jsx)(Oe,{exact:!0,path:"/",component:Y,store:e.store}),Object(p.jsx)(Oe,{path:"/recently",component:W,store:e.store}),Object(p.jsx)(Oe,{path:"/attendance",component:de,store:e.store}),Object(p.jsx)(Oe,{path:"/order/:id",component:ae,store:e.store}),"#if required route was not found",Object(p.jsx)(u.a,{to:"/"})]})},pe=function(e){var t=Object(c.useContext)(Ye).store;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(l.a,{className:"base-container",children:[Object(p.jsx)(he,{store:t}),e.children]})})},me=(n(239),n(288)),xe=n(289),ge=n(290),fe=n(291),ve=n(292),De=n(293),Ne=n(138),ye=n(286),Ie=n(287),Ce="dark",ke=function(e){var t=Object(Ne.useMediaQuery)({query:"(prefers-color-scheme: dark)"},void 0,(function(e){s(e)})),n=Object(c.useState)(t),r=Object(d.a)(n,2),a=r[0],s=r[1];return Object(c.useEffect)((function(){a?document.documentElement.classList.add(Ce):document.documentElement.classList.remove(Ce)}),[a]),"none"==e.display?null:Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("div",{className:"DarkToggle ",onClick:function(){return s(!a)},children:a?Object(p.jsx)(ye.a,{}):Object(p.jsx)(Ie.a,{})})})},we=function(){var e=Object(c.useContext)(Ye).store;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(l.a,{className:"Sidebar",children:[Object(p.jsx)(y.c,{exact:!0,to:"/",activeClassName:"sidebar-active",className:"action-icon",children:Object(p.jsx)(me.a,{})}),Object(p.jsx)(y.c,{to:"/recently",activeClassName:"sidebar-active",className:"action-icon",children:Object(p.jsx)(xe.a,{})}),Object(p.jsx)(y.c,{to:"/reclamation",activeClassName:"sidebar-active",className:"action-icon",children:Object(p.jsx)(ge.a,{})}),Object(p.jsx)(y.c,{to:"/attendance",activeClassName:"sidebar-active",className:"action-icon",children:Object(p.jsx)(fe.a,{})}),Object(p.jsx)("a",{className:"action-icon",children:Object(p.jsx)(ke,{})}),Object(p.jsx)(y.c,{className:"action-icon",to:"/account",children:Object(p.jsx)(ve.a,{})}),Object(p.jsx)(y.c,{className:"action-icon",to:"/login",onClick:function(){return e.logout()},children:Object(p.jsx)(De.a,{})})]})})};var Se=Object(o.a)((function(){var e=Object(c.useContext)(Ye).store;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("div",{className:"App",children:[e.isAuth?Object(p.jsx)(we,{}):null,Object(p.jsx)(ke,{display:"none"}),Object(p.jsx)(pe,{})]})})})),Pe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,297)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))},_e=n(82),Me=n(83),Le=n(22),Fe=n(280),Ae=n(58),He=n.n(Ae),Te="https://45.10.110.58:9000/api",Ue=He.a.create({withCredentials:!0,baseURL:Te});Ue.interceptors.request.use((function(e){return e.headers.Authorization="Bearer ".concat(localStorage.getItem("token")),e})),Ue.interceptors.response.use((function(e){return e}),function(){var e=Object(ne.a)(te.a.mark((function e(t){var n,r;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.config,401!==t.response.status||!t.config||t.config._isRetry){e.next=14;break}return n._isRetry=!0,e.prev=3,e.next=6,He.a.get("".concat(Te,"/refresh"),{withCredentials:!0});case 6:return r=e.sent,localStorage.setItem("token",r.data.accessToken),e.abrupt("return",Ue.request(n));case 11:e.prev=11,e.t0=e.catch(3),console.log("\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u043e\u0431\u043b\u043e\u043c\u0438\u043b\u0430\u0441\u044c. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u043d\u043e\u0432\u0430");case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}());var $e=Ue,Ee=function(){function e(){Object(_e.a)(this,e)}return Object(Me.a)(e,null,[{key:"login",value:function(){var e=Object(ne.a)(te.a.mark((function e(t,n){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$e.post("/login",{email:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(ne.a)(te.a.mark((function e(){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$e.post("/logout"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Be=function(){function e(){Object(_e.a)(this,e),this.user={},this.isAuth=!1,this.isLoading=!1,this.pageParams=[{url:"/",icon:Object(p.jsx)(me.a,{}),title:"\u041e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f"},{url:"/recently",icon:Object(p.jsx)(xe.a,{}),title:"\u041d\u043e\u0432\u044b\u0435 \u0437\u0430\u043a\u0430\u0437\u044b"},{url:"/reclamation",icon:Object(p.jsx)(ge.a,{}),title:"\u0420\u0435\u043a\u043b\u0430\u043c\u0430\u0446\u0438\u044f"},{url:"/attendance",icon:Object(p.jsx)(fe.a,{}),title:"\u0420\u0430\u0431\u043e\u0447\u0435\u0435 \u0432\u0440\u0435\u043c\u044f"}],this.preloader=Object(p.jsx)(l.a,{display:"flex",alignItems:"center",justifyContent:"center",height:"75vh",children:Object(p.jsx)(Fe.a,{})}),Object(Le.d)(this)}return Object(Me.a)(e,[{key:"setAuth",value:function(e){this.isAuth=e}},{key:"setUser",value:function(e){this.user=e}},{key:"setLoading",value:function(e){this.isLoading=e}},{key:"login",value:function(){var e=Object(ne.a)(te.a.mark((function e(t,n){var r,a,c;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ee.login(t,n);case 3:r=e.sent,localStorage.setItem("token",r.data.accessToken),this.setUser(r.data.user),this.setAuth(!0),window.location.href="/",e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(null===(a=e.t0.response)||void 0===a||null===(c=a.data)||void 0===c?void 0:c.message);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(ne.a)(te.a.mark((function e(){var t,n;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ee.logout();case 3:localStorage.removeItem("token"),this.setAuth(!1),this.setUser({}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(null===(t=e.t0.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"checkAuth",value:function(){var e=Object(ne.a)(te.a.mark((function e(){var t,n,r;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setLoading(!0),e.prev=1,e.next=4,He.a.get("".concat(Te,"/refresh"),{withCredentials:!0});case 4:return t=e.sent,localStorage.setItem("token",t.data.accessToken),this.setUser(t.data.user),this.setAuth(!0),e.abrupt("return",{isLoaded:!0,isAuth:this.isAuth});case 11:return e.prev=11,e.t0=e.catch(1),console.log(null===(n=e.t0.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message),e.abrupt("return",{isLoaded:!0,isAuth:this.isAuth});case 15:return e.prev=15,this.setLoading(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,11,15,18]])})));return function(){return e.apply(this,arguments)}}()},{key:"uploadFile",value:function(){var e=Object(ne.a)(te.a.mark((function e(t){var n;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,He.a.post("http://localhost:9000/api/s3-upload",t,{headers:{"Content-Type":"multipart/form-data"}});case 2:n=e.sent,console.log(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPageParams",value:function(e){return this.pageParams.find((function(t){return t.url===e}))}}]),e}(),Re=(n(257),new Be),Ye=Object(c.createContext)({store:Re}),Qe=document.getElementById("root");i.a.render(Object(p.jsx)(x.ApolloProvider,{client:new x.ApolloClient({link:new a.a({uri:"wss://45.10.110.58:8080/v1/graphql",options:{reconnect:!0,connectionParams:{headers:{"x-hasura-admin-secret":"44UL1UoEAr"}}}}),cache:new x.InMemoryCache}),children:Object(p.jsx)(y.a,{children:Object(p.jsx)(Se,{sessionData:Qe.dataset.session,children:Object(p.jsx)(Ye.Provider,{value:Re})})})}),Qe),Pe()},99:function(e,t,n){}},[[267,1,2]]]);
//# sourceMappingURL=main.98a398e6.chunk.js.map