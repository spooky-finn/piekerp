(this.webpackJsonppiek=this.webpackJsonppiek||[]).push([[0],{106:function(e,t,n){e.exports={tableWrapper:"attendance_tableWrapper__3XX7V",attendanceTable:"attendance_attendanceTable__2Ngds",interval:"attendance_interval__2RRqG","status-101":"attendance_status-101__15BJ5",tableSearchInput:"attendance_tableSearchInput__3Agga",tableFooter:"attendance_tableFooter__3ztcm"}},126:function(e,t,n){e.exports={tableSearchInput:"search_tableSearchInput__mHzTe",filter:"search_filter__1BI6Q",filterPlaceholder:"search_filterPlaceholder__2NcNB",filterIndicator:"search_filterIndicator__Rfc0e",circle:"search_circle__2PIMx",pulsate:"search_pulsate__pgEiY"}},127:function(e,t,n){e.exports={heading:"recently_heading__2gRdv",recentlyTable:"recently_recentlyTable__3NJpR"}},278:function(e,t,n){},314:function(e,t,n){e.exports={preOrdersTableWrapper:"preorders_preOrdersTableWrapper__2ELAZ"}},350:function(e,t){},352:function(e,t){},367:function(e,t){},369:function(e,t){},397:function(e,t){},399:function(e,t){},400:function(e,t){},405:function(e,t){},407:function(e,t){},413:function(e,t){},415:function(e,t){},434:function(e,t){},446:function(e,t){},449:function(e,t){},474:function(e,t,n){},483:function(e,t,n){},484:function(e,t,n){},485:function(e,t,n){},552:function(e,t,n){},553:function(e,t,n){},571:function(e,t,n){},572:function(e,t,n){},582:function(e,t,n){"use strict";n.r(t),n.d(t,"Context",(function(){return dn}));var a=n(9),r=n(6),c=n(20),s=n.n(c),i=n(37),o=n(0),l=n(30),u=n.n(l),d=n(310),j=n.n(d),b=n(324),p=n(35),O=n(13),h=n(1),m=["component"],f=function(e){var t=e.component,n=Object(r.a)(e,m),c=Object(o.useState)(void 0),l=Object(O.a)(c,2),u=l[0],d=l[1],j=Object(o.useState)(void 0),b=Object(O.a)(j,2),f=b[0],v=b[1],x=Object(o.useContext)(dn).store;function g(){return(g=Object(i.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.checkAuth();case 2:t=e.sent,v(t.isAuth),d(t.isLoaded);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(o.useEffect)((function(){x.inMemoryToken?(v(!0),d(!0)):function(){g.apply(this,arguments)}()}),[]),Object(h.jsx)(p.b,Object(a.a)(Object(a.a)({},n),{},{render:function(e){if(u)return f?Object(h.jsx)(t,Object(a.a)({},e)):Object(h.jsx)(p.a,{to:"/login"})}}))},v=n(656),x=n(624),g=(n(474),n(278),function(e){var t=Object(o.useState)(""),n=Object(O.a)(t,2),a=n[0],r=n[1],c=Object(o.useState)(""),s=Object(O.a)(c,2),i=s[0],l=s[1],u=Object(o.useContext)(dn).store,d=Object(p.g)();return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{className:"loginCard",children:[Object(h.jsx)(v.a,{className:"loginInput",label:"Email",onChange:function(e){return r(e.target.value)}}),Object(h.jsx)(v.a,{label:"Password",type:"password",className:"loginInput",onChange:function(e){return l(e.target.value)}}),Object(h.jsx)(x.a,{className:"Button",variant:"outlined",width:"300px",onClick:function(e){u.login(a,i).then((function(){return d.push("/")}))},children:"\u0412\u043e\u0439\u0442\u0438"})]})})}),y=n(12);function I(e,t){switch(t.type){case"orders":case"preOrders":case"selectedTab":case"searchKeyword":case"managerFilter":return Object(a.a)(Object(a.a)({},e),{},Object(y.a)({},t.type,t.payload));case"resetFilters":return Object(a.a)(Object(a.a)({},e),{},{searchKeyword:"",managerFilter:0})}}var D,_,C=n(11),N=n(27),k=n(33),w=n(26),M=Object(w.a)(D||(D=Object(k.a)(["\nsubscription{\n    erp_Orders(where: {OrderStatusID: {_neq: 3} }) {\n      OrderID\n      Entity\n      InvoiceNumber\n      City\n      ShippingDate\n      PaidAmount\n      TotalAmount\n      AwaitingDispatch\n      CreatingDate\n      ManagerID\n      OrderStatus {\n        Name\n        ID\n      }\n      OrderItems {\n        Quantity\n        OrderItemID\n        Name\n        OrderID\n      } \n      User {\n        FirstName\n      }\n\n    }  \n  }\n"]))),F=Object(w.a)(_||(_=Object(k.a)(["\nquery getUsers {\n  erp_Users{\n    FirstName\n    LastName\n    UserID\n  }\n}\n"]))),S=n(651),T=n(654),P=n(629),L=n(65),A=n(43),$=n(78),U=n.n($),R=n(75),q=n.n(R),H=[{Header:"",id:"index",accessor:function(e,t){return t+1}},{Header:"\u041d\u0430\u0438\u043c.",id:"orderItems",accessor:function(e){return 0==e.OrderItems.length?Object(h.jsx)(A.b,{to:"/orders/".concat(e.OrderID),children:Object(h.jsx)("div",{children:"\u043f\u0443\u0441\u0442\u043e\u0442\u0430..."})}):Object(h.jsx)(A.b,{to:"/orders/".concat(e.OrderID),children:e.OrderItems.map((function(e){return Object(h.jsx)("div",{children:Object(h.jsx)("span",{children:e.Name})},e.OrderItemID)}))})}},{Header:"\u041a\u043e\u043b-\u0432\u043e",accessor:function(e){return e.OrderItems.map((function(e){return Object(h.jsx)("div",{children:Object(h.jsx)("div",{children:e.Quantity})},e.OrderItemID)}))}},{Header:"\u041e\u0442\u0433\u0440\u0443\u0437\u043a\u0430",accessor:function(e){return Object(h.jsxs)(h.Fragment,{children:[" ",U()(e.ShippingDate).format("DD.MM.YY")," "]})}},{Header:"\u0421\u0447\u0435\u0442- \u043e\u043f\u043b\u0430\u0442\u0430",accessor:function(e){return e.InvoiceNumber+(t=e.TotalAmount,n=e.PaidAmount,t&&n?" - "+(n/t*100).toFixed(0)+"%":"");var t,n}},{Header:"\u041a\u043e\u043c\u043f\u0430\u043d\u0438\u044f",accessor:"Entity"},{Header:"\u0413\u043e\u0440.",accessor:"City"},{Header:"\u041c\u0434\u0436.",accessor:function(e){var t;return Object(h.jsxs)(h.Fragment,{children:[" ",(null===(t=e.User)||void 0===t?void 0:t.FirstName[0])||""," "]})}}],E=n(167);function Y(e){var t=e.columns,n=e.data,r=e.className,c=Object(E.useTable)({columns:t,data:n}),s=c.getTableProps,i=c.getTableBodyProps,o=c.headerGroups,l=c.rows,u=c.prepareRow;return 0==n.length?null:Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("table",Object(a.a)(Object(a.a)({className:"".concat(q.a.tableMain," ").concat(r)},s()),{},{children:[Object(h.jsx)("thead",{children:o.map((function(e,t){return Object(h.jsx)("tr",Object(a.a)(Object(a.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e,t){return Object(h.jsx)("th",Object(a.a)(Object(a.a)({},e.getHeaderProps()),{},{children:e.render("Header")}))}))}),t)}))}),Object(h.jsx)("tbody",Object(a.a)(Object(a.a)({},i()),{},{children:l.map((function(e,t){u(e);var n=e.original.AwaitingDispatch;return Object(h.jsx)("tr",Object(a.a)(Object(a.a)({className:n?q.a.awaitingDispatch:""},e.getRowProps()),{},{children:e.cells.map((function(e,t){return Object(h.jsx)("td",Object(a.a)(Object(a.a)({},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]}))})}var z=n(626),B=n(126),K=n.n(B),W=n(621),V=n(652),Q=n(663),G=n(625),J=Object(G.a)((function(e){return{formControl:{minWidth:70,borderRadius:"var(--br10)",border:"1px solid var(--border)",padding:"0 10px"},select:{fontSize:".8rem",color:"var(--highContrast)"},menuItem:Object(y.a)({fontSize:".8rem",color:"var(--lowContrast)"},"fontSize",".8rem")}})),X=function(e){var t=e.state,n=e.dispatch,a=e.users,r=J();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:K.a.tableSearchInput,children:[Object(h.jsx)(z.a,{}),Object(h.jsx)("input",{type:"text",placeholder:"\u041d\u043e\u043c\u0435\u0440 \u0441\u0447\u0435\u0442\u0430 \u0438\u043b\u0438 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f",onChange:function(e){n({type:"searchKeyword",payload:e.target.value})},autoFocus:!0,defaultValue:t.searchKeyword}),a&&Object(h.jsxs)("div",{className:K.a.filter,children:[Object(h.jsx)("span",{className:K.a.filterPlaceholder,children:"manager"}),Object(h.jsx)(W.a,{className:r.formControl,children:Object(h.jsxs)(V.a,{name:"managerFilter",value:t.managerFilter,onChange:function(e){n({type:"managerFilter",payload:e.target.value})},className:r.select,disableUnderline:!0,children:[Object(h.jsx)(Q.a,{value:0,className:r.menuItem,children:"\u0412\u0441\u0435"}),a.map((function(e){return Object(h.jsxs)(Q.a,{className:r.menuItem,value:e.UserID,children:[" ","".concat(e.FirstName," ").concat(e.LastName)," "]},e.UserID)}))]})})]})]}),function(){if(0!=t.managerFilter)return Object(h.jsxs)("div",{className:K.a.filterIndicator,children:[Object(h.jsx)("div",{className:K.a.circle}),Object(h.jsx)("p",{children:"\u0412\u044b\u0434\u0430\u0447\u0430 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u043c"})]})}(t.managerFilter)]})};function Z(e){for(var t=!1,n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];return a.map((function(n){n&&n.toLowerCase().includes(e.toLowerCase())&&(t=!0)})),!!t}var ee,te,ne,ae,re,ce,se,ie=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=[];if(a=""!==t?e.filter((function(e){return Z(t,e.InvoiceNumber,e.Entity)})):e,0!=n){var r=[];return a.map((function(e){e.ManagerID==n&&r.push(e)})),r}return a},oe=Object(w.b)(ee||(ee=Object(k.a)(["\n    mutation MyMutation($OrderID: Int!){\n    update_erp_Orders_by_pk(pk_columns: {OrderID: $OrderID}, _set: {OrderStatusID: 2}) {\n        OrderID\n    }\n  }\n\n"]))),le=n(627),ue=n(314),de=n.n(ue),je=function(e){var t=e.state,n=e.dispatch,a=t.preOrders,r=Object(N.useMutation)(oe),c=Object(O.a)(r,1)[0],s=Object(L.a)(H),i=ie(a,t.searchKeyword);return s.push({Header:" ",accessor:function(e){return Object(h.jsx)("div",{onClick:function(){return function(e){c({variables:{OrderID:e.OrderID}})}(e)},className:"square-button",children:Object(h.jsx)(le.a,{})})}}),Object(h.jsxs)("div",{className:"".concat(q.a.tableWrapper," ").concat(de.a.preOrdersTableWrapper),children:[Object(h.jsx)(X,{state:t,dispatch:n}),i&&Object(h.jsx)(Y,{columns:s,data:i})]})},be=function(e){var t=e.users,n=e.state,a=e.dispatch,r=n.orders,c=Object(o.useMemo)((function(){return H}),[]),s=ie(r,n.searchKeyword,n.managerFilter);return Object(h.jsxs)("div",{className:q.a.tableWrapper,children:[Object(h.jsx)(X,{state:n,dispatch:a,users:t}),s&&Object(h.jsx)(Y,{columns:c,data:s})]})},pe=n(316),Oe=n(127),he=n.n(Oe),me=function(e){var t=e.state,n=e.dispatch,a=t.orders;a.sort((function(e,t){return t.CreatingDate>e.CreatingDate?1:-1}));var r=function(e){var t,n=[{name:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",date:U()().subtract(0,"day").format("YYYY-MM-DD"),objs:[]},{name:"\u0412\u0447\u0435\u0440\u0430",date:U()().subtract(1,"day").format("YYYY-MM-DD"),objs:[]},{name:"",objs:[]}],a=Object(pe.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value,c=r.CreatingDate.split("T")[0];c==n[0].date?n[0].objs.push(r):c==n[1].date?n[1].objs.push(r):n[2].objs.push(r)}}catch(s){a.e(s)}finally{a.f()}return n}(a),c=Object(o.useMemo)((function(){return H}),[]),s=ie(r[2].objs,t.searchKeyword);return Object(h.jsxs)("div",{children:[r[0].objs.length?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{className:he.a.heading,children:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f"}),Object(h.jsx)(Y,{columns:c,data:r[0].objs,className:he.a.recentlyTable})]}):null,r[1].objs.length?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{className:he.a.heading,children:"\u0412\u0447\u0435\u0440\u0430"}),Object(h.jsx)(Y,{columns:c,data:r[1].objs,className:he.a.recentlyTable})]}):null,Object(h.jsx)("div",{className:he.a.heading,children:"\u041e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435"}),Object(h.jsxs)("div",{className:q.a.tableWrapper,children:[Object(h.jsx)(X,{state:t,dispatch:n,incomingOrders:a}),Object(h.jsx)(Y,{columns:c,data:s})]})]})},fe=Object(w.b)(te||(te=Object(k.a)(["\nmutation MyMutation($managerID: Int!, $orderStatusID: Int!, $isReclamation: Boolean!) {\n  insert_erp_Orders(objects: {ManagerID: $managerID, OrderStatusID:  $orderStatusID, IsReclamation: $isReclamation}) {\n    returning {\n      OrderID\n    }\n  }\n}\n"]))),ve=n(628),xe=function(e){var t=Object(N.useMutation)(fe,{variables:{managerID:e.userID,orderStatusID:1,isReclamation:!1}}),n=Object(O.a)(t,1)[0],a=function(){n().then((function(t){e.history.push("/orders/".concat(t.data.insert_erp_Orders.returning[0].OrderID,"?edit=true"))}))},r=function(){e.setEditState(!e.editState)};return Object(h.jsxs)("div",{className:"action-block",children:[function(){if(e.createOrder)return Object(h.jsx)("div",{"data-for":"global","data-tip":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",onClick:a,className:"action-icon",children:Object(h.jsx)(le.a,{})})}(),function(){if(2==e.accessLevel){return Object(h.jsx)("div",{"data-for":"global","data-tip":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",className:e.editState?"action-icon active":"action-icon",onClick:r,children:Object(h.jsx)(ve.a,{})})}}()]})},ge=["children","value","index"],ye=function(e){var t=Object(o.useContext)(dn).store,n=Object(o.useReducer)(I,function(e,t,n){return{orders:t||[],preOrders:n||[],selectedTab:e,searchKeyword:"",managerFilter:0}}(t.priorityTab,t.cachedOrders,t.cachedPreOrders)),c=Object(O.a)(n,2),s=c[0],i=c[1],l=s.selectedTab,u=Object(p.g)();Object(N.useSubscription)(M,{onSubscriptionData:function(e){var n=[],a=[];e.subscriptionData.data.erp_Orders.forEach((function(e){1==e.OrderStatus.ID?a.push(e):2==e.OrderStatus.ID&&n.push(e)})),t.setCachedOrders(n),t.setCachedPreOrders(a),i({type:"preOrders",payload:a}),i({type:"orders",payload:n})},fetchPolicy:"cache-first",nextFetchPolicy:"cache-first"});var d=Object(N.useQuery)(F).data,j=void 0===d?[]:d;function b(e){var t=e.children,n=e.value,c=e.index,s=Object(r.a)(e,ge);return Object(h.jsx)("div",Object(a.a)(Object(a.a)({role:"tabpanel",hidden:n!==c,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c)},s),{},{children:n===c&&Object(h.jsx)(S.a,{children:t})}))}function m(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}var f="45px",v=Object(C.a)({root:{borderLeft:"1px solid var(--border)",borderRight:"1px solid var(--border)",background:"var(--L2)",minHeight:f,height:f},indicator:{borderTopLeftRadius:"20px",borderTopRightRadius:"20px",backgroundColor:"var(--accent)"}})(T.a),x=Object(C.a)((function(e){return{root:{minWidth:"10%",fontSize:".7rem",letterSpacing:"1px",color:"var(--highContrast)",padding:0,opacity:.5,minHeight:f,height:f,transition:"opacity .3s ease","&:hover":{opacity:1},"&$selected":{color:"var(--accent)",backgroundColor:"var(--accentLight)"}},selected:{}}}))((function(e){return Object(h.jsx)(P.a,Object(a.a)({disableRipple:!0},e))}));return Object(h.jsxs)("div",{children:[Object(h.jsxs)(v,{value:l,onChange:function(e,n){i({type:"selectedTab",payload:n}),i({type:"resetFilters"}),t.setPriorutyTab(n)},"aria-label":"simple tabs example",children:[Object(h.jsx)(x,Object(a.a)({label:"\u041f\u0440\u0435\u0434\u0437\u0430\u043a\u0430\u0437\u044b"},m(0))),Object(h.jsx)(x,Object(a.a)({label:"\u041e\u0447\u0435\u0440\u0435\u0434\u043e\u0441\u0442\u044c"},m(1))),Object(h.jsx)(x,Object(a.a)({label:"\u041d\u0435\u0434\u0430\u0432\u043d\u0438\u0435"},m(2))),Object(h.jsx)(xe,{createOrder:1,userID:t.user.UserID,history:u})]}),Object(h.jsx)(b,{value:l,index:0,children:Object(h.jsx)(je,{state:s,dispatch:i})}),Object(h.jsx)(b,{value:l,index:1,children:Object(h.jsx)(be,{state:s,dispatch:i,users:j.erp_Users})}),Object(h.jsx)(b,{value:l,index:2,children:Object(h.jsx)(me,{state:s,dispatch:i})})]})},Ie=n(326),De=Object(w.a)(ne||(ne=Object(k.a)(["\nquery MyQuery($OrderID: Int!) {\n  erp_Orders(\n    where: {OrderID: {_eq: $OrderID}}\n    ){\n    City\n    CreatingDate\n    Comment\n    Entity\n    InvoiceNumber\n    ManagerID\n    OrderID\n    OrderNumber\n    OrderStatusID\n    PaidAmount\n    ShipmentComment\n    ShippingDate\n    TotalAmount\n    IsReclamation\n    AwaitingDispatch\n    User {\n      FirstName\n      LastName\n      UserID\n    }\n    OrderItems {\n      Fitter\n      Name\n      FullName\n      OrderItemID\n      OrderID\n      Quantity\n      SerialNumber\n    }\n    CheckListUnits {\n      IsComplited\n      OrderID\n      Point\n      CheckListUnitID\n    }\n    Docs {\n      Key\n      FileName\n    }\n  }\n}\n"]))),_e=Object(w.b)(ae||(ae=Object(k.a)(["\nmutation MyMutation($objects: [erp_Docs_insert_input!]!) {\n  insert_erp_Docs(objects: $objects) {\n    returning {\n      ID\n    }\n  }\n}\n"]))),Ce=Object(w.b)(re||(re=Object(k.a)(["\n    mutation MyMutation($key: String!) {\n    delete_erp_Docs(where: {Key: {_eq: $key} }) {\n        returning {\n        Key\n        }\n    }\n    }\n"]))),Ne=Object(w.b)(ce||(ce=Object(k.a)(["\n mutation MyMutation($name: String!, $orderID: Int!, $quantity: Int!, $fullName: String!) {\n  insert_erp_OrderItems_one(object: {\n    OrderID: $orderID,\n    Name: $name,\n    FullName: $fullName,\n    Quantity: $quantity,\n    }) {\n    OrderItemID\n    OrderID\n  }\n}\n"]))),ke=Object(w.b)(se||(se=Object(k.a)(["\nmutation MyMutation($orderItemID: Int!) {\n  delete_erp_OrderItems_by_pk(OrderItemID: $orderItemID) {\n\t\tOrderItemID\n  }\n}\n"]))),we=n(630),Me=n(650),Fe=n(658),Se=n(72),Te=n.n(Se),Pe={name:"",fullName:"",quantity:""};function Le(e,t){switch(t.type){case"name":case"fullName":case"quantity":return Object(a.a)(Object(a.a)({},e),{},Object(y.a)({},t.type,t.payload));case"reset":return Pe;case"editItem":return{name:t.payload[0],fullName:t.payload[1],quantity:t.payload[2]}}}var Ae,$e,Ue=function(e){var t=e.data,n=e.editState,a=e.refetch,r=e.orderID,c=Object(N.useMutation)(ke),s=Object(O.a)(c,1)[0],i=Object(N.useMutation)(Ne),l=Object(O.a)(i,1)[0],u=Object(o.useReducer)(Le,Pe),d=Object(O.a)(u,2),j=d[0],b=d[1],p=function(e){s({variables:{orderItemID:e}}),a()};Object(o.useEffect)((function(){n||""===j.name||""===j.quantity||m()}),[n]);var m=function(){if(""==j.quantity||""==j.name)return null;l({variables:{orderID:r,name:j.name,quantity:parseInt(j.quantity),fullName:j.fullName}}).then((function(){b({type:"reset"}),a()}))};return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)(Fe.a,{children:[t.map((function(e){return Object(h.jsx)(Me.a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:Object(h.jsxs)("div",{className:Te.a.Unit,children:[Object(h.jsxs)("div",{className:Te.a.firstRow,children:[Object(h.jsxs)("div",{className:Te.a.name,children:[" ",e.Name," "]}),Object(h.jsxs)("span",{className:Te.a.quantity,children:[" ",e.Quantity]})]}),Object(h.jsxs)("div",{className:Te.a.fullName,children:[" ",e.FullName]}),n&&Object(h.jsxs)("div",{className:Te.a.orderItemActions,children:[Object(h.jsx)("a",{onClick:function(n){return function(e,n){var a=t.find((function(e){return e.OrderItemID==n}));b({type:"editItem",payload:[a.Name,a.FullName,a.Quantity]}),console.log(e),p(n)}(n,e.OrderItemID)},children:"   \u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"}),Object(h.jsx)("a",{onClick:function(){return p(e.OrderItemID)},children:" \u0423\u0434\u0430\u043b\u0438\u0442\u044c "})]})]},e.OrderItemID)},e.OrderItemID)})),n&&Object(h.jsx)("div",{className:Te.a.addOrderItem,children:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(v.a,{size:"small",label:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",autoComplete:"off",value:j.name,onChange:function(e){return b({type:"name",payload:e.target.value})}}),Object(h.jsx)(v.a,{size:"small",label:"\u041a\u043e\u043b-\u0432\u043e",type:"number",autoComplete:"off",className:Te.a.quantityInput,value:j.quantity,onChange:function(e){return b({type:"quantity",payload:e.target.value})}}),Object(h.jsx)(v.a,{label:"\u041f\u043e\u043b\u043d\u043e\u0435 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",multiline:!0,autoComplete:"off",size:"small",className:Te.a.fullNameInput,value:j.fullName,onChange:function(e){return b({type:"fullName",payload:e.target.value})}}),Object(h.jsx)(Me.a.button,{whileHover:{scale:1.1},whileTap:{scale:.95},className:"square-button ".concat(Te.a.pushOrderItemButton),onClick:m,children:Object(h.jsx)(we.a,{})})]})})]})})},Re=n(632),qe=(n(483),n(655)),He=n(633),Ee=Object(w.b)(Ae||(Ae=Object(k.a)(["\n mutation MyMutation($orderID: Int!, $fields: erp_Orders_set_input) {\n  update_erp_Orders_by_pk(pk_columns: {OrderID: $orderID}, _set: $fields) {\n\t\tOrderID\n  }\n}\n"]))),Ye=Object(w.b)($e||($e=Object(k.a)(["\n mutation MyMutation($orderID: Int!, $awaitingDispatch: Boolean!) {\n  update_erp_Orders_by_pk(\n    pk_columns: {OrderID: $orderID},\n   _set: { AwaitingDispatch: $awaitingDispatch }\n  ) {\n\t\tOrderID\n    AwaitingDispatch\n  }\n}\n"]))),ze=Object(G.a)({formControlLabel:{width:"100%",height:35,"& > span":{fontSize:".8rem",color:"var(--lowContrast)"}}}),Be=Object(C.a)({root:{margin:"0 10px",color:"var(--lowContrast)",opacity:.2,transition:"none !important","&$checked":{color:"var(--lowContrast)",opacity:1}},checked:{}})((function(e){return Object(h.jsx)(qe.a,Object(a.a)({color:"default",size:"small"},e))})),Ke=function(e){var t,n,a,r,c=e.data,s=e.orderID,i=Object(N.useMutation)(Ye),o=Object(O.a)(i,1)[0],l=ze();return Object(h.jsxs)("div",{className:"Meta",children:[Object(h.jsxs)("div",{className:"SignificantInfo",children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("pre",{children:"\u041f\u043b\u0430\u043d. \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0430"}),U()(c.ShippingDate).format("DD.MM.YY")]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("pre",{children:"\u0421\u0447\u0435\u0442 / \u043e\u043f\u043b\u0430\u0442\u0430"}),"\u2116 "+c.InvoiceNumber+(a=c.TotalAmount,r=c.PaidAmount,a&&r?" - "+(r/a*100).toFixed(0)+"%":""),Object(h.jsx)("span",{className:"PaymentHistory",children:Object(h.jsx)(Re.a,{})})]})]}),Object(h.jsxs)("div",{className:"MetaWrapper",children:[Object(h.jsxs)("div",{className:"Left",children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("pre",{children:"\u041d\u043e\u043c\u0435\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),c.OrderNumber]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("pre",{children:"\u0421\u043e\u0437\u0434\u0430\u043d"}),c.CreatingDate.split("T")[0]]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("pre",{children:"\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440"}),null===(t=c.User)||void 0===t?void 0:t.FirstName," ",(null===(n=c.User)||void 0===n?void 0:n.LastName)||"undefined"]})]}),Object(h.jsxs)("div",{className:"Right",children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("pre",{children:"\u042e\u0440 \u041b\u0438\u0446\u043e"}),c.Entity]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("pre",{children:"\u0413\u043e\u0440"}),c.City]})]})]}),Object(h.jsxs)("div",{className:"OrderComment",children:[Object(h.jsx)("pre",{children:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"}),c.Comment]}),Object(h.jsx)("div",{className:"actions",children:Object(h.jsx)(He.a,{className:l.formControlLabel,control:Object(h.jsx)(Be,{checked:c.AwaitingDispatch,onChange:function(){o({variables:{orderID:s,awaitingDispatch:!c.AwaitingDispatch},optimisticResponse:{erp_Orders:{__typename:"erp_Orders",OrderID:s,AwaitingDispatch:!c.AwaitingDispatch}}})}}),label:"\u0421\u043e\u0431\u0440\u0430\u043d \u0438 \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0438"})})]})},We=n(653),Ve=(n(484),n(201)),Qe=["inputRef","onChange"],Ge=["inputRef","onChange"],Je={};function Xe(e){var t=e.inputRef,n=e.onChange,c=Object(r.a)(e,Qe);return Object(h.jsx)(Ve.a,Object(a.a)(Object(a.a)({},c),{},{getInputRef:t,onValueChange:function(t){n({target:{name:e.name,value:t.value}})},format:"##.##.##"}))}function Ze(e){var t=e.inputRef,n=e.onChange,c=Object(r.a)(e,Ge);return Object(h.jsx)(Ve.a,Object(a.a)(Object(a.a)({},c),{},{getInputRef:t,onValueChange:function(t){n({target:{name:e.name,value:t.value}})},prefix:"\u20bd ",thousandSeparator:!0}))}var et,tt=function(e){var t=e.data,n=e.orderID,r=e.refetch,c=e.users,s=function(e){return Je[e.target.name]=e.target.value},i=Object(N.useMutation)(Ee),l=Object(O.a)(i,1)[0];return Object(o.useEffect)((function(){return Je={},function(){console.log("doing mutation for order",n,Je),l({variables:{orderID:n,fields:Je}}),r()}}),[]),Object(h.jsxs)("form",{className:"Meta EditableInfo",children:[Object(h.jsx)(v.a,{label:"\u041f\u043b\u0430\u043d. \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0430",name:"ShippingDate",defaultValue:U()(t.ShippingDate).format("DD.MM.YY"),onChange:function(e){e.target.value=U()(e.target.value,"DD-MM-YY").format("YYYY-MM-DD"),s(e)},placeholder:"dd.mm.yy",autoComplete:"off",InputProps:{inputComponent:Xe}}),Object(h.jsx)(v.a,{label:"\u041d\u043e\u043c\u0435\u0440 \u0441\u0447\u0435\u0442\u0430",type:"number",name:"InvoiceNumber",defaultValue:t.InvoiceNumber,onChange:s}),Object(h.jsx)(v.a,{label:"\u041d\u043e\u043c\u0435\u0440 \u0437\u0430\u043a\u0430\u0437\u0430",type:"number",name:"OrderNumber",defaultValue:t.OrderNumber,onChange:s}),Object(h.jsx)(We.a,{id:"combo-box-demo",options:c,getOptionLabel:function(e){return"".concat(e.FirstName," ").concat(e.LastName)},renderInput:function(e){return Object(h.jsx)(v.a,Object(a.a)(Object(a.a)({},e),{},{label:"\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440"}))},defaultValue:function(){return function(e,t){if(!e)return null;var n=e.indexOf(e.find((function(e){return e.UserID==t})));return e[n]}(c,t.ManagerID)},onChange:function(e,t){Je.ManagerID=(null===t||void 0===t?void 0:t.UserID)||null}}),Object(h.jsx)(v.a,{label:"\u042e\u0440 \u043b\u0438\u0446\u043e",autoComplete:"off",name:"Entity",defaultValue:t.Entity,onChange:s}),Object(h.jsx)(v.a,{label:"\u0413\u043e\u0440\u043e\u0434",autoComplete:"off",name:"City",defaultValue:t.City,onChange:s}),Object(h.jsx)(v.a,{label:"\u0421\u0443\u043c\u043c\u0430 \u0437\u0430\u043a\u0430\u0437\u0430",name:"TotalAmount",defaultValue:t.TotalAmount,autoComplete:"off",onChange:s,InputProps:{inputComponent:Ze}}),Object(h.jsx)(v.a,{label:"\u041e\u043f\u043b\u0430\u0447\u0435\u043d\u043e",name:"PaidAmount",defaultValue:t.PaidAmount,autoComplete:"off",onChange:s,InputProps:{inputComponent:Ze}}),Object(h.jsx)(v.a,{label:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",multiline:!0,autoComplete:"off",name:"Comment",defaultValue:t.Comment,onChange:s})]})},nt=Object(w.b)(et||(et=Object(k.a)(["\nmutation MyMutation($CheckListUnitID: Int!, $IsCompluted: Boolean!) {\n  update_erp_CheckListUnits_by_pk(pk_columns: {CheckListUnitID: $CheckListUnitID}, _set: {IsComplited: $IsCompluted}) {\n    CheckListUnitID\n    IsComplited\n    Point\n  }\n}\n"]))),at=function(e){var t=e.data,n=Object(N.useMutation)(nt),a=Object(O.a)(n,2),r=a[0],c=(a[1].loading,JSON.parse(JSON.stringify(t)));c.sort((function(e,t){return t.Point<e.Point?1:-1}));var s=c.map((function(e){return Object(h.jsx)("div",{className:e.IsComplited?"CheckListUnit complited":"CheckListUnit",onClick:function(t){return function(e,t){e.target.classList.toggle("complited"),r({variables:{CheckListUnitID:t.CheckListUnitID,IsCompluted:!t.IsComplited}})}(t,e)},children:e.Point},e.CheckListUnitID)}));return Object(h.jsxs)("div",{className:"CheckList",children:[Object(h.jsx)("div",{className:"sectionHeading",children:"\u0427\u0435\u043a\u043b\u0438\u0441\u0442"}),s]})},rt=n(659),ct=n(634),st=n(635),it=n(636),ot=n(637),lt=function(e){var t=e.data,n=e.onUpload,a=e.editState,r=e.refetch,c=Object(o.useContext)(dn).store,l=Object(o.useState)(!1),u=Object(O.a)(l,2),d=u[0],j=u[1],b=Object(o.useState)(),p=Object(O.a)(b,2),m=p[0],f=p[1],g=Object(N.useMutation)(Ce),y=Object(O.a)(g,1)[0],I=Object(o.useRef)(),D=function(){return j(!1)},_=function(){var e=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D(),"\u0414\u0430"!=I.current.value){e.next=5;break}return e.next=4,c.deleteFile(m.Key,y);case 4:r();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=t.map((function(e){return a?Object(h.jsx)("div",{children:Object(h.jsxs)("div",{onClick:function(){return function(e){f(e),j(!0)}(e)},className:"file-name delete-file",children:[" ",e.FileName," "]})},e.Key):Object(h.jsxs)("a",{href:"".concat("https://factory.piek.ru/api","/s3/get/").concat(e.Key),target:"_blank",className:"file-name",children:[" ",e.FileName," "]},e.Key)}));return Object(h.jsxs)("div",{className:"Docs",children:[Object(h.jsx)("div",{className:"sectionHeading",children:"\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f"}),Object(h.jsxs)("div",{className:"filesContainer",children:[C,function(){if(0==n.length)return null;var e=n.map((function(e){return Object(h.jsx)("div",{children:e.path},e.path)}));return Object(h.jsx)("div",{className:"onUploadIcon",children:e})}()]}),Object(h.jsx)("div",{children:Object(h.jsxs)(rt.a,{open:d,onClose:D,"aria-labelledby":"form-dialog-title",maxWidth:"xs",children:[Object(h.jsx)(ct.a,{id:"customized-dialog-title",onClose:D,children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435?"}),Object(h.jsxs)(st.a,{dividers:!0,children:[Object(h.jsxs)(it.a,{gutterBottom:!0,children:["\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c ",Object(h.jsx)("span",{children:null===m||void 0===m?void 0:m.FileName})," ? ",Object(h.jsx)("br",{}),'\u042d\u0442\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043d\u0435\u043e\u0431\u0440\u0430\u0442\u0438\u043c\u043e. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 "\u0414\u0430" \u0434\u043b\u044f \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f.']}),Object(h.jsx)(v.a,{autoFocus:!0,size:"small",variant:"outlined",margin:"dense",fullWidth:!0,autoComplete:"off",inputRef:I})]}),Object(h.jsx)(ot.a,{children:Object(h.jsx)(x.a,{onClick:_,className:"dialog-danger-btn",children:"\u042f \u043f\u043e\u043d\u0438\u043c\u0430\u044e \u043f\u043e\u0441\u043b\u0435\u0434\u0441\u0442\u0432\u0438\u044f, \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u043e\u0442 \u0444\u0430\u0439\u043b"})})]})})]})},ut=function(e){return Object(h.jsx)("div",{children:Object(h.jsx)("div",{className:"sectionHeading",children:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438"})})},dt=n(638),jt=function(e){var t,n=document.getElementById("dropzone");if(e)return n.classList.add("isDragAccept"),Object(h.jsx)(Me.a.div,{initial:{y:"70vh"},animate:{y:"50vh"},children:Object(h.jsx)(dt.a,{className:"inCloudconIcon"})});null===n||void 0===n||null===(t=n.classList)||void 0===t||t.remove("isDragAccept")},bt=n(639);n(485);function pt(e){if(1==e.OrderStatusID)return!0}var Ot,ht=function(e){var t=Object(o.useContext)(dn).store,n=Object(o.useState)([]),r=Object(O.a)(n,2),c=r[0],s=r[1],i=new URLSearchParams(Object(p.h)().search).get("edit"),l=Object(o.useState)(i),u=Object(O.a)(l,2),d=u[0],j=u[1],b=Object(N.useMutation)(_e),m=Object(O.a)(b,1)[0],f=Object(p.i)().id,v=Object(o.useCallback)((function(e){s(e),t.uploadFile(e).then((function(e){if(200!=e.status)console.log("S3 file upload error");else{for(var t=[],n=0;n<e.data.length;n+=2)t.push({Key:e.data[n].key,OrderID:f,FileName:e.data[n].originalname});m({variables:{objects:t}})}s([]),D()}))}),[]),x=Object(N.useQuery)(De,{variables:{OrderID:f}}),g=x.loading,y=(x.error,x.data),I=void 0===y?[]:y,D=x.refetch,_=Object(N.useQuery)(F).data,C=void 0===_?[]:_,k=Object(Ie.a)({className:"dropzone",onDrop:v}),w=k.getRootProps,M=k.isDragActive;return Object(h.jsxs)(Me.a.div,{initial:{scale:.92},animate:{scale:1},transition:{duration:.2},children:[jt(M),g?null:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"page-header",children:[Object(h.jsxs)(bt.a,{children:[I.erp_Orders[0].Entity," __ ",I.erp_Orders[0].City,pt(I.erp_Orders[0])&&Object(h.jsx)("span",{className:"preorderTitle",children:" | \u041f\u0440\u0435\u0434\u0437\u0430\u043a\u0430\u0437"})]}),Object(h.jsx)(xe,{accessLevel:2,setEditState:j,editState:d})]}),Object(h.jsxs)("section",Object(a.a)(Object(a.a)({className:"OrderLayout"},w()),{},{id:"dropzone",children:[Object(h.jsxs)("div",{className:"Main",children:[Object(h.jsx)("div",{className:"Composition",children:Object(h.jsx)(Ue,{data:I.erp_Orders[0].OrderItems,editState:d,refetch:D,orderID:f})}),Object(h.jsxs)("div",{className:"WrapperTwoCol",children:[Object(h.jsx)(at,{data:I.erp_Orders[0].CheckListUnits}),Object(h.jsx)(lt,{data:I.erp_Orders[0].Docs,onUpload:c,editState:d,refetch:D})]}),Object(h.jsx)(ut,{})]}),d?Object(h.jsx)(tt,{data:I.erp_Orders[0],orderID:f,refetch:D,users:C.erp_Users}):Object(h.jsx)(Ke,{data:I.erp_Orders[0],editState:d,orderID:f})]}))]})]})},mt=Object(w.a)(Ot||(Ot=Object(k.a)(["\nquery MyQuery($gte: timestamp!, $lte: timestamp!) {\n  attendance_users_aggregate(\n    order_by: {lastname: asc}\n    ){\n    nodes {\n      id\n      card\n      firstname\n      lastname\n      intervalsPools(where: {entrance: {_gte: $gte,  _lte: $lte}}) {\n        entrance\n        exit\n        card\n        interval\n        status\n      }\n    }\n  }\n}  \n"])));function ft(e){var t=Object(O.a)(e,2),n=t[0],a=t[1];return new Date(a,n+1,0).getDate()}var vt=n(106),xt=n.n(vt);function gt(e,t,n){function a(e){var t=e.getMinutes();return t<10?"0".concat(t):t}var r=t.find((function(t){return new Date(t.entrance).getDate()==e}));if(r){var c=new Date(r.entrance),s=new Date(r.exit);return[c.getHours()+":"+a(c),s.getHours()+":"+a(s),function(e,t){e-=t/60;var n=Math.floor(e),a=e-n,r=1/60;a=r*Math.round(a/r);var c=Math.floor(60*a)+"";return c.length<2&&(c="0"+c),n+":"+c}(r.interval,n),r.status]}return[null,null,null,null]}function yt(e){var t=e.columns,n=e.data,r=e.className,c=Object(E.useTable)({columns:t,data:n}),s=c.getTableProps,i=c.getTableBodyProps,o=c.headerGroups,l=c.rows,u=c.prepareRow;return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("table",Object(a.a)(Object(a.a)({className:r},s()),{},{children:[Object(h.jsx)("thead",{children:o.map((function(e,t){return Object(h.jsx)("tr",Object(a.a)(Object(a.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e,t){return Object(h.jsx)("th",Object(a.a)(Object(a.a)({},e.getHeaderProps()),{},{children:e.render("Header")}))}))}),t)}))}),Object(h.jsx)("tbody",Object(a.a)(Object(a.a)({},i()),{},{children:l.map((function(e,t){return u(e),Object(h.jsx)("tr",Object(a.a)(Object(a.a)({},e.getRowProps()),{},{children:e.cells.map((function(e,t){return Object(h.jsx)("td",Object(a.a)(Object(a.a)({},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]}))})}n(552);function It(e,t){var n=e;return(n=new Date(e.getFullYear(),e.getMonth(),1)).setMonth(n.getMonth()+(t+1)),n.setDate(n.getDate()-1),e.getDate()<n.getDate()&&n.setDate(e.getDate()),n}var Dt=function(e){var t=e.state,n=e.dispatch,a=new Date,r=["\u044f\u043d\u0432","\u0444\u0435\u0432","\u043c\u0430\u0440","\u0430\u043f\u0440","\u043c\u0430\u0439","\u0438\u044e\u043d","\u0438\u044e\u043b","\u0430\u0432\u0433","\u0441\u0435\u043d","\u043e\u043a\u0442","\u043d\u043e\u044f","\u0434\u0435\u043a"],c=function(e){var t=new Date(e.target.attributes.date.value);n({type:"selectedMonth",payload:[t.getMonth(),t.getFullYear()]})};return Object(h.jsxs)("div",{className:"reportConfigurator",children:[function(){for(var e=[],n=0;n<6;n++){var s=It(a,-n);e.push(Object(h.jsxs)("div",{onClick:c,className:s.getMonth()==t.selectedMonth[0]?"active":"",date:s,children:[" ",r[s.getMonth()]," "]}))}return Object(h.jsx)("div",{className:"chooseMonth",children:e})}(),Object(h.jsx)("div",{className:"arguments",children:Object(h.jsxs)("div",{className:"wrap",children:[Object(h.jsx)("span",{children:"\u043e\u0431\u0435\u0434"}),Object(h.jsx)("input",{type:"text",defaultValue:t.timeDeduction,onChange:function(e){n({type:"timeDeduction",payload:parseInt(e.target.value.trim())})}}),Object(h.jsx)("span",{children:"\u043c\u0438\u043d"})]})})]})},_t=function(e){return Object(h.jsxs)("div",{className:"base-container page-header",children:[Object(h.jsx)("span",{children:e.pageParams.icon}),Object(h.jsx)(bt.a,{children:e.pageParams.title}),e.children]})},Ct=null,Nt=function(e){var t=new Date,n=Object(o.useContext)(dn).store;var r=Object(o.useReducer)((function(e,t){switch(t.type){case"selectedMonth":case"timeDeduction":case"filtredData":return Object(a.a)(Object(a.a)({},e),{},Object(y.a)({},t.type,t.payload));default:throw new Error}}),{timeDeduction:30,selectedMonth:[t.getMonth()-1,t.getFullYear()]}),c=Object(O.a)(r,2),s=c[0],i=c[1],l=s.timeDeduction,u=s.selectedMonth,d=s.filtredData,j=function(e){var t=Object(O.a)(e,2),n=t[0],a=t[1],r=(parseInt(n)+1).toString().replace(/(^|\D)(\d)(?!\d)/g,"$10$2");return{gte:a+"-"+r+"-01T00:00:00",lte:a+"-"+r+"-"+ft(e)+"T23:59:59"}}(u),b=j.gte,p=j.lte;Object(N.useQuery)(mt,{variables:{gte:b,lte:p},onCompleted:function(e){Ct=e.attendance_users_aggregate.nodes,i({type:"filtredData",payload:Ct})}}).loading;Object(o.useEffect)((function(){return function(){Ct=null}}),[]);var m=function(e){var t=e.target.value.trim();if(""!==t){var n=Ct.filter((function(e){return function(e,t){return!!e.lastname.toLowerCase().startsWith(t.toLowerCase())||!!e.firstname.toLowerCase().startsWith(t.toLowerCase())}(e,t)}));i({type:"filtredData",payload:n})}else i({type:"filtredData",payload:Ct})},f=Object(o.useMemo)((function(){return function(e,t){for(var n=[{Header:"\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a",accessor:function(e){return Object(h.jsxs)("div",{children:[Object(h.jsxs)("span",{children:[e.lastname," "]}),Object(h.jsxs)("span",{children:[e.firstname," "]})]})}},{Header:"\u0418\u0442\u043e\u0433\u043e",Cell:function(e){var n=0,a=e.row.original.intervalsPools;return a.forEach((function(e){n+=e.interval})),n-=t/60*a.length,Object(h.jsx)("div",{children:n.toFixed(0)})}}],a=1;a<=ft(e);a++)n.push({Header:a.toString(),Cell:function(e){var n=gt(e.column.Header,e.row.original.intervalsPools,t),a=Object(O.a)(n,4),r=a[0],c=a[1],s=a[2],i=a[3];return Object(h.jsxs)("div",{className:"status-"+i,children:[Object(h.jsx)("div",{children:r}),Object(h.jsx)("div",{children:c}),Object(h.jsx)("div",{className:xt.a.interval,children:s})]})}});return n}(u,l)}),[u,l]);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(_t,{pageParams:n.getPageParams(window.location.pathname),search:m}),Object(h.jsx)(Dt,{state:s,dispatch:i}),Object(h.jsxs)("div",{className:xt.a.tableWrapper,children:[Object(h.jsxs)("div",{className:xt.a.tableSearchInput,children:[Object(h.jsx)(z.a,{}),Object(h.jsx)("input",{type:"text",placeholder:"\u043f\u043e\u0438\u0441\u043a (\u043d\u043e\u043c\u0435\u0440 \u0441\u0447\u0435\u0442\u0430 \u0438\u043b\u0438 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f)",onChange:function(e){return m(e)},autoFocus:!0})]}),d&&f&&Object(h.jsx)(yt,{columns:f,data:d,className:xt.a.attendanceTable}),Object(h.jsxs)("div",{className:"".concat(xt.a.tableFooter," legend"),children:[Object(h.jsx)("div",{className:"status-101",children:"\u041f\u0440\u0435\u0440\u0432\u0430\u043d\u043d\u044b\u0439 \u0440\u0430\u0431\u043e\u0447\u0438\u0439 \u0434\u0435\u043d\u044c"}),Object(h.jsx)("div",{className:"status-102",children:"\u041d\u0435 \u043e\u0442\u043c\u0435\u0447\u0435\u043d \u043a\u043e\u043d\u0435\u0446 \u0441\u043c\u0435\u043d\u044b"}),Object(h.jsxs)("span",{className:"reportMeta",children:["\u041e\u0442\u0447\u0435\u0442 \u0437\u0430 ",u[0]+1," \u043c\u0435\u0441\u044f\u0446 ",u[1]," \u0433\u043e\u0434\u0430"]})]})]})]})},kt=function(e){return Object(h.jsx)("div",{children:"reclamation"})},wt=function(){return Object(h.jsxs)(p.d,{children:[Object(h.jsx)(p.b,{path:"/login",component:g}),Object(h.jsx)(f,{exact:!0,path:"/",component:ye}),Object(h.jsx)(f,{path:"/attendance",component:Nt}),Object(h.jsx)(f,{path:"/reclamation",component:kt}),Object(h.jsx)(f,{path:"/orders/:id",component:ht}),"#if required route was not found",Object(h.jsx)(p.a,{to:"/"})]})},Mt=function(e){return Object(h.jsxs)("div",{className:"base-container",children:[Object(h.jsx)(wt,{}),e.children]})},Ft=n(642),St=(n(553),n(643)),Tt=n(644),Pt=n(645),Lt=n(646),At=n(647),$t=n(321),Ut=n(640),Rt=n(641),qt="dark",Ht=function(e){var t=Object($t.useMediaQuery)({query:"(prefers-color-scheme: dark)"},void 0,(function(e){c(e)})),n=Object(o.useState)(t),a=Object(O.a)(n,2),r=a[0],c=a[1];return Object(o.useEffect)((function(){r?document.documentElement.classList.add(qt):document.documentElement.classList.remove(qt)}),[r]),"none"==e.display?null:Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{className:"DarkToggle ",onClick:function(){return c(!r)},children:r?Object(h.jsx)(Ut.a,{}):Object(h.jsx)(Rt.a,{})})})},Et=function(){var e=Object(o.useContext)(dn).store;return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)(Ft.a,{className:"Sidebar",children:[Object(h.jsx)(A.c,{exact:!0,to:"/",activeClassName:"sidebar-active",className:"action-icon",children:Object(h.jsx)(St.a,{})}),Object(h.jsx)(A.c,{to:"/reclamation",activeClassName:"sidebar-active",className:"action-icon",children:Object(h.jsx)(Tt.a,{})}),Object(h.jsx)(A.c,{to:"/attendance",activeClassName:"sidebar-active",className:"action-icon",children:Object(h.jsx)(Pt.a,{})}),Object(h.jsx)("a",{className:"action-icon hidden",children:Object(h.jsx)(Ht,{})}),Object(h.jsx)(A.c,{className:"action-icon hidden",to:"/account",children:Object(h.jsx)(Lt.a,{})}),Object(h.jsx)(A.c,{className:"action-icon hidden",to:"/login",onClick:function(){return e.logout()},children:Object(h.jsx)(At.a,{})})]})})},Yt=n(325),zt=n(648),Bt=n(170),Kt=Object(Yt.a)({palette:{type:"dark",primary:Bt.a}});Kt.overrides={MuiInputLabel:{root:{color:"var(--lowContrast)",fontSize:".8rem"}},MuiInputBase:{root:{borderBottom:"none",color:"var(--highContrast)","&::before":{borderColor:"var(--border) !important"}}},MuiIconButton:{root:{color:"var(--lowContrast)",opacity:.5}},MuiAutocomplete:{paper:{background:"var(--L1) !important",border:"1px solid var(--border)"},listbox:{color:"var(--highContrast)",fontSize:".8rem"}}};var Wt=Object(b.a)((function(){var e=Object(o.useContext)(dn).store;return Object(h.jsx)(zt.a,{theme:Kt,children:Object(h.jsxs)("div",{className:"App",children:[e.isAuth?Object(h.jsx)(Et,{}):null,Object(h.jsx)(Ht,{display:"none"}),Object(h.jsx)(Mt,{})]})})})),Vt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,664)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))},Qt=n(120),Gt=n(77),Jt=n(41),Xt=n(649),Zt=n(96),en=n.n(Zt),tn="https://factory.piek.ru/api",nn=en.a.create({withCredentials:!0,baseURL:tn});nn.interceptors.request.use((function(e){return e.headers.Authorization="Bearer ".concat(localStorage.getItem("token")),e})),nn.interceptors.response.use((function(e){return e}),function(){var e=Object(i.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.config,401!==t.response.status||!t.config||t.config._isRetry){e.next=14;break}return n._isRetry=!0,e.prev=3,e.next=6,en.a.get("".concat(tn,"/refresh"),{withCredentials:!0});case 6:return a=e.sent,localStorage.setItem("token",a.data.accessToken),e.abrupt("return",nn.request(n));case 11:e.prev=11,e.t0=e.catch(3),console.log("\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u043e\u0431\u043b\u043e\u043c\u0438\u043b\u0430\u0441\u044c. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0441\u043d\u043e\u0432\u0430");case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}());var an=nn,rn=function(){function e(){Object(Qt.a)(this,e)}return Object(Gt.a)(e,null,[{key:"login",value:function(){var e=Object(i.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",an.post("/login",{email:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",an.post("/logout"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),cn=function(){function e(){Object(Qt.a)(this,e),this.user={},this.isAuth=!1,this.isLoading=!1,this.inMemoryToken=void 0,this.priorityTab=1,this.cachedOrders=[],this.cachedPreOrders=[],this.pageParams=[{url:"/reclamation",icon:Object(h.jsx)(Tt.a,{}),title:"\u0420\u0435\u043a\u043b\u0430\u043c\u0430\u0446\u0438\u044f"},{url:"/attendance",icon:Object(h.jsx)(Pt.a,{}),title:"\u0420\u0430\u0431\u043e\u0447\u0435\u0435 \u0432\u0440\u0435\u043c\u044f"}],this.preloader=Object(h.jsx)(Ft.a,{display:"flex",alignItems:"center",justifyContent:"center",height:"75vh",children:Object(h.jsx)(Xt.a,{})}),Object(Jt.d)(this)}return Object(Gt.a)(e,[{key:"setAuth",value:function(e){this.isAuth=e}},{key:"setUser",value:function(e){this.user=e}},{key:"setLoading",value:function(e){this.isLoading=e}},{key:"setInMemoryToken",value:function(e){this.inMemoryToken=e}},{key:"setPriorutyTab",value:function(e){this.priorityTab=e}},{key:"setCachedOrders",value:function(e){this.cachedOrders=e}},{key:"setCachedPreOrders",value:function(e){this.cachedPreOrders=e}},{key:"login",value:function(){var e=Object(i.a)(s.a.mark((function e(t,n){var a,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rn.login(t,n);case 3:a=e.sent,this.setInMemoryToken(a.data.accessToken),this.setUser(a.data.user),this.setAuth(!0),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(null===(r=e.t0.response)||void 0===r||null===(c=r.data)||void 0===c?void 0:c.message);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(i.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,rn.logout();case 3:localStorage.removeItem("token"),this.setAuth(!1),this.setUser({}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(null===(t=e.t0.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNewToken",value:function(){var e=Object(i.a)(s.a.mark((function e(){var t=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",en.a.get("".concat(tn,"/refresh"),{withCredentials:!0}).then((function(e){return t.setInMemoryToken(e.data.accessToken),e.data.accessToken})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"checkAuth",value:function(){var e=Object(i.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setLoading(!0),e.prev=1,console.log("check auth request"),e.next=5,en.a.get("".concat(tn,"/refresh"),{withCredentials:!0});case 5:return t=e.sent,this.setInMemoryToken(t.data.accessToken),this.setUser(t.data.user),this.setAuth(!0),e.abrupt("return",{isLoaded:!0,isAuth:this.isAuth});case 12:return e.prev=12,e.t0=e.catch(1),console.log(null===(n=e.t0.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.message),e.abrupt("return",{isLoaded:!0,isAuth:this.isAuth});case 16:return e.prev=16,this.setLoading(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,12,16,19]])})));return function(){return e.apply(this,arguments)}}()},{key:"uploadFile",value:function(){var e=Object(i.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FormData,t.map((function(e){return n.append("files",e)})),e.next=4,en.a.post("".concat("https://factory.piek.ru/api","/s3/upload"),n,{headers:{"Content-Type":"multipart/form-data"}});case 4:return a=e.sent,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"downloadFile",value:function(){var e=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://factory.piek.ru/api","/s3/get/").concat(t.Key));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteFile",value:function(){var e=Object(i.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,en.a.get("".concat("https://factory.piek.ru/api","/s3/delete/").concat(t));case 2:if(200!=e.sent.status){e.next=8;break}return e.next=6,n({variables:{key:t}});case 6:a=e.sent,console.log(a.data);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getPageParams",value:function(e){return this.pageParams.find((function(t){return t.url===e}))}}]),e}(),sn=(n(571),n(572),n(327)),on=n(322),ln=["headers"],un=new cn,dn=Object(o.createContext)({store:un}),jn=new sn.a({uri:"wss://hasura.piek.ru/v1/graphql",options:{reconnect:!0,lazy:!0,reconnectionAttempts:5,inactivityTimeout:1e7,connectionCallback:function(){var e=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&console.log(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),connectionParams:function(){return{headers:{Authorization:"Bearer ".concat(un.inMemoryToken)}}}}}),bn=Object(on.a)(function(){var e=Object(i.a)(s.a.mark((function e(t,n){var c,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=n.headers,i=Object(r.a)(n,ln),o=null,!(Date.now()>=1e3*j.a.decode(un.inMemoryToken).exp)){e.next=7;break}return console.log("Existed access token was expired, request for new token.."),e.next=6,un.getNewToken();case 6:o=e.sent;case 7:return e.abrupt("return",Object(a.a)({headers:Object(a.a)(Object(a.a)({},c),o?{Authorization:"Bearer ".concat(o)}:{})},i));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),pn=new N.ApolloClient({link:Object(N.from)([bn,jn]),cache:new N.InMemoryCache({typePolicies:{erp_Orders:{keyFields:["OrderID"]}}})}),On=document.getElementById("root");u.a.render(Object(h.jsx)(N.ApolloProvider,{client:pn,children:Object(h.jsx)(A.a,{children:Object(h.jsx)(Wt,{sessionData:On.dataset.session,children:Object(h.jsx)(dn.Provider,{value:un})})})}),On),Vt()},72:function(e,t,n){e.exports={name:"composition_name__1O75u",quantity:"composition_quantity__2YtVw",addOrderItem:"composition_addOrderItem__2AnFf","MuiFormControl-root":"composition_MuiFormControl-root__EpKj4",fullNameInput:"composition_fullNameInput__89_5p",quantityInput:"composition_quantityInput__2zcBe",pushOrderItemButton:"composition_pushOrderItemButton__2NTfr",Unit:"composition_Unit__2Fqng",orderItemActions:"composition_orderItemActions__AIthU",firstRow:"composition_firstRow__2LTDe",fullName:"composition_fullName__NObJ0"}},75:function(e,t,n){e.exports={tableWrapper:"main_tableWrapper__3lHmG",tableSearchInput:"main_tableSearchInput__3VMNw","action-icon":"main_action-icon__1owGu",tableFooter:"main_tableFooter__1Egk2",tableMain:"main_tableMain__GJwKh",awaitingDispatch:"main_awaitingDispatch__ZF9uh"}}},[[582,1,2]]]);
//# sourceMappingURL=main.6392947d.chunk.js.map