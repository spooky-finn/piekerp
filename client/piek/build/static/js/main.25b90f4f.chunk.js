(this.webpackJsonppiek=this.webpackJsonppiek||[]).push([[0],{103:function(e,t,n){e.exports={filterFormControl:"archive_filterFormControl__1uVNU",filterInputBase:"archive_filterInputBase__1-l5J"}},104:function(e,t,n){e.exports={needAttention:"order_needAttention__36HJS",awaitingDispatch:"order_awaitingDispatch__2aIpT",groupOrderButtons:"order_groupOrderButtons__3MvrK",orderActionsRow:"order_orderActionsRow__1ro0y"}},107:function(e,t,n){e.exports={filter:"search_filter__F_ZsO",filterPlaceholder:"search_filterPlaceholder__1WCV5",filterIndicator:"search_filterIndicator__33hWx",circle:"search_circle__28B_G",pulsate:"search_pulsate__c8CLI",adjacentSearchWrap:"search_adjacentSearchWrap__1v790"}},136:function(e,t,n){e.exports={deleteButton:"OrderItemActions_deleteButton__366_d",moreVertIcon:"OrderItemActions_moreVertIcon__1nfZK",inputListItem:"OrderItemActions_inputListItem__2r1Lq"}},137:function(e,t,n){e.exports={grid:"styles_grid__2B7og",gridCard:"styles_gridCard__Zz1TM",selectThemeWrapper:"styles_selectThemeWrapper__2JWIW"}},138:function(e,t,n){e.exports={themeToggleButtons:"SettingsDrawer_themeToggleButtons__hIzSP",user:"SettingsDrawer_user__3iVNA",logoutButton:"SettingsDrawer_logoutButton__2_Id_"}},187:function(e,t,n){e.exports={table_search_wrapper:"table_search_table_search_wrapper__2YVA3"}},188:function(e,t,n){e.exports={preOrdersTableWrapper:"preorders_preOrdersTableWrapper__28dMd"}},241:function(e,t,n){},254:function(e,t,n){},255:function(e,t,n){},274:function(e,t,n){},275:function(e,t,n){},276:function(e,t,n){},277:function(e,t,n){},278:function(e,t,n){},288:function(e,t,n){"use strict";n.r(t),n.d(t,"Context",(function(){return ba})),n.d(t,"getInMemoryToken",(function(){return pa})),n.d(t,"getNewInMemoryToken",(function(){return ja}));var r=n(23),a=n.n(r),i=n(26),c=n(1),s=n(57),o=n.n(s),d=n(6),u=n(9),l=n(198),m=n(37),b=n(22),p=n(0),j=["component"],O=function(e){var t=e.component,n=Object(b.a)(e,j),r=Object(c.useContext)(ba).store,s=Object(c.useState)(!1),o=Object(u.a)(s,2),l=o[0],O=o[1],h=Object(c.useState)(r.inMemoryToken),f=Object(u.a)(h,2),v=f[0],x=f[1];function g(){return(g=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.checkAuth().then((function(e){x(e),O(!0)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){v?O(!0):function(){g.apply(this,arguments)}()}),[]),Object(p.jsx)(m.b,Object(d.a)(Object(d.a)({},n),{},{render:function(e){if(l)return v?Object(p.jsx)(t,Object(d.a)({},e)):Object(p.jsx)(m.a,{to:"/login"})}}))},h=n(381),f=n(388),v=(n(241),n(126)),x=(n(242),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;return v.Store.addNotification({title:t,message:n,type:e,insert:"bottom",container:"top-right",dismiss:{duration:r},slidingExit:{duration:50}})}),g=function(){var e=Object(c.useState)(""),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(""),o=Object(u.a)(s,2),d=o[0],l=o[1],b=Object(c.useContext)(ba).store,j=Object(m.g)(),O=function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.login(n,d);case 2:200===(null===(t=e.sent)||void 0===t?void 0:t.status)?j.push("/"):x("warning","Unauthorized error","Invalig email or password");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("div",{className:"loginCard",children:[Object(p.jsx)(h.a,{className:"loginInput",variant:"filled",label:"Email",onChange:function(e){return r(e.target.value.trim())}}),Object(p.jsx)(h.a,{label:"Password",type:"password",variant:"filled",className:"loginInput",onChange:function(e){return l(e.target.value.trim())}}),Object(p.jsx)(f.a,{className:"Button",variant:"outlined",width:"300px",onClick:O,children:"\u0412\u043e\u0439\u0442\u0438"})]})})},_=n(4);function I(e,t){switch(t.type){case"orders":case"preOrders":case"selectedTab":case"searchKeyword":case"searchResult":case"managerFilter":return Object(d.a)(Object(d.a)({},e),{},Object(_.a)({},t.type,t.payload));case"resetFilters":return Object(d.a)(Object(d.a)({},e),{},{managerFilter:0,search:Object(d.a)(Object(d.a)({},e.search),{},{keyword:""})});case"search.brief":return Object(d.a)(Object(d.a)({},e),{},{search:Object(d.a)(Object(d.a)({},e.search),{},{brief:t.payload})});case"search.keyword":return Object(d.a)(Object(d.a)({},e),{},{search:Object(d.a)(Object(d.a)({},e.search),{},{keyword:t.payload})});default:return Object(d.a)({},e)}}var D,y,N,C=n(20),w=n(21),k=n(19),S=Object(k.a)(D||(D=Object(w.a)(["\nsubscription{\n    erp_Orders(where: {OrderStatusID: {_in: [1,2]} }) {\n      OrderID\n      Entity\n      InvoiceNumber\n      City\n      ShippingDate\n      AcceptanceDate\n      PaidAmount\n      TotalAmount\n      AwaitingDispatch\n      NeedAttention\n      CreatingDate\n      ManagerID\n      OrderStatus {\n        Name\n        ID\n      }\n      OrderItems(order_by: {OrderItemID: asc}){\n        Quantity\n        OrderItemID\n        Name\n        OrderID\n      } \n      User {\n        FirstName\n        LastName\n      }\n\n    }  \n  }\n"]))),M=Object(k.a)(y||(y=Object(w.a)(["\nquery getUsers {\n  erp_Users{\n    FirstName\n    LastName\n    UserID\n    AccessLevelID\n  }\n}\n"]))),T=Object(k.b)(N||(N=Object(w.a)(["\nmutation MyMutation($managerID: Int!, $orderStatusID: Int!) {\n  insert_erp_Orders(objects: {ManagerID: $managerID, OrderStatusID:  $orderStatusID}) {\n    returning {\n      OrderID\n    }\n  }\n}\n"]))),A=n(374),F=n(394),$=n(345),L=n(8),U=n(347),P=n(33),E=n(35),H=n(29),R=n.n(H),q=n(43),B=n.n(q),Y=[{Header:"",id:"index",accessor:function(e,t){return t+1}},{Header:"\u041d\u0430\u0438\u043c.",id:"orderItems",accessor:function(e){return 0===e.OrderItems.length?Object(p.jsx)(E.b,{to:"/orders/".concat(e.OrderID),children:Object(p.jsx)("div",{children:"\u041d\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e"})}):Object(p.jsx)(p.Fragment,{children:e.OrderItems.map((function(e){return Object(p.jsx)("div",{children:Object(p.jsx)("span",{children:e.Name})},e.OrderItemID)}))})}},{Header:"\u041a\u043e\u043b-\u0432\u043e",accessor:function(e){return e.OrderItems.map((function(e){return Object(p.jsx)("div",{children:Object(p.jsx)("div",{children:e.Quantity})},e.OrderItemID)}))}},{Header:"\u041e\u0442\u0433\u0440\u0443\u0437\u043a\u0430",accessor:function(e){return Object(p.jsxs)(p.Fragment,{children:[" ",e.ShippingDate&&R()(e.ShippingDate).format("DD.MM.YY")," "]})}},{Header:"\u041a\u043e\u043c\u043f\u0430\u043d\u0438\u044f / \u0433\u043e\u0440\u043e\u0434",accessor:function(e){return Object(p.jsxs)("div",{className:B.a.customerTableInfo,children:[Object(p.jsx)("div",{children:e.Entity}),Object(p.jsx)("div",{children:e.City})]})}},{Header:"\u0421\u0447\u0435\u0442- \u043e\u043f\u043b\u0430\u0442\u0430",accessor:function(e){return e.InvoiceNumber+(t=e.TotalAmount,n=e.PaidAmount,t&&n?" - "+(n/t*100).toFixed(0)+"%":" - 0%");var t,n}},{Header:"\u041c\u0434\u0436.",accessor:function(e){var t;return Object(p.jsxs)(p.Fragment,{children:[" ",(null===(t=e.User)||void 0===t?void 0:t.FirstName[0])||""," "]})}}],W=n(131);function z(e,t){var n;return t&&e.unpaid?B.a.unpaidOrder:"true"===(null===(n=e.NeedAttention)||void 0===n?void 0:n.split(",")[0])?B.a.needAttention:e.AwaitingDispatch?B.a.awaitingDispatch:""}function V(e){var t=e.columns,n=e.data,r=e.className,a=e.showUnpaid,i=Object(W.useTable)({columns:t,data:n}),c=i.getTableProps,s=i.getTableBodyProps,o=i.headerGroups,u=i.rows,l=i.prepareRow;return 0===n.length?null:Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("div",Object(d.a)(Object(d.a)({className:"".concat(B.a.tableMain," ").concat(r," ").concat(B.a.table)},c()),{},{children:[Object(p.jsx)("div",{className:B.a.thead,children:o.map((function(e,t){return Object(p.jsx)("div",Object(d.a)(Object(d.a)({className:B.a.tr},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e,t){return Object(p.jsx)("div",Object(d.a)(Object(d.a)({className:B.a.th},e.getHeaderProps()),{},{children:e.render("Header")}))}))}),t)}))}),Object(p.jsx)("div",Object(d.a)(Object(d.a)({},s()),{},{className:B.a.tbody,children:u.map((function(e,t){l(e);var n=e.original.OrderID;return Object(p.jsx)(E.b,Object(d.a)(Object(d.a)({to:"/orders/".concat(n),className:"".concat(z(e.original,a)," ").concat(B.a.tableRow)},e.getRowProps()),{},{children:e.cells.map((function(e,t){return Object(p.jsx)("div",Object(d.a)(Object(d.a)({className:B.a.td},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]}))})}var Q=n(107),K=n.n(Q),G=n(391),J=n(375),Z=n(378),X=n(344),ee=n(187),te=n.n(ee),ne=function(e){var t=e.placeholder,n=e.onChange,r=e.defaultValue,a=e.disableAutoFocus;return Object(p.jsxs)("div",{className:te.a.table_search_wrapper,children:[Object(p.jsx)(X.a,{}),Object(p.jsx)("input",{type:"text",placeholder:t,onChange:n,autoFocus:!a,defaultValue:r})]})};function re(e){for(var t=!1,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.map((function(n){n&&n.toLowerCase().includes(e.toLowerCase())&&(t=!0)})),!!t}var ae,ie,ce,se,oe,de=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if(r=""!==t?e.filter((function(e){return re(t,e.InvoiceNumber,e.Entity)})):e,0!==n){var a=[];return r.map((function(e){e.ManagerID===n&&a.push(e)})),a}return r},ue=function(e){var t=e.state,n=e.dispatch,r=e.users,a=Object(c.useContext)(ba).store;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)($.a,{sx:{display:"flex"},children:[Object(p.jsx)(ne,{placeholder:"\u0421\u0447\u0435\u0442, \u043a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442",onChange:function(e){var r,i=e.target.value.trim(),c=[];0===t.selectedTab?(c=t.orders,r="orders"):1===t.selectedTab&&(c=t.preOrders,r="preOrders");var s,o=(s=i,c.filter((function(e){return re(s,e.InvoiceNumber,e.Entity)})));n({type:"search.brief",payload:Object(d.a)(Object(d.a)({},t.search.breif),{},Object(_.a)({},r,o.length))}),a.orderListLastSearckKeyword=i,n({type:"search.keyword",payload:i})},defaultValue:t.search.keyword}),[{showonTab:1,data:t.search.brief.orders,title:"\u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u0438"},{showonTab:0,data:t.search.brief.preOrders,title:"\u0432 \u043f\u0440\u0435\u0434\u0437\u0430\u043a\u0430\u0437\u0430\u0445"}].map((function(e){return t.search.keyword&&e.data?e.showonTab===t.selectedTab?null:Object(p.jsxs)("div",{onClick:function(){return function(e,t){e({type:"selectedTab",payload:t.showonTab})}(n,e)},className:K.a.adjacentSearchWrap,children:[e.data," ",e.title]}):null})),r&&Object(p.jsxs)("div",{className:K.a.filter,children:[Object(p.jsx)("span",{className:K.a.filterPlaceholder,children:"\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440"}),Object(p.jsx)(G.a,{children:Object(p.jsxs)(J.a,{name:"managerFilter",value:t.managerFilter,onChange:function(e){n({type:"managerFilter",payload:e.target.value})},children:[Object(p.jsx)(Z.a,{value:0,children:"\u0412\u0441\u0435"}),r.map((function(e){return Object(p.jsxs)(Z.a,{value:e.UserID,children:[" ","".concat(e.FirstName," ").concat(e.LastName)," "]},e.UserID)}))]})})]})]}),function(){if(0!==t.managerFilter)return Object(p.jsxs)("div",{className:K.a.filterIndicator,children:[Object(p.jsx)("div",{className:K.a.circle}),Object(p.jsx)("p",{children:"\u0412\u044b\u0434\u0430\u0447\u0430 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u043c"})]})}(t.managerFilter)]})},le=Object(k.b)(ae||(ae=Object(w.a)(["\n    mutation MyMutation($OrderID: Int!, $AcceptanceDate: timestamp!){\n    update_erp_Orders_by_pk(\n      pk_columns: {OrderID: $OrderID},\n       _set: {\n         OrderStatusID: 2,\n         AcceptanceDate: $AcceptanceDate,\n         }\n      ) {\n        OrderID\n    }\n  }\n\n"]))),me=n(188),be=n.n(me),pe=function(e){var t=e.state,n=e.dispatch,r=t.preOrders,a=Object(C.useMutation)(le),i=(Object(u.a)(a,1)[0],Object(P.a)(Y)),c=de(r,t.search.keyword);return Object(p.jsxs)("div",{className:"".concat(B.a.tableWrapper," ").concat(be.a.preOrdersTableWrapper),children:[Object(p.jsx)(ue,{state:t,dispatch:n}),c&&Object(p.jsx)(V,{columns:i,data:c})]})},je=function(e){var t=e.users,n=e.state,r=e.dispatch,a=(Object(c.useContext)(ba).store,Object(c.useMemo)((function(){return Y}),[])),i=n.orders.sort((function(e,t){return new Date(e.ShippingDate)-new Date(t.ShippingDate)})),s=de(i,n.search.keyword,n.managerFilter);return Object(p.jsxs)("div",{className:B.a.tableWrapper,children:[t&&Object(p.jsx)(ue,{state:n,dispatch:r,users:t.filter((function(e){return[1,2].includes(null===e||void 0===e?void 0:e.AccessLevelID)}))}),s&&Object(p.jsx)(V,{columns:a,data:s})]})},Oe=n(192),he=n(393),fe={secondary:{color:"var(--lowContrast)",fontSize:".8rem",padding:"0 8px",textTransform:"none"},table:{borderTop:"var(--border)"}},ve=function(e){var t=function(e){var t,n=[{name:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",date:R()().subtract(0,"day").format("YYYY-MM-DD"),objs:[]},{name:"\u0412\u0447\u0435\u0440\u0430",date:R()().subtract(1,"day").format("YYYY-MM-DD"),objs:[]}],r=Object(Oe.a)(e);try{for(r.s();!(t=r.n()).done;){var a,i=t.value,c=null===(a=i.AcceptanceDate)||void 0===a?void 0:a.split("T")[0];c===n[0].date?n[0].objs.push(i):c===n[1].date&&n[1].objs.push(i)}}catch(s){r.e(s)}finally{r.f()}return n}(e.state.orders.sort((function(e,t){return new Date(t.AcceptanceDate)-new Date(e.AcceptanceDate)})));function n(e){if(0===e.length)return Object(p.jsx)(he.a,{style:fe.secondary,children:"\u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u0431\u044b\u043b\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e"})}return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(he.a,{variant:"subtitle1",m:"10px 10px",children:["\u0421\u0435\u0433\u043e\u0434\u043d\u044f ",n(t[0].objs)]}),t[0].objs.length?Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(V,{columns:Y,data:t[0].objs,style:fe.table})}):null,Object(p.jsxs)(he.a,{variant:"subtitle1",m:"10px 10px",children:["\u0412\u0447\u0435\u0440\u0430 ",n(t[1].objs)]}),t[1].objs.length?Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(V,{columns:Y,data:t[1].objs,style:fe.table})}):null]})},xe=Object(k.b)(ie||(ie=Object(w.a)(["\n    query ($keyword: String!, $OrderStatus: Int!){\n    erp_Orders(\n      order_by: {ActualShippingDate: desc_nulls_last},\n      where: {\n      _or: [\n        { Entity: {_ilike: $keyword} }, \n        { InvoiceNumber: {_ilike: $keyword} },\n        { OrderItems: {_and: [{SerialStarts: {_lte: $keyword}}, {SerialEnds: {_gte: $keyword }}] } },\n\n        ],\n      OrderStatusID: {_eq: $OrderStatus}\n      }) {\n        ActualShippingDate\n        AwaitingDispatch\n        OrderID\n        Entity\n        InvoiceNumber\n        City\n        ShippingDate\n        PaidAmount\n        TotalAmount\n        CreatingDate\n        ManagerID\n        OrderItems {\n          Quantity\n          OrderItemID\n          Name\n        } \n        User {\n          FirstName\n        }\n    }\n  }\n"]))),ge=n(103),_e=n.n(ge),Ie=Object(k.b)(ce||(ce=Object(w.a)(["\nquery{\n  erp_Orders(\n    where: {OrderStatusID: {_eq: 3}},\n    order_by: {OrderID: desc},\n    limit: 1000,\n    ){\n\t\tOrderID\n    PaidAmount\n    TotalAmount\n  }\n}\n"]))),De=Object(k.b)(se||(se=Object(w.a)(["\nquery($limit: Int!, $OrderStatus: Int!){\n  erp_Orders(\n    order_by: {ActualShippingDate: desc_nulls_last}\n    where: { OrderStatusID: {_eq: $OrderStatus } } \n    limit: $limit\n    ){\n    ActualShippingDate\n    ShippingDate\n    AwaitingDispatch\n    OrderID\n    Entity\n    InvoiceNumber\n    City\n    PaidAmount\n    TotalAmount\n    CreatingDate\n    ManagerID\n    OrderItems {\n      Quantity\n      OrderItemID\n      Name\n    } \n    User {\n      FirstName\n    }\n  }\n}\n"]))),ye=Object(k.b)(oe||(oe=Object(w.a)(["\nquery MyQuery($unpaidIDs: [Int!], $OrderStatus: Int!) {\n    erp_Orders(where: { OrderStatusID: {_eq: $OrderStatus}, OrderID: {_in: $unpaidIDs } } ) {\n      OrderID\n      Entity\n      InvoiceNumber\n      City\n      ShippingDate\n      PaidAmount\n      TotalAmount\n      AwaitingDispatch\n      ActualShippingDate\n      CreatingDate\n      ManagerID\n      OrderItems {\n        Quantity\n        OrderItemID\n        Name\n      } \n      User {\n        FirstName\n      }\n    }\n  }\n"]))),Ne=function(e){var t=e.state,n=e.dispatch,r=e.columns,a=Object(C.useQuery)(De,{variables:{limit:15,OrderStatus:t.reqOrderStatus},fetchPolicy:"cache-and-network"}),i=a.data,c=void 0===i?[]:i,s=(a.loading,Object(C.useQuery)(Ie,{onCompleted:function(e){n({type:"unpaidIDs",payload:e.erp_Orders.filter((function(e){return e.PaidAmount/e.TotalAmount<.999})).map((function(e){return e.OrderID}))})}}).loading,Object(C.useQuery)(ye,{variables:{unpaidIDs:t.unpaidIDs,OrderStatus:t.reqOrderStatus}})),o=s.data,u=void 0===o?[]:o;s.loading;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(he.a,{color:"textSecondary",variant:"subtitle1",m:"10px 1rem",children:"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 15 \u043e\u0442\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0445"}),Object(p.jsx)(V,{columns:r,data:u.erp_Orders&&c.erp_Orders?[].concat(Object(P.a)(u.erp_Orders.map((function(e){return Object(d.a)(Object(d.a)({},e),{},{unpaid:!0})}))),Object(P.a)(c.erp_Orders.filter((function(e){return!t.unpaidIDs.includes(e.OrderID)})).sort((function(e,t){return new Date(t.ActualShippingDate)-new Date(e.ActualShippingDate)})))):[],className:_e.a.archiveTable,showUnpaid:!0})]})},Ce=n(382),we=n(66),ke=function e(){Object(we.a)(this,e)};ke.ordRegistration=1,ke.ordProduction=2,ke.ordArchived=3,ke.reclInbox=10,ke.reclDecision=11,ke.reclProduction=12,ke.reclArchived=13;var Se=n(346);function Me(e,t){switch(t.type){case"reqOrderStatus":case"searchKeyword":case"unpaidIDs":return Object(d.a)(Object(d.a)({},e),{},Object(_.a)({},t.type,t.payload));default:return Object(d.a)({},e)}}var Te,Ae,Fe,$e,Le,Ue=function(){var e=Object(c.useReducer)(Me,{reqOrderStatus:ke.ordArchived,unpaidIDs:[],searchKeyword:""}),t=Object(u.a)(e,2),n=t[0],r=t[1],a=Object(C.useQuery)(xe,{variables:{keyword:"%"+n.searchKeyword+"%",OrderStatus:n.reqOrderStatus}}),i=a.data,s=void 0===i?[]:i,o=a.error;o&&console.error(o);var d=Object(c.useMemo)((function(){return Object(P.a)(Y)}),[]);d[3]={Header:"\u0424\u0430\u043a\u0442 \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0430",accessor:function(e){return Object(p.jsxs)(p.Fragment,{children:[" ",e.ActualShippingDate&&R()(e.ActualShippingDate).format("DD.MM.YY")]})}};return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(ne,{placeholder:"C\u0447\u0435\u0442, \u043a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442",onChange:function(e){setTimeout((function(){r({type:"searchKeyword",payload:e.target.value})}),400)}}),Object(p.jsxs)(G.a,{className:_e.a.filterFormControl,children:[Object(p.jsx)(Ce.a,{variant:"filter",children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e "}),Object(p.jsxs)(J.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:n.reqOrderStatus,label:"Age",className:_e.a.filterInputBase,onChange:function(e){r({type:"reqOrderStatus",payload:e.target.value})},children:[Object(p.jsx)(Z.a,{value:ke.ordArchived,children:"\u0417\u0430\u043a\u0430\u0437\u044b"}),Object(p.jsx)(Z.a,{value:ke.reclArchived,children:"\u0420\u0435\u043a\u043b\u0430\u043c\u0430\u0446\u0438\u0438"})]})]}),Object(p.jsxs)(Se.a,{marginTop:6,children:[!n.searchKeyword&&Object(p.jsx)(Ne,{state:n,dispatch:r,columns:d}),n.searchKeyword&&s.erp_Orders&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(he.a,{color:"textSecondary",variant:"subtitle1",m:"10px 1rem",children:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e\u0438\u0441\u043a\u0430 \u043f\u043e \u0430\u0440\u0445\u0438\u0432\u0443"}),Object(p.jsx)(V,{columns:d,data:s.erp_Orders,className:_e.a.archiveTable}),!s.erp_Orders.length&&Object(p.jsx)(he.a,{color:"textPrimary",m:2,variant:"subtitle2",children:"-> \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"})]})]})]})},Pe=["children","value","index"],Ee=Object(L.a)((function(e){return Object(p.jsx)(A.a,Object(d.a)({},e))}))((function(e){e.theme;return{background:"var(--LI)",minHeight:"10px","& .MuiTabs-indicator":{display:"none"}}})),He=Object(L.a)((function(e){return Object(p.jsx)(F.a,Object(d.a)({},e))}))((function(e){return{textTransform:"none",fontWeight:500,fontSize:e.theme.typography.pxToRem(14),borderRight:"1px solid transparent",borderLeft:"1px solid transparent",minHeight:"10px",color:"var(--lowContrast)","&.Mui-selected":{boxShadow:"0 0 15px 0px var(--shadow-color)",opacity:1,backgroundColor:"var(--L0)",color:"var(--accent) !important",borderRight:"var(--border)",borderLeft:"var(--border)"},"&:first-of-type":{borderLeft:"none !important"},"&.Mui-selected:first-of-type":{borderLeft:"none !important"}}})),Re=function(e){var t=Object(c.useContext)(ba).store,n=Object(c.useReducer)(I,function(e){return{orders:e.cachedOrders||[],preOrders:e.cachedPreOrders||[],selectedTab:e.selectedTab,managerFilter:0,search:{keyword:e.orderListLastSearckKeyword,brief:{orders:0,preOrders:0,reclamations:0,archived:0}}}}(t)),r=Object(u.a)(n,2),a=r[0],i=r[1],s=a.selectedTab,o=Object(m.g)(),l=Object(C.useSubscription)(S,{onSubscriptionData:function(e){e.subscriptionData.data.erp_Orders.sort((function(e,t){return new Date(e.ShippingDate)-new Date(t.ShippingDate)}));var n=[],r=[];e.subscriptionData.data.erp_Orders.forEach((function(e){1===e.OrderStatus.ID?r.push(e):2===e.OrderStatus.ID&&n.push(e)})),t.setCachedOrders(n),t.setCachedPreOrders(r),i({type:"preOrders",payload:r}),i({type:"orders",payload:n})}}),j=l.error;l.loading;j&&console.error(j);var O=Object(C.useQuery)(M).data,h=void 0===O?[]:O,v=Object(C.useMutation)(T,{variables:{managerID:t.user.UserID,orderStatusID:1}}),x=Object(u.a)(v,1)[0];function g(e){var t=e.children,n=e.value,r=e.index,a=Object(b.a)(e,Pe);return Object(p.jsx)("div",Object(d.a)(Object(d.a)({role:"tabpanel",hidden:n!==r,id:"simple-tabpanel-".concat(r),"aria-labelledby":"simple-tab-".concat(r)},a),{},{children:n===r&&Object(p.jsx)($.a,{mb:"30px",children:t})}))}function _(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(Ee,{value:s,onChange:function(e,n){i({type:"selectedTab",payload:n}),i({type:"resetFilters"}),t.selectedTab=n},"aria-label":"simple tabs example",children:[Object(p.jsx)(He,Object(d.a)({label:"\u041f\u0440\u0435\u0434\u0437\u0430\u043a\u0430\u0437\u044b"},_(0))),Object(p.jsx)(He,Object(d.a)({label:"\u041e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u044c"},_(1))),Object(p.jsx)(He,Object(d.a)({label:"\u041d\u0435\u0434\u0430\u0432\u043d\u0438\u0435"},_(2))),Object(p.jsx)(He,Object(d.a)({label:"\u0410\u0440\u0445\u0438\u0432"},_(3))),Object(p.jsx)($.a,{style:{marginLeft:"auto",marginRight:"10px",display:"flex",alignSelf:"center"},children:Object(p.jsx)(f.a,{onClick:function(){x().then((function(e){console.log(e),o.push("/orders/".concat(e.data.insert_erp_Orders.returning[0].OrderID,"?edit=true"))}))},variant:"iconic",children:Object(p.jsx)(U.a,{})})})]}),Object(p.jsx)(g,{value:s,index:0,children:Object(p.jsx)(pe,{state:a,dispatch:i})}),Object(p.jsx)(g,{value:s,index:1,children:Object(p.jsx)(je,{state:a,dispatch:i,users:h.erp_Users})}),Object(p.jsx)(g,{value:s,index:2,children:Object(p.jsx)(ve,{state:a,dispatch:i})}),Object(p.jsx)(g,{value:s,index:3,children:Object(p.jsx)(Ue,{state:a,dispatch:i})})]})},qe=n(200),Be=Object(k.a)(Te||(Te=Object(w.a)(["\nquery MyQuery($OrderID: Int!) {\n  erp_Orders(\n    where: {OrderID: {_eq: $OrderID}}\n    ){\n    # visual statuses\n    NeedAttention\n    AwaitingDispatch\n    OrderStatusID\n\n    # dates\n    ActualShippingDate\n    AcceptanceDate\n    ShippingDate\n    CreatingDate\n\n    OrderID\n    ManagerID\n    \n    City\n    \n    Comment\n    Entity\n    InvoiceNumber\n    \n    OrderNumber\n    User {\n      FirstName\n      LastName\n      UserID\n    }\n    OrderItems(order_by: {OrderItemID: asc}) {\n      Name\n      FullName\n      OrderItemID\n      Quantity\n    }\n    Docs {\n      Key\n      FileName\n      Size\n      UploadingDate\n    }\n\n    # finances\n    PaidAmount\n    TotalAmount\n    PaymentHistories(\n      where: {PaidAmount: {_neq: 0}}\n    ){\n      PaidAmount\n      Date\n    }\n\n  }\n}\n"]))),Ye=Object(k.b)(Ae||(Ae=Object(w.a)(["\n mutation MyMutation($name: String!, $orderID: Int!, $quantity: Int!, $fullName: String!) {\n  insert_erp_OrderItems_one(object: {\n    OrderID: $orderID,\n    Name: $name,\n    FullName: $fullName,\n    Quantity: $quantity,\n    }) {\n    OrderItemID\n    OrderID\n  }\n}\n"]))),We=Object(k.b)(Fe||(Fe=Object(w.a)(["\nmutation MyMutation($orderItemID: Int!) {\n  delete_erp_OrderItems_by_pk(OrderItemID: $orderItemID) {\n\t\tOrderItemID\n  }\n}\n"]))),ze=Object(k.b)($e||($e=Object(w.a)(["\nmutation($OrderItemID: Int!, $FullName: String!, $Name: String!, $Quantity: Int!) {\n  update_erp_OrderItems_by_pk(\n    pk_columns: {OrderItemID: $OrderItemID},\n    _set: {FullName: $FullName, Name: $Name, Quantity: $Quantity}) {\n    Name\n    FullName\n    OrderItemID\n    Quantity\n  }\n}\n\n"]))),Ve=Object(k.b)(Le||(Le=Object(w.a)(["\nmutation($OrderItemID: Int!, $Fitter: String!, $SerialNumber: String!) {\n  update_erp_OrderItems_by_pk(\n    pk_columns: {OrderItemID: $OrderItemID},\n     _set: {Fitter: $Fitter, SerialNumber: $SerialNumber}\n  ){\n    OrderItemID\n  }\n}\n"]))),Qe=n(395),Ke=n(396),Ge=n(397),Je=n(398),Ze=n(85),Xe=n.n(Ze),et=n(199),tt=n(348),nt=n(136),rt=n.n(nt),at=function(e){var t=e.editState,n=e.item,r=e.editItemHandler,a=e.deleteItemHandler,i=(e.updateItem,e.setOIDialog),s=Object(c.useState)(null),o=Object(u.a)(s,2),d=o[0],l=o[1],m=Object(c.useState)({serialNumber:n.SerialNumber,fitter:n.Fitter}),b=Object(u.a)(m,2),j=(b[0],b[1],function(){l(null)});return Object(p.jsxs)("div",{className:"noprint",children:[Object(p.jsx)(f.a,{sx:{minWidth:"20px"},"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){l(e.currentTarget)},size:"small",children:Object(p.jsx)(tt.a,{className:rt.a.moreVertIcon})}),Object(p.jsx)(et.a,{id:"simple-menu",anchorEl:d,keepMounted:!0,open:Boolean(d),onClose:j,children:t&&Object(p.jsxs)("div",{className:rt.a.actionsWrapper,children:[Object(p.jsx)(Z.a,{onClick:function(e){i(!0),j(),r(e,n)},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(p.jsx)(Z.a,{className:rt.a.deleteButton,onClick:function(){j(),a(n.OrderItemID)},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})})]})},it={name:"",fullName:"",quantity:"",id:null};function ct(e,t){switch(t.type){case"name":case"fullName":case"quantity":return Object(d.a)(Object(d.a)({},e),{},Object(_.a)({},t.type,t.payload));case"reset":return it;case"editItem":return{id:t.payload[0],name:t.payload[1],fullName:t.payload[2],quantity:t.payload[3]};default:return Object(d.a)({},e)}}var st,ot,dt,ut,lt,mt,bt=function(e){var t=e.data,n=e.editState,r=e.refetch,a=e.orderID,i=e.OIDialog,s=e.setOIDialog,o=Object(C.useMutation)(We),l=Object(u.a)(o,1)[0],m=Object(C.useMutation)(Ye),b=Object(u.a)(m,1)[0],j=Object(C.useMutation)(ze),O=Object(u.a)(j,1)[0],v=Object(C.useMutation)(Ve),x=Object(u.a)(v,1)[0],g=Object(c.useReducer)(ct,it),_=Object(u.a)(g,2),I=_[0],D=_[1],y=function(e){l({variables:{orderItemID:e}}),r()},N=function(e,t){D({type:"editItem",payload:[t.OrderItemID,t.Name,t.FullName,t.Quantity]})},w=function(){s(!1)};Object(c.useEffect)((function(){n||""===I.name||""===I.quantity||k()}),[n]);var k=function(){if(w(),""===I.quantity||""===I.name)return null;b({variables:{orderID:a,name:I.name,quantity:parseInt(I.quantity),fullName:I.fullName}}).then((function(){D({type:"reset"}),r()}))};return Object(p.jsxs)("div",{className:"Composition",children:[t.OrderItems.map((function(t,r){return Object(p.jsxs)("div",{className:Xe.a.Unit,children:[Object(p.jsx)("span",{className:Xe.a.index,children:r+1}),Object(p.jsxs)(he.a,{color:"textPrimary",className:Xe.a.name,children:[" ",t.Name," "]}),Object(p.jsxs)("span",{className:Xe.a.quantity,children:[" ",t.Quantity]}),n&&Object(p.jsx)(at,Object(d.a)(Object(d.a)({},e),{},{item:t,editItemHandler:N,deleteItemHandler:y,updateItem:x})),Object(p.jsxs)("div",{className:Xe.a.fullName,children:[" ",t.FullName]})]},t.OrderItemID)})),Object(p.jsxs)(Qe.a,{maxWidth:"sm",fullWidth:!0,open:i,onClose:w,children:[Object(p.jsx)(Ke.a,{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0437\u0438\u0446\u0438\u044e"}),Object(p.jsx)(Ge.a,{children:Object(p.jsxs)($.a,{className:Xe.a.addOrderItem,children:[Object(p.jsx)(h.a,{label:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",value:I.name,variant:"filled",sx:{mb:"8px"},onChange:function(e){return D({type:"name",payload:e.target.value})}}),Object(p.jsx)(h.a,{label:"\u041f\u043e\u043b\u043d\u043e\u0435 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",multiline:!0,variant:"filled",sx:{mb:"8px"},className:Xe.a.fullNameInput,value:I.fullName,onChange:function(e){return D({type:"fullName",payload:e.target.value})}}),Object(p.jsx)(h.a,{label:"\u041a\u043e\u043b-\u0432\u043e",type:"number",variant:"filled",sx:{mb:"8px"},className:Xe.a.quantityInput,value:I.quantity,onChange:function(e){return D({type:"quantity",payload:e.target.value})}})]})}),Object(p.jsxs)(Je.a,{sx:{justifyContent:"start"},children:[I.name&&I.quantity&&(I.id?Object(p.jsx)($.a,{children:Object(p.jsx)(f.a,{variant:"contained",onClick:function(){if(""===I.quantity||""===I.name)return null;w(),O({variables:{OrderItemID:I.id,Name:I.name,Quantity:parseInt(I.quantity),FullName:I.fullName}}).then((function(){D({type:"reset"}),r()}))},children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"})}):Object(p.jsxs)($.a,{children:[Object(p.jsx)(f.a,{variant:"contained",onClick:k,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})," "]})),Object(p.jsx)($.a,{children:Object(p.jsx)(f.a,{onClick:function(){w(),D({type:"reset"})},children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"})})]})]})]})},pt=(n(254),function(e){var t=e.heading,n=e.secondaryHeading;return Object(p.jsxs)($.a,{className:"OrderInfoCard",sx:{color:"text.primary"},children:[Object(p.jsxs)("div",{className:"row",children:[Object(p.jsx)(he.a,{variant:"subtitle2",children:t}),Object(p.jsx)(he.a,{variant:"subtitle3",className:"noprint secondaryHeadingAnimation",children:n})]}),Object(p.jsx)("div",{className:"body",children:e.children})]})}),jt=Object(L.a)((function(e){return Object(p.jsx)(he.a,Object(d.a)({},e))}))((function(e){return{color:e.theme.palette.text.secondary,fontSize:".7rem"}})),Ot=function(e){var t,n,r=e.data;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("div",{className:"wrap",children:[Object(p.jsxs)($.a,{className:"significantInfo",sx:{color:"text.primary"},children:[Object(p.jsxs)("div",{className:"bold",children:[Object(p.jsx)(jt,{children:"\u041f\u043b\u0430\u043d. \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0430"}),r.ShippingDate&&R()(r.ShippingDate).format("DD.MM.YY")]}),Object(p.jsxs)("div",{className:"bold",children:[Object(p.jsx)(jt,{children:"\u041d\u043e\u043c\u0435\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),r.OrderNumber]}),Object(p.jsxs)("div",{className:"bold",children:[Object(p.jsx)(jt,{children:"\u0421\u0447\u0435\u0442 / \u043e\u043f\u043b\u0430\u0442\u0430"}),"\u2116 "+(r.InvoiceNumber||"")+(t=r.TotalAmount,n=r.PaidAmount,t&&n?" - "+(n/t*100).toFixed(0)+"%":" ")]})]}),Object(p.jsxs)($.a,{className:"OrderComment",children:[Object(p.jsx)(jt,{children:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439"}),r.Comment]}),function(){var e,t,n,a=[{heading:"\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440",data:"".concat(null===(e=r.User)||void 0===e?void 0:e.FirstName," ").concat((null===(t=r.User)||void 0===t?void 0:t.LastName)||"undefined")},{heading:"\u0421\u043e\u0437\u0434\u0430\u043d",data:R()(r.CreatingDate).format("DD.MM.YY")},{heading:"\u0412 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u0438",data:R()(r.AcceptanceDate).format("DD.MM.YY")},{heading:"\u0424\u0430\u043a\u0442. \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0430",data:R()(r.ActualShippingDate).format("DD.MM.YY")},{heading:"\u041f\u0440\u043e\u0431\u043b\u0435\u043c\u043a\u0438 \u0441",data:R()((null===(n=r.NeedAttention)||void 0===n?void 0:n.split(",")[1])||null).format("DD.MM.YY hh:mm")}];return Object(p.jsx)(pt,{heading:"\u041e \u0437\u0430\u043a\u0430\u0437\u0435",children:Object(p.jsx)("table",{children:Object(p.jsx)("tbody",{children:a.map((function(e){return e.data&&"Invalid date"!==e.data?Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:e.heading}),Object(p.jsx)("td",{children:e.data})]},"".concat(e.heading," ").concat(e.data)):null}))})})})}(),0!==r.PaymentHistories.length&&r.PaidAmount&&r.TotalAmount?Object(p.jsx)(pt,{className:"noprint",heading:"\u041f\u043b\u0430\u0442\u0435\u0436\u0438",secondaryHeading:"".concat(r.TotalAmount," \u20bd"),children:Object(p.jsx)("table",{className:"paidVisualization",children:Object(p.jsx)("tbody",{children:r.PaymentHistories.map((function(e){return Object(p.jsxs)("tr",{children:[Object(p.jsxs)("td",{children:[(e.PaidAmount/r.TotalAmount*100).toFixed(0)," % "]}),Object(p.jsx)("td",{children:R()(e.Date).format("DD.MM.YY")})]},e.Date)}))})})}):null]})})},ht=n(156),ft=n(372),vt=Object(k.b)(st||(st=Object(w.a)(["\n mutation MyMutation($OrderID: Int!, $fields: erp_Orders_set_input) {\n  update_erp_Orders_by_pk(pk_columns: {OrderID: $OrderID}, _set: $fields) {\n\t\tOrderID\n    Entity\n    City\n    CreatingDate\n  }\n}\n"]))),xt=Object(k.b)(ot||(ot=Object(w.a)(["\n mutation MyMutation($OrderID: Int!, $AwaitingDispatch: Boolean!) {\n  update_erp_Orders_by_pk(\n    pk_columns: {OrderID: $OrderID},\n   _set: { AwaitingDispatch: $AwaitingDispatch }\n  ) {\n\t\tOrderID\n    AwaitingDispatch\n  }\n}\n"]))),gt=Object(k.b)(dt||(dt=Object(w.a)(["\nmutation MyMutation($OrderID: Int!, $NeedAttention: String! ) {\n  update_erp_Orders_by_pk(\n    pk_columns: {OrderID: $OrderID},\n   _set: { NeedAttention: $NeedAttention }\n  ) {\n\t\tOrderID\n    NeedAttention\n  }\n}\n"]))),_t=Object(k.b)(ut||(ut=Object(w.a)(["\n  mutation MyMutation($OrderID: Int!, $ActualShippingDate: timestamp!, $OrderStatusID: Int!) {\n    update_erp_Orders_by_pk(\n      pk_columns: {OrderID: $OrderID}, \n      _set: {\n        OrderStatusID: $OrderStatusID,\n        AwaitingDispatch: false,\n        ActualShippingDate: $ActualShippingDate,\n        }){\n      OrderID\n      OrderStatusID\n    }\n  }\n"]))),It=Object(k.b)(lt||(lt=Object(w.a)(["\n    mutation MyMutation($OrderID: Int!, $AcceptanceDate: timestamp!){\n    update_erp_Orders_by_pk(\n      pk_columns: {OrderID: $OrderID},\n       _set: {\n         OrderStatusID: 2,\n         AcceptanceDate: $AcceptanceDate,\n         }\n      ) {\n        OrderID\n        OrderStatusID\n    }\n  }\n\n"]))),Dt=Object(k.b)(mt||(mt=Object(w.a)(["\n  mutation($PaidAmount: numeric!, $Date: timestamp!, $OrderID: Int!) {\n    insert_erp_PaymentHistory_one(object: {PaidAmount: $PaidAmount, OrderID: $OrderID, Date: $Date}) {\n      ID\n      OrderID\n    }\n}\n"]))),yt=(n(255),["inputRef","onChange"]),Nt=["inputRef","onChange"],Ct={};function wt(e){var t=e.inputRef,n=e.onChange,r=Object(b.a)(e,yt);return Object(p.jsx)(ht.a,Object(d.a)(Object(d.a)({},r),{},{getInputRef:t,onValueChange:function(t){n({target:{name:e.name,value:t.value}})},format:"##.##.##"}))}function kt(e){var t=e.inputRef,n=e.onChange,r=Object(b.a)(e,Nt);return Object(p.jsx)(ht.a,Object(d.a)(Object(d.a)({},r),{},{getInputRef:t,onValueChange:function(t){n({target:{name:e.name,value:t.value}})},prefix:"\u20bd ",thousandSeparator:!0}))}var St,Mt,Tt=function(e){var t=e.data,n=e.orderID,r=e.refetch,s=e.users,o=function(e){return Ct[e.target.name]=e.target.value},l=Object(C.useMutation)(vt),m=Object(u.a)(l,1)[0],b=Object(C.useMutation)(Dt),j=Object(u.a)(b,1)[0];function O(){return(O=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.keys(Ct).length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,m({variables:{OrderID:n,fields:Ct}});case 5:e.sent.data&&x("info","\u0417\u0430\u043a\u0430\u0437 \u043f\u043e\u043f\u0440\u0430\u0432\u043b\u0435\u043d"),Ct.PaidAmount&&j({variables:{Date:new Date,OrderID:n,PaidAmount:Ct.PaidAmount}}),r(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0),x("danger","\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a...",JSON.stringify(e.t0),0);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}return Object(c.useEffect)((function(){return Ct={},function(){!function(){O.apply(this,arguments)}()}}),[]),Object(p.jsx)("form",{className:"EditableInfo",children:Object(p.jsxs)("div",{className:"wrap",children:[Object(p.jsx)(h.a,{label:"\u041f\u043b\u0430\u043d. \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0430",name:"ShippingDate",defaultValue:R()(t.ShippingDate).format("DD.MM.YY"),onChange:function(e){e.target.value=R()(e.target.value,"DD-MM-YY").format("YYYY-MM-DD"),"Invalid date"===e.target.value&&(e.target.value=null),o(e)},placeholder:"dd.mm.yy",InputProps:{inputComponent:wt}}),Object(p.jsx)(h.a,{label:"\u041d\u043e\u043c\u0435\u0440 \u0441\u0447\u0435\u0442\u0430",type:"number",name:"InvoiceNumber",defaultValue:t.InvoiceNumber,onChange:o}),Object(p.jsx)(h.a,{label:"\u041d\u043e\u043c\u0435\u0440 \u0437\u0430\u043a\u0430\u0437\u0430",name:"OrderNumber",defaultValue:t.OrderNumber,onChange:o}),Object(p.jsx)(ft.a,{id:"combo-box-demo",options:s.filter((function(e){return 3!=e.AccessLevelID})),getOptionLabel:function(e){return"".concat(e.FirstName," ").concat(e.LastName)},renderInput:function(e){return Object(p.jsx)(h.a,Object(d.a)(Object(d.a)({},e),{},{label:"\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440"}))},defaultValue:function(){return function(e,t){if(!e)return null;var n=e.indexOf(e.find((function(e){return e.UserID===t})));return e[n]}(s,t.ManagerID)},onChange:function(e,t){Ct.ManagerID=(null===t||void 0===t?void 0:t.UserID)||null}}),Object(p.jsx)(h.a,{label:"\u041a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442",name:"Entity",defaultValue:t.Entity,onChange:o}),Object(p.jsx)(h.a,{label:"\u0413\u043e\u0440\u043e\u0434",name:"City",defaultValue:t.City,onChange:o}),Object(p.jsx)(h.a,{label:"\u0421\u0443\u043c\u043c\u0430 \u0437\u0430\u043a\u0430\u0437\u0430",name:"TotalAmount",defaultValue:t.TotalAmount,onChange:o,InputProps:{inputComponent:kt}}),Object(p.jsx)(h.a,{label:"\u041e\u043f\u043b\u0430\u0447\u0435\u043d\u043e",name:"PaidAmount",defaultValue:t.PaidAmount,onChange:o,InputProps:{inputComponent:kt}}),Object(p.jsx)(h.a,{label:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",multiline:!0,InputProps:{sx:{fontSize:".9rem !important"}},name:"Comment",defaultValue:t.Comment,onChange:o})]})})},At=(Object(k.b)(St||(St=Object(w.a)(["\nmutation MyMutation($objects: [erp_Docs_insert_input!]!) {\n  insert_erp_Docs(objects: $objects) {\n    returning {\n      ID\n    }\n  }\n}\n"]))),Object(k.b)(Mt||(Mt=Object(w.a)(["\n    mutation MyMutation($key: String!) {\n    delete_erp_Docs(where: {Key: {_eq: $key} }) {\n        returning {\n        Key\n        }\n    }\n    }\n"])))),Ft=n(69),$t=n.n(Ft),Lt=n(350),Ut=n(351),Pt=n(352),Et=n(353),Ht=function(e){var t=e.file,n=e.canDelete,r=e.deleteFileCb;return Object(p.jsxs)("div",{className:"".concat($t.a.docsItem," ").concat(!!e.onUpload&&$t.a.docsItemOnUpload),children:[Object(p.jsxs)("a",{href:"".concat("https://factory.piek.ru/api","/s3/").concat(t.Key),target:"_blank",rel:"noreferrer",children:[function(e){var t=e.split(".")[e.split(".").length-1];return["png","jpg","jpeg"].includes(t)?Object(p.jsx)(Lt.a,{className:$t.a.svg}):["pdf","doc","docx"].includes(t)?Object(p.jsx)(Ut.a,{className:$t.a.svg}):Object(p.jsx)(Pt.a,{className:$t.a.svg})}(t.FileName),Object(p.jsx)("div",{className:$t.a.name,children:t.FileName}),Object(p.jsxs)("div",{className:$t.a.date,children:[" ",function(e){if(!e)return"";var t=Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(1)+" "+["B","kB","MB","GB","TB"][t]}(t.Size)," | ",R()(t.UploadingDate).format("D MMMM")]})]}),n&&Object(p.jsxs)(f.a,{variant:"iconic",className:$t.a.deleteBtn,onClick:function(){return r(t)},children:[" ",Object(p.jsx)(Et.a,{})," "]})]})},Rt=n(399);function qt(e){var t=e.filename,n=e.open,r=e.handleClose;e.onConfirmF;return Object(p.jsx)("div",{children:Object(p.jsxs)(Qe.a,{open:n,minWidth:"xs",onClose:r,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(p.jsx)(Ge.a,{children:Object(p.jsxs)(Rt.a,{id:"alert-dialog-description",sx:{color:"var(--lowContrast) !important",span:{color:"var(--highContrast) !important"}},children:["\u0423\u0434\u0430\u043b\u0438\u0442\u044c ",Object(p.jsx)("span",{children:t})," ?"]})}),Object(p.jsxs)(Je.a,{children:[Object(p.jsx)(f.a,{color:"info",onClick:r,children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}),Object(p.jsx)(f.a,{color:"secondary",onClick:function(){r(),e.onConfirmF()},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})]})})}var Bt=n(88),Yt=n(117),Wt=n.n(Yt),zt="https://factory.piek.ru/api",Vt=Wt.a.create({withCredentials:!0,baseURL:zt});Vt.interceptors.request.use((function(e){return e.headers.Authorization="Bearer ".concat(pa()),e}));var Qt=Vt,Kt=function(){function e(){Object(we.a)(this,e)}return Object(Bt.a)(e,null,[{key:"uploadFile",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new FormData,t.map((function(e){return r.append("files",e)})),e.next=4,Qt.put(this.s3_url,r,{headers:{"Content-Type":"multipart/form-data",orderid:n}});case 4:return i=e.sent,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteFile",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qt.delete(this.s3_url+t);case 2:if(200===e.sent.status){e.next=5;break}return e.abrupt("return","server error during delete file");case 5:return e.next=7,n({variables:{key:t}});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();Kt.s3_url="/s3/";var Gt,Jt,Zt,Xt,en,tn,nn=function(e){var t,n=e.data,r=e.onUpload,s=e.editState,o=e.refetch,l=Object(c.useState)(!1),m=Object(u.a)(l,2),b=m[0],j=m[1],O=Object(c.useState)(),h=Object(u.a)(O,2),v=h[0],x=h[1],g="false"!==(t="orderDetailShowDocs","; ".concat(document.cookie).split("; ".concat(t,"=")).pop().split(";").shift()),_=Object(c.useState)(g),I=Object(u.a)(_,2),D=I[0],y=I[1],N=Object(C.useMutation)(At),w=Object(u.a)(N,1)[0],k=function(e){x(e),j(!0)},S=function(){return j(!1)};Object(c.useEffect)((function(){j(!1)}),[s]);var M=function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(),e.next=3,Kt.deleteFile(v.Key,w);case 3:o();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){r.map((function(e){return Object(d.a)(Object(d.a)({},e),{},{FileName:e.name})}))}),[r]),Object(p.jsxs)("div",{className:"Docs",children:[Object(p.jsxs)("div",{className:$t.a.sectionHead,children:[Object(p.jsxs)(he.a,{variant:"subtitle2",children:["\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b [",n.Docs.length,"]"]}),Object(p.jsx)(f.a,{className:$t.a.expandBtn,onClick:function(){!function(e,t){var n=new Date;n.setFullYear(n.getFullYear()+10),document.cookie="".concat(e,"=").concat(t,"; expires=").concat(n,"; path=/")}("orderDetailShowDocs",!D),y(!D)},children:D?"\u0421\u0432\u0435\u0440\u043d\u0443\u0442\u044c":"\u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c"})]}),Object(p.jsxs)("div",{className:"filesContainer",children:[D&&n.Docs.map((function(e){return Object(p.jsx)(Ht,{file:e,canDelete:s,deleteFileCb:k},e.Key)})),!!r.length&&r.map((function(e){return Object(p.jsx)(Ht,{file:Object(d.a)(Object(d.a)({},e),{},{FileName:e.name}),canDelete:s,deleteFileCb:k,onUpload:!0},e.name)}))]}),Object(p.jsx)(qt,{filename:null===v||void 0===v?void 0:v.FileName,open:b,handleClose:S,onConfirmF:M})]})},rn=Object(k.b)(Gt||(Gt=Object(w.a)(["\nmutation($OrderID: Int!, $Text: String!, $UserID: Int!) {\n  insert_erp_Comments_one(\n    object: {OrderID: $OrderID, Text: $Text, UserID: $UserID}) \n    {\n    CommentID\n    OrderID\n    Text\n    Timestamp\n    UserID\n  }\n}\n"]))),an=Object(k.b)(Jt||(Jt=Object(w.a)(["\n mutation($CommentID: Int!) {\n  delete_erp_Comments_by_pk(CommentID: $CommentID) {\n    CommentID\n  }\n}\n"]))),cn=Object(k.b)(Zt||(Zt=Object(w.a)(["\nmutation($CommentID: Int!, $Text: String!) {\n  update_erp_Comments_by_pk(\n    pk_columns: {CommentID: $CommentID},\n    _set: {Text: $Text}) \n    {\n    OrderID\n    Text\n    Timestamp\n    UserID\n    CommentID\n  }\n  }\n"]))),sn=Object(k.b)(Xt||(Xt=Object(w.a)(["\nmutation($CommentID: Int!, $MentionedUser: Int!, $OrderID: Int!){\n  insert_erp_Notifications(objects: \n    { CommentID: $CommentID, MentionedUser: $MentionedUser, OrderID: $OrderID }\n    ){\n    returning {\n      MentionedUser\n      ID\n    }\n  }\n}\n"]))),on=Object(k.a)(en||(en=Object(w.a)(["\n  subscription MySubscritp($OrderID: Int!) {\n    erp_Comments(where: {OrderID: {_eq: $OrderID}}, order_by: {CommentID: desc}) {\n      CommentID\n      Text\n      Timestamp\n      User {\n        UserID\n        FirstName\n        LastName\n      }\n    }\n  }\n"]))),dn=n(36),un=n.n(dn),ln=function(e){var t=e.data,n=e.userID,r=e.updateComment,c=e.deleteComment,s=e.nowEditing,o=e.setNowEditing;return Object(p.jsxs)("div",{className:un.a.commentUnit,children:[Object(p.jsxs)("div",{className:un.a.commentHeader,children:[Object(p.jsxs)("div",{className:un.a.sender,children:[" ","".concat(t.User.FirstName," ").concat(t.User.LastName)," "]}),Object(p.jsx)("div",{className:un.a.actions,children:function(){if(n===t.User.UserID&&(null===s||void 0===s?void 0:s.CommentID)!==t.CommentID)return Object(p.jsx)("div",{onClick:function(){return c(t.CommentID)},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})}()}),Object(p.jsxs)("div",{className:un.a.time,children:[" ",function(){var e=R()(t.Timestamp);return e.format("MMM D")+" at "+e.format("hh:mm")}()," "]})]}),n===t.User.UserID?Object(p.jsx)("div",{contentEditable:"true",className:un.a.commentContent,suppressContentEditableWarning:"true",onBlur:function(){var e=Object(i.a)(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t.CommentID,n.target.innerHTML);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onMouseLeave:function(){var e=Object(i.a)(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t.CommentID,n.target.innerHTML);case 2:o(null);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),dangerouslySetInnerHTML:{__html:t.Text}},t.CommentID):Object(p.jsx)("div",{onClick:function(e){e.currentTarget.innerHTML.toString().includes(un.a.checklistUnit,0)&&r(t.CommentID,e.currentTarget.innerHTML)},dangerouslySetInnerHTML:{__html:t.Text},className:un.a.commentContent})]})},mn=Object(k.a)(tn||(tn=Object(w.a)(["\nquery MyQuery {\n  erp_Users {\n    FirstName\n    LastName\n    UserID\n  }\n}\n\n"]))),bn=n(354),pn=function(e){var t=e.anchorEl,n=e.open,r=e.handleClose,a=e.setAnchorULP,i=e.inputRef;return Object(p.jsxs)(et.a,{id:"Comments__commandMenu","aria-labelledby":"Comments_InputForm",anchorEl:t,open:n,onClose:r,children:[Object(p.jsx)(Z.a,{onClick:function(){r(),function(){var e=document.getElementById("Comments_InputForm"),t=document.createElement("div");t.classList.add(un.a.checklistUnit),e.appendChild(t)}()},children:"\u0427\u0435\u043a\u043b\u0438\u0441\u0442"}),Object(p.jsx)(Z.a,{onClick:function(){r(),a(i.current)},children:"\u0423\u043f\u043e\u043c\u044f\u043d\u0443\u0442\u044c"})]})};var jn,On=function(e){var t=e.anchorEl,n=e.open,r=e.handleClose,a=e.users,i=e.inputRef,c=function(e){r();var t=e.target.getAttribute("userid"),n=a.find((function(e){return e.UserID==t})),c=document.getElementById("Comments_InputForm"),s=document.createElement("span");i.current.innerText=i.current.innerText.slice(0,-1),s.innerHTML="@"+[n.FirstName,n.LastName].join(" ")+", ",s.classList.add(un.a.mentionedUserHiglight),s.dataset.mentionedUser=n.UserID,s.contentEditable="false",c.appendChild(s),function(e){if(e.focus(),"undefined"!=typeof window.getSelection&&"undefined"!=typeof document.createRange){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}else if("undefined"!=typeof document.body.createTextRange){var r=document.body.createTextRange();r.moveToElementText(e),r.collapse(!1),r.select()}}(c);var o=document.createElement("span");c.appendChild(o)};return Object(p.jsx)(et.a,{id:"Comments__userListMenu","aria-labelledby":"Comments_InputForm",anchorEl:t,open:n,onClose:r,children:a&&a.map((function(e){return Object(p.jsxs)(Z.a,{sx:{padding:"4px 10px"},userid:e.UserID,onClick:c,children:[e.FirstName," ",e.LastName]},e.UserID)}))})},hn=function(e){var t=e.insertComment,n=e.inputRef,r=Object(C.useQuery)(mn).data,a=void 0===r?[]:r,i=Object(c.useState)(null),s=Object(u.a)(i,2),o=s[0],d=s[1],l=Object(c.useState)(null),m=Object(u.a)(l,2),b=m[0],j=m[1];return Object(p.jsxs)("div",{className:"".concat(un.a.commentInputForm," noprint"),children:[Object(p.jsx)(pn,{setAnchorULP:j,anchorEl:o,open:Boolean(o),handleClose:function(){d(null)},inputRef:n}),Object(p.jsx)(On,{anchorEl:b,open:Boolean(b),handleClose:function(){j(null)},users:a.erp_Users,inputRef:n}),Object(p.jsx)($.a,{id:"Comments_InputForm","aria-controls":"Comments__commandMenu","aria-haspopup":"true",contentEditable:"true",ref:n,sx:{minHeight:20,padding:"10px 5px"},"data-ph":"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439 \u0438\u043b\u0438 ' / ' \u0434\u043b\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u044b",suppressContentEditableWarning:!0,onInput:function(e){"/"===e.target.innerText.trim()&&(d(e.target),e.target.innerHTML=""),"@"===e.target.innerText.trim()&&j(e.target)},onKeyUp:function(e){!e.ctrlKey&&!e.metaKey||13!==e.keyCode&&10!==e.keyCode||t()}}),Object(p.jsx)("div",{onClick:t,className:un.a.saveButton,children:Object(p.jsx)(bn.a,{})})]})},fn=function(e){var t,n,r=e.orderID,a=e.user,i=Object(C.useMutation)(rn),s=Object(u.a)(i,1)[0],o=Object(C.useMutation)(cn),d=Object(u.a)(o,1)[0],l=Object(C.useMutation)(an),m=Object(u.a)(l,1)[0],b=Object(C.useMutation)(sn),j=Object(u.a)(b,1)[0],O=Object(c.useRef)(),h=Object(c.useState)(),f=Object(u.a)(h,2),v=f[0],x=f[1],g=Object(C.useSubscription)(on,{variables:{OrderID:r}}),_=g.data,I=void 0===_?[]:_,D=g.loading;function y(e,t){d({variables:{CommentID:e,Text:t}})}function N(e){m({variables:{CommentID:e}})}function w(e){e.target.classList.toggle(un.a.checklistUnit_complited)}Object(c.useEffect)((function(){var e=Object(P.a)(document.querySelectorAll("div.".concat(un.a.commentUnit," div.").concat(un.a.checklistUnit)));return e.forEach((function(e){e.addEventListener("click",w,!1)}),{once:!0}),function(){e.forEach((function(e){e.removeEventListener("click",w,!1)}))}}),[I]);var k=(null===I||void 0===I||null===(t=I.erp_Comments)||void 0===t?void 0:t.length)?un.a.commentListThread:"";return Object(p.jsxs)("div",{className:"".concat(un.a.commentsListWrapper," ").concat(k),children:[Object(p.jsx)(hn,{insertComment:function(){var e=O.current.innerHTML;if(!e)return null;var t=document.getElementById("Comments_InputForm").querySelectorAll(".".concat(un.a.mentionedUserHiglight));s({variables:{OrderID:r,UserID:a.UserID,Text:e}}).then((function(e){var n=e.data.insert_erp_Comments_one,r=n.CommentID,a=n.OrderID;t.forEach((function(e){var t=e.dataset.mentionedUser;j({variables:{CommentID:r,OrderID:a,MentionedUser:t}})}))})),O.current.innerText=""},inputRef:O}),D?Object(p.jsx)(he.a,{m:"10px",variant:"subtitle2",children:"\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430.."}):null===I||void 0===I||null===(n=I.erp_Comments)||void 0===n?void 0:n.map((function(e){return Object(p.jsx)(ln,{data:e,userID:a.UserID,deleteComment:N,updateComment:y,nowEditing:v,setNowEditing:x},e.CommentID)}))]})},vn=n(104),xn=n.n(vn),gn=Object(k.b)(jn||(jn=Object(w.a)(["\nmutation MyMutation($OrderID: Int!) {\n  delete_erp_Orders_by_pk(OrderID: $OrderID) {\n    OrderID\n  }\n}\n"]))),_n=function e(){Object(we.a)(this,e)};_n.general=1,_n.management=2,_n.bookkeeping=4,_n.manufacture=3;var In=n(357),Dn=n(358),yn=n(359),Nn=n(360),Cn=n(361),wn=n(362);function kn(e){var t=e.confirmLabel,n=e.onCloseComplete,r=e.isDangerous,a=e.title,i=e.body,s=e.children,o=Object(c.useState)(!1),d=Object(u.a)(o,2),l=d[0],m=d[1],b=function(){m(!1)};return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)("div",{onClick:function(){m(!0)},children:[" ",s," "]}),Object(p.jsxs)(Qe.a,{id:a,open:l,maxWidth:"xs",onClose:b,children:[Object(p.jsxs)(Ke.a,{children:[" ",a," "]}),Object(p.jsx)(Ge.a,{children:Object(p.jsx)(Rt.a,{p:1,children:i})}),Object(p.jsxs)(Je.a,{children:[Object(p.jsx)(f.a,{color:"info",onClick:function(){return b()},children:"\u041e\u0442\u043c\u0435\u043d\u0430"},"dialog-close-btn"),Object(p.jsx)(f.a,{color:r?"secondary":"primary",onClick:function(){b(),n()},children:t},"dialog-target-btn")]})]})]})}var Sn=["handler"];function Mn(e){var t=e.handler,n=Object(b.a)(e,Sn);return Object(p.jsx)(kn,Object(d.a)(Object(d.a)({},n),{},{title:"\u041f\u0435\u0440\u0435\u043d\u0435\u0441\u0442\u0438 \u0432 \u0430\u0440\u0445\u0438\u0432?",body:"\u0417\u0430\u043a\u0430\u0437 \u0443\u0434\u0430\u043b\u0438\u0442\u0441\u044f \u0438\u0437 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u0438, \u043d\u043e \u0435\u0433\u043e \u0432 \u043b\u044e\u0431\u043e\u0435 \u0432\u0440\u0435\u043c\u044f \u043c\u043e\u0436\u043d\u043e \u0431\u0443\u0434\u0435\u0442 \u043d\u0430\u0439\u0442\u0438 \u0432 \u0430\u0440\u0445\u0438\u0432\u0435 \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 \u0441\u0447\u0435\u0442\u0430, \u044e\u0440\u043b\u0438\u0446\u0443, \u043c\u0430\u0440\u043a\u0438\u0440\u043e\u0432\u043a\u0435 \u043f\u0440\u0438\u0432\u043e\u0434\u0430.",onCloseComplete:t,confirmLabel:"\u041f\u0435\u0440\u0435\u043d\u0435\u0441\u0442\u0438"}))}var Tn=["handler"];function An(e){var t=e.handler,n=Object(b.a)(e,Tn);return Object(p.jsx)(kn,Object(d.a)(Object(d.a)({},n),{},{isDangerous:!0,title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437?",body:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u0430 / \u0440\u0435\u043a\u043b\u0430\u043c\u0430\u0446\u0438\u0438 \u043d\u0435\u043e\u0431\u0440\u0430\u0442\u0438\u043c\u043e.",onCloseComplete:t,confirmLabel:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"}))}var Fn=n(355),$n=n(356),Ln=function(e){var t,n=e.order,r=e.renderAlg,a=Object(C.useMutation)(xt),i=Object(u.a)(a,1)[0],c=Object(C.useMutation)(gt),s=Object(u.a)(c,1)[0];var o="true"===(null===(t=n.NeedAttention)||void 0===t?void 0:t.split(",")[0]);return r([{tip:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u044f",handler:function(){var e=(new Date).toISOString(),t=[];if(n.NeedAttention){var r=n.NeedAttention.split(",");"true"===r[0]&&(t=["false",r[1],e]),"false"===r[0]&&(t=["true",e,"null"])}else t=["true",e,"null"];s({variables:{OrderID:n.OrderID,NeedAttention:t.join(",")}})},icon:Fn.a,className:o?"iconBtnPressed":"",requirement:![ke.ordArchived,ke.reclArchived].includes(n.OrderStatusID)},{tip:"\u0413\u043e\u0442\u043e\u0432 \u043a \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0435",handler:function(){i({variables:{OrderID:n.OrderID,AwaitingDispatch:!n.AwaitingDispatch},optimisticResponse:{erp_Orders:Object(d.a)(Object(d.a)({__typename:"erp_Orders"},n),{},{AwaitingDispatch:!n.AwaitingDispatch})}})},icon:$n.a,className:n.AwaitingDispatch?"iconBtnPressed":"",requirement:[ke.ordProduction,ke.reclProduction].includes(n.OrderStatusID)}])};function Un(e){var t=e.map((function(e){if(e.requirement||void 0===e.requirement){var t=Object(p.jsx)(f.a,{variant:"iconic","data-tip":e.tip,onClick:e.handler,className:e.className,children:Object(p.jsx)(e.icon,{})},e.tip);return e.dialog?Object(p.jsxs)(e.dialog,{handler:e.dialogHandler,children:[" ",t," "]},e):t}}));return t.filter((function(e){return e})).length?Object(p.jsx)($.a,{className:xn.a.groupOrderButtons,children:t.filter((function(e){return e}))}):null}var Pn=function(e){var t=e.order,n=e.editState,r=e.setEditState,s=e.setOIDialog,o=t.OrderID,d=Object(c.useContext)(ba).store,l=[_n.general,_n.management,_n.bookkeeping].includes(d.user.AccessLevelID),b=Object(C.useMutation)(_t),j=Object(u.a)(b,1)[0],O=Object(C.useMutation)(It),h=Object(u.a)(O,1)[0],f=Object(C.useMutation)(gn),v=Object(u.a)(f,1)[0],g=Object(m.g)();function _(e){return I.apply(this,arguments)}function I(){return(I=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j({variables:{OrderID:o,ActualShippingDate:new Date,OrderStatusID:t}}).then((function(e){e.data.update_erp_Orders_by_pk.OrderID&&x("success","\u0417\u0430\u043a\u0430\u0437 \u043f\u0435\u0440\u0435\u043d\u0435\u0441\u0435\u043d \u0432 \u0430\u0440\u0445\u0438\u0432")}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h({variables:{OrderID:o,AcceptanceDate:new Date}});case 2:e.sent.data.update_erp_Orders_by_pk.OrderID&&x("success","\u0417\u0430\u043a\u0430\u0437 \u0432\u043d\u0435\u0441\u0435\u043d \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=[{tip:"\u0412 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u044c",handler:function(){return D.apply(this,arguments)},icon:In.a,requirement:l&&[ke.ordRegistration].includes(t.OrderStatusID)},{dialog:Mn,dialogHandler:function(){return _(3)},tip:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0437\u0430\u043a\u0430\u0437",icon:Dn.a,requirement:[ke.ordProduction].includes(t.OrderStatusID)},{dialog:Mn,dialogHandler:function(){return _(13)},tip:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0440\u0435\u043a\u043b\u0430\u043c\u0430\u0446\u0438\u044e",icon:Dn.a,requirement:[ke.reclProduction].includes(t.OrderStatusID)},{dialog:An,dialogHandler:function(){v({variables:{OrderID:o}}).then((function(e){e.data.delete_erp_Orders_by_pk.OrderID&&g.push([1,2].includes(t.OrderStatusID)?"/":[10,11,12].includes(t.OrderStatusID)?"/reclamation":void 0)}))},tip:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437",icon:yn.a,requirement:l&&[ke.ordRegistration,ke.ordProduction,ke.reclInbox,ke.reclDecision,ke.reclInbox].includes(t.OrderStatusID)},{tip:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0437\u0438\u0446\u0438\u044e",handler:function(){return s(!0)},icon:Nn.a,requirement:l&&![ke.ordArchived,ke.reclArchived].includes(t.OrderStatusID)},{tip:"\u041f\u043e\u043c\u0435\u043d\u044f\u0442\u044c \u0447\u0442\u043e-\u0442\u043e",handler:function(){return r(!n)},icon:n?Cn.a:wn.a,requirement:l}];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(Ln,{order:t,renderAlg:Un}),Un(y)]})};function En(e){return e.OrderStatusID===ke.ordRegistration?" \u041f\u0440\u0435\u0434\u0437\u0430\u043a\u0430\u0437":e.OrderStatusID===ke.ordArchived?" \u0412 \u0430\u0440\u0445\u0438\u0432\u0435":[ke.reclInbox,ke.reclDecision,ke.reclProduction,ke.reclArchived].includes(e.OrderStatusID)?" \u0420\u0435\u043a\u043b\u0430\u043c\u0430\u0446\u0438\u044f":void 0}function Hn(e){var t;return"true"===(null===(t=e.NeedAttention)||void 0===t?void 0:t.split(",")[0])?xn.a.needAttention:e.AwaitingDispatch?xn.a.awaitingDispatch:""}var Rn,qn,Bn,Yn=function(e){var t=e.data,n=e.editState,r=e.setEditState,a=e.setOIDialog;e.refetch;return Object(p.jsxs)("div",{className:"page-header ".concat(Hn(t)),children:[Object(p.jsxs)(he.a,{sx:{fontWeight:600,fontSize:"1rem"},children:[t.Entity," __ ",t.City,En(t)?Object(p.jsx)("span",{className:"preorderTitle",children:En(t)}):null]}),Object(p.jsx)($.a,{className:"".concat(xn.a.orderActionsRow," noprint"),children:Object(p.jsx)(Pn,{order:t,editState:n,setEditState:r,setOIDialog:a})})]})},Wn=n(363),zn=function(e){var t,n=document.getElementById("dropzone");if(e)return n.classList.add("isDragAccept"),Object(p.jsx)("div",{children:Object(p.jsx)(Wn.a,{className:"inCloudconIcon"})});null===n||void 0===n||null===(t=n.classList)||void 0===t||t.remove("isDragAccept")},Vn=n(133),Qn=(n(274),function(e){var t=Object(c.useContext)(ba).store,n=Object(c.useState)([]),r=Object(u.a)(n,2),s=r[0],o=r[1];Object(c.useEffect)((function(){Vn.a.rebuild()}));var l=new URLSearchParams(Object(m.h)().search).get("edit"),b=Object(c.useState)(l),j=Object(u.a)(b,2),O=j[0],h=j[1],f=Object(c.useState)(!1),v=Object(u.a)(f,2),x=v[0],g=v[1],_=Object(m.i)().id,I=Object(c.useCallback)(function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(t),e.next=3,Kt.uploadFile(t,_);case 3:200===(n=e.sent).status||console.log("S3 file upload error",n),w(),o([]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),D=Object(C.useQuery)(Be,{variables:{OrderID:_}}),y=D.data,N=void 0===y?[]:y,w=D.refetch,k=Object(C.useQuery)(M).data,S=void 0===k?[]:k,T=Object(qe.a)({className:"dropzone",onDrop:I}),A=T.getRootProps,F=T.isDragActive;if(!N.erp_Orders)return Object(p.jsx)(p.Fragment,{});var $={editState:O,store:t,refetch:w,orderID:_,data:N.erp_Orders[0]};return Object(p.jsxs)("div",{children:[zn(F),N.erp_Orders&&S.erp_Users?Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("section",Object(d.a)(Object(d.a)({className:"OrderLayout"},A()),{},{id:"dropzone",children:[Object(p.jsxs)("div",{className:"LeftSideContent",children:[Object(p.jsx)(Yn,Object(d.a)(Object(d.a)({},$),{},{setEditState:h,setOIDialog:g})),Object(p.jsx)(bt,Object(d.a)(Object(d.a)({},$),{},{OIDialog:x,setOIDialog:g})),Object(p.jsx)(fn,Object(d.a)(Object(d.a)({},$),{},{user:t.user})),Object(p.jsx)(nn,Object(d.a)(Object(d.a)({},$),{},{onUpload:s}))]}),Object(p.jsx)("div",{className:"Info",children:O?Object(p.jsx)(Tt,Object(d.a)(Object(d.a)({},$),{},{users:S.erp_Users})):Object(p.jsx)(Ot,Object(d.a)({},$))})]}))}):null]})}),Kn=n(64),Gn=n.n(Kn),Jn=n(364),Zn=n(139),Xn={inbox:[],decision:[],inproduction:[]};function er(e,t){switch(t.type){case"inbox":case"decision":case"inproduction":return Object(d.a)(Object(d.a)({},e),{},Object(_.a)({},t.type,t.payload));case"reset":return Xn;default:return Object(d.a)({},e)}}var tr=Object(k.a)(Rn||(Rn=Object(w.a)(["\nsubscription{\n    erp_Orders(where: {OrderStatusID: {_in: [10,11,12]} }) {\n      AwaitingDispatch\n      NeedAttention\n      OrderID\n      Entity\n      City\n      OrderStatusID\n      OrderItems(order_by: {OrderItemID: asc}){\n        OrderItemID\n        Name\n      }   \n    }  \n  }\n"]))),nr=Object(k.a)(qn||(qn=Object(w.a)(["\n    mutation MyMutation($OrderID: Int!, $OrderStatusID: Int!){\n    update_erp_Orders_by_pk(\n      pk_columns: {OrderID: $OrderID},\n       _set: {\n         OrderStatusID: $OrderStatusID,\n         }\n      ) {\n        OrderID\n        OrderStatusID\n    }\n  }\n\n"]))),rr=Object(k.a)(Bn||(Bn=Object(w.a)(["\nmutation MyMutation($managerID: Int, $orderStatusID: Int!) {\n  insert_erp_Orders(objects: {ManagerID: $managerID, OrderStatusID:  $orderStatusID}) {\n    returning {\n      OrderID\n    }\n  }\n}\n"]))),ar=function(e){var t=Object(c.useReducer)(er,Xn),n=Object(u.a)(t,2),r=n[0],a=n[1],i=r.inbox,s=r.decision,o=r.inproduction,l=Object(m.g)(),b=function(e){return"inbox"===e?i:"decision"===e?s:"inproduction"===e?o:void 0},j=[{columnName:"\u0412\u0445\u043e\u0434\u044f\u0449\u0438\u0435",droppableId:"inbox",data:i,orderStatusID:10},{columnName:"\u041f\u0440\u0438\u043d\u044f\u0442\u0438\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u044f",droppableId:"decision",data:s,orderStatusID:11},{columnName:"\u0412 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0441\u0442\u0432\u0435",droppableId:"inproduction",data:o,orderStatusID:12}],O=Object(C.useMutation)(nr),h=Object(u.a)(O,1)[0],v=Object(C.useMutation)(rr,{variables:{orderStatusID:j[0].orderStatusID}}),x=Object(u.a)(v,1)[0];Object(C.useSubscription)(tr,{onSubscriptionData:function(e){var t=e.subscriptionData.data.erp_Orders;t.map((function(e){return e.id=e.OrderID.toString(),e})),j.forEach((function(e){a({type:e.droppableId,payload:t.filter((function(t){return t.OrderStatusID===e.orderStatusID}))})}))}});function g(e){return e.NeedAttention&&"true"===e.NeedAttention.split(",")[0]?Gn.a.needAttention:e.AwaitingDispatch?Gn.a.awaitingDispatch:void 0}return Object(p.jsxs)("div",{className:Gn.a.reclatationLayout,children:[Object(p.jsxs)("div",{className:"pageLayout__header",children:[Object(p.jsx)(Jn.a,{className:"pageLayout__icon"}),Object(p.jsx)("div",{className:"pageLayout__title",children:"\u0420\u0435\u043a\u043b\u0430\u043c\u0430\u0446\u0438\u044f"}),Object(p.jsx)("div",{className:"pageLayout__actions",children:Object(p.jsx)(f.a,{variant:"iconic",onClick:function(){x().then((function(e){l.push("/orders/".concat(e.data.insert_erp_Orders.returning[0].OrderID,"?edit=true"))}))},children:Object(p.jsx)(U.a,{})})})]}),Object(p.jsx)(Zn.a,{onDragEnd:function(e){var t=e.source,n=e.destination;if(n)if(t.droppableId===n.droppableId){var r=function(e,t,n){var r=Array.from(e),a=r.splice(t,1),i=Object(u.a)(a,1)[0];return r.splice(n,0,i),r}(b(t.droppableId),t.index,n.index);a({type:t.droppableId,payload:r})}else{var i=function(e,t,n,r){var a=Array.from(e),i=Array.from(t),c=a.splice(n.index,1),s=Object(u.a)(c,1)[0];i.splice(r.index,0,s);var o={};return o[n.droppableId]=a,o[r.droppableId]=i,{result:o,movedObj:s}}(b(t.droppableId),b(n.droppableId),t,n),c=i.result,s=i.movedObj;Object.entries(c).map((function(e){e[0]===e[0]&&a({type:e[0],payload:e[1]})})),h({variables:{OrderID:s.OrderID,OrderStatusID:j.find((function(e){return e.droppableId===n.droppableId})).orderStatusID}})}},children:Object(p.jsx)($.a,{className:Gn.a.columnWrapper,children:j.map((function(e){return Object(p.jsxs)("div",{className:Gn.a.reclColumn,children:[Object(p.jsx)(he.a,{className:Gn.a.heading,children:e.columnName}),Object(p.jsx)(Zn.c,{droppableId:e.droppableId,children:function(t,n){return Object(p.jsxs)("div",{ref:t.innerRef,className:Gn.a.draggableWrapper,children:[e.data.map((function(e,t){return Object(p.jsx)(Zn.b,{draggableId:e.id,index:t,children:function(t,n){return Object(p.jsx)("div",Object(d.a)(Object(d.a)(Object(d.a)({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{style:(a=n.isDragging,i=t.draggableProps.style,Object(d.a)({userSelect:"none",background:a?"var(--accentLight)":"transparent"},i)),children:(r=e,0===r.OrderItems.length?Object(p.jsx)(E.b,{to:"/orders/".concat(r.OrderID),className:Gn.a.item,children:Object(p.jsx)("div",{children:"\u041d\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e"})}):Object(p.jsxs)(E.b,{to:"/orders/".concat(r.OrderID),className:"".concat(Gn.a.item," ").concat(g(r)),children:[Object(p.jsx)("div",{className:Gn.a.items,children:r.OrderItems.map((function(e){return Object(p.jsx)("div",{className:Gn.a.orderItem,children:e.Name},e.OrderItemID)}))}),Object(p.jsxs)("div",{className:Gn.a.customerInfo,children:[Object(p.jsx)("div",{children:r.Entity}),Object(p.jsx)("div",{children:r.City})]})]}))}));var r,a,i}},e.id)})),t.placeholder]})}})]},e.columnName)}))})})]})},ir=n(194),cr="dark";var sr=function(e,t){var n=Object(ir.useMediaQuery)({query:"(prefers-color-scheme: dark)"},void 0),r=e;return Object(c.useEffect)((function(){"dark"===e?document.documentElement.classList.add(cr):"light"===e?document.documentElement.classList.remove(cr):"system"===e&&(n?document.documentElement.classList.add(cr):document.documentElement.classList.remove(cr))}),[e,n]),"system"===e&&(r=n?"dark":"light"),{appTheme:e,mode:r,changeTheme:function(e){var n=new Date;n.setFullYear(n.getFullYear()+1),document.cookie="theme=".concat(e,"; expires=").concat(n,"; path=/"),t(e)}}},or=n(137),dr=n.n(or),ur=function(e){var t=Object(c.useContext)(ba).store,n=sr(t.UItheme.state,t.UItheme.dispatch).changeTheme,r=Object(m.g)();function s(){return(s=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.logout();case 2:r.push("/login");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var o=function(e){return Object(p.jsxs)(Se.a,Object(d.a)(Object(d.a)({},e),{},{className:dr.a.gridCard,children:[Object(p.jsx)(he.a,{variant:"h6",children:e.title}),e.children]}))};return Object(p.jsxs)("div",{className:dr.a.grid,children:[Object(p.jsxs)(o,{title:"\u0410\u043a\u043a\u0430\u0443\u043d\u0442",children:[Object(p.jsxs)("div",{children:[" ",t.user.FirstName," ",t.user.LastName]}),Object(p.jsxs)("div",{children:[" \u0423\u0440\u043e\u0432\u0435\u043d\u044c \u0434\u043e\u0441\u0442\u0443\u043f\u0430: ",t.user.AccessLevelID]}),Object(p.jsxs)("div",{children:[" Email: ",t.user.Email]}),Object(p.jsx)(f.a,{variant:"text",onClick:function(){return s.apply(this,arguments)},children:"\u0412\u044b\u0439\u0442\u0438"})]}),Object(p.jsx)(o,{title:"\u041f\u0440\u0435\u0434\u043f\u043e\u0447\u0442\u0438\u0442\u0430\u0435\u043c\u0430\u044f \u0442\u0435\u043c\u0430",children:Object(p.jsx)("div",{className:dr.a.selectThemeWrapper,children:[{title:"\u0421\u0432\u0435\u0442\u043b\u0430\u044f",value:"light"},{title:"\u041a\u0430\u043a \u043d\u0430 \u0443\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0435",value:"system"},{title:"\u0422\u0435\u043c\u043d\u0430\u044f",value:"dark"}].map((function(e){return Object(p.jsxs)(f.a,{variant:"text",onClick:function(){return n(e.value)},children:[" ",e.title," "]})}))})}),Object(p.jsx)(o,{title:"\u0418\u0441\u0442\u043e\u0447\u043d\u0438\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445",children:Object(p.jsxs)("div",{children:["gql_endpoint: ","hasura.piek.ru/v1/graphql"]})})]})};function lr(e){var t=Math.floor(e),n=e-t,r=1/60;n=r*Math.round(n/r);var a=Math.floor(60*n)+"";return a.length<2&&(a="0"+a),t+":"+a}function mr(e,t){var n=e;return(n=new Date(e.getFullYear(),e.getMonth(),1)).setMonth(n.getMonth()+(t+1)),n.setDate(n.getDate()-1),e.getDate()<n.getDate()&&n.setDate(e.getDate()),n}function br(e,t){if(!e||!t)return"";var n=R()(e,"YYYY-MM-DDTHH:mm"),r=R()(t,"YYYY-MM-DDTHH:mm"),a=R.a.duration(n.diff(r));return Math.abs(a.asSeconds())}function pr(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];return new Date(r,n+1,0).getDate()}function jr(e){return e/3600}var Or=n(90),hr=n.n(Or);function fr(e,t){var n=t.timeDeduction,r=e.column.Header,a=e.row.original.intervals.filter((function(e){return new Date(e.ent).getDate()==r}));if(0===a.length)return Object(p.jsx)("div",{});var i=R()(a[0].ent,"YYYY-MM-DDTHH:mm").format("HH:mm"),c=R()(a[0].ext,"YYYY-MM-DDTHH:mm").format("HH:mm"),s=br(a[0].ent,a[0].ext);if("Invalid date"===c&&(c=""),a.length>=2){var o=1;a.forEach((function(e){a[a.length-o].ext?c=R()(a[a.length-o].ext,"YYYY-MM-DDTHH:mm").format("HH:mm"):o++})),a.forEach((function(e){return s+=br(e.ent,e.ext)}))}return Object(p.jsxs)("div",{className:hr.a.intervalgrid,children:[Object(p.jsx)("div",{children:i}),Object(p.jsx)("div",{children:c}),c?Object(p.jsx)("div",{className:hr.a.interval,children:lr(s/3600-n/60)}):Object(p.jsx)("div",{className:"".concat(hr.a.interval," ").concat(hr.a.intervalred),children:"4:00"})]})}function vr(e,t){for(var n={selectedMonth:e,timeDeduction:t},r=[{Header:"\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a",accessor:function(e){return Object(p.jsxs)("div",{children:[Object(p.jsxs)("span",{children:[e.lastname," "]}),Object(p.jsxs)("span",{children:[e.firstname," "]})]})}},{Header:"\u0418\u0442\u043e\u0433\u043e",Cell:function(e){return function(e,t){for(var n=t.timeDeduction,r=t.selectedMonth,a=0,i=0,c=1;c<=pr(r);c++){var s,o=e.row.original.intervals.filter((function(e){return new Date(e.ent).getDate()==c}));for(var d in o){var u=o[d],l=parseFloat(br(u.ent,u.ext));l&&(a+=l)}o.length>0&&(a-=60*n,null==(null===(s=o[0])||void 0===s?void 0:s.ext)&&(i+=14400))}return a=jr(a),i=a+jr(i),a?Object(p.jsxs)("div",{children:[a.toFixed(0)," ",function(){if(i!==a)return Object(p.jsx)("div",{className:hr.a.intervalred,children:i.toFixed(0)})}()]}):""}(e,n)}}],a=1;a<=pr(e);a++)r.push({Header:a.toString(),Cell:function(e){return fr(e,n)}});return r}function xr(e){var t=e.columns,n=e.data,r=e.className,a=Object(W.useTable)({columns:t,data:n}),i=a.getTableProps,c=a.getTableBodyProps,s=a.headerGroups,o=a.rows,u=a.prepareRow;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("table",Object(d.a)(Object(d.a)({className:r},i()),{},{children:[Object(p.jsx)("thead",{children:s.map((function(e,t){return Object(p.jsx)("tr",Object(d.a)(Object(d.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e,t){return Object(p.jsx)("th",Object(d.a)(Object(d.a)({},e.getHeaderProps()),{},{children:e.render("Header")}))}))}),t)}))}),Object(p.jsx)("tbody",Object(d.a)(Object(d.a)({},c()),{},{children:o.map((function(e,t){return u(e),Object(p.jsx)("tr",Object(d.a)(Object(d.a)({},e.getRowProps()),{},{children:e.cells.map((function(e,t){return Object(p.jsx)("td",Object(d.a)(Object(d.a)({},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]}))})}n(275);var gr,_r,Ir=Object(k.a)(gr||(gr=Object(w.a)(["\nmutation MyMutation( $TimeDeduction: numeric!, $ID: Int! ) {\n    update_attendance_config_by_pk(pk_columns: {ID: $ID}, _set: {TimeDeduction: $TimeDeduction}) {\n      TimeDeduction\n      ID\n    }\n}\n"]))),Dr=["\u044f\u043d\u0432","\u0444\u0435\u0432","\u043c\u0430\u0440","\u0430\u043f\u0440","\u043c\u0430\u0439","\u0438\u044e\u043d","\u0438\u044e\u043b","\u0430\u0432\u0433","\u0441\u0435\u043d","\u043e\u043a\u0442","\u043d\u043e\u044f","\u0434\u0435\u043a"],yr=function(e){var t=e.state,n=e.dispatch,r=Object(C.useMutation)(Ir),s=Object(u.a)(r,1)[0],o=Object(c.useRef)(),d=new Date,l=function(e){var t=new Date(e.target.attributes.date.value);n({type:"intervals",payload:[]}),n({type:"selectedMonth",payload:[t.getMonth(),t.getFullYear()]})};function m(){return(m=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={ID:1,TimeDeduction:parseInt(o.current.value)},e.next=3,s({variables:t});case 3:e.sent.data.update_attendance_config_by_pk&&(x("info","\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e"),n({type:"timeDeduction",payload:o.current.value}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(p.jsxs)("div",{className:"reportConfigurator",children:[function(){for(var e=[],n=0;n<9;){var r=mr(d,-n);e.push(Object(p.jsx)("div",{onClick:l,className:r.getMonth()===t.selectedMonth[0]?"active":"",date:r,children:Dr[r.getMonth()]},r)),n++}return Object(p.jsx)("div",{className:"chooseMonth",children:e})}(),Object(p.jsxs)("div",{className:"arguments",children:[Object(p.jsxs)("div",{className:"wrap",children:[Object(p.jsx)("span",{children:"\u043e\u0431\u0435\u0434, \u043c\u0438\u043d"}),Object(p.jsx)("input",{type:"number",defaultValue:t.timeDeduction,ref:o})]}),Object(p.jsx)(f.a,{onClick:function(){return m.apply(this,arguments)},variant:"outlined",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})},Nr=n(365);function Cr(e,t){switch(t.type){case"intervals":case"selectedMonth":case"timeDeduction":case"s_keyword":return Object(d.a)(Object(d.a)({},e),{},Object(_.a)({},t.type,t.payload));default:throw new Error}}var wr,kr,Sr=Object(k.a)(_r||(_r=Object(w.a)(["\nquery MyQuery($gte: timestamp!, $lte: timestamp!) {\n  attendance_users_aggregate(\n    order_by: {lastname: asc}\n    ){\n    nodes {\n      id\n      card\n      firstname\n      lastname\n      intervals(where: {ent: {_gte: $gte,  _lte: $lte}}) {\n        id \n        ent\n        ext\n        card\n      }\n    }\n  }\n  attendance_config {\n    TimeDeduction\n  }\n}  \n"]))),Mr=function(e){var t=mr(new Date,-1),n=Object(c.useReducer)(Cr,function(e){return{intervals:[],timeDeduction:null,selectedMonth:[e.getMonth(),e.getFullYear()],s_keyword:""}}(t)),r=Object(u.a)(n,2),a=r[0],i=r[1];var s=function(e){var t=Object(u.a)(e,2),n=t[0],r=t[1],a=(parseInt(n)+1).toString().replace(/(^|\D)(\d)(?!\d)/g,"$10$2");return{gte:r+"-"+a+"-01T00:00:00",lte:r+"-"+a+"-"+pr(e)+"T23:59:59"}}(a.selectedMonth),o=s.gte,d=s.lte,l=Object(C.useQuery)(Sr,{variables:{gte:o,lte:d},fetchPolicy:"no-cache",onCompleted:function(e){i({type:"timeDeduction",payload:e.attendance_config[0].TimeDeduction});var t=e.attendance_users_aggregate.nodes.filter((function(e){return e.intervals.length}));i({type:"intervals",payload:t})}}),m=l.loading,b=l.data,j=Object(c.useMemo)((function(){return vr(a.selectedMonth,a.timeDeduction)}),[a.selectedMonth,a.timeDeduction]),O=Object(p.jsx)(yr,{data:b,state:a,dispatch:i}),h=Object(p.jsxs)("div",{className:"pageLayout__header",children:[Object(p.jsx)(Nr.a,{className:"pageLayout__icon"}),Object(p.jsx)("div",{className:"pageLayout__title",children:" \u0420\u0430\u0431\u043e\u0447\u0435\u0435 \u0432\u0440\u0435\u043c\u044f "})]});return Object(p.jsxs)(p.Fragment,{children:[h,O,!m&&a.intervals.length?Object(p.jsx)(xr,{columns:j,data:a.intervals,className:hr.a.attendanceTable}):Object(p.jsx)(he.a,{m:"10px",variant:"subtitle2",children:"\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430.."})]})},Tr=function(){return Object(p.jsxs)(m.d,{children:[Object(p.jsx)(m.b,{path:"/login",component:g}),Object(p.jsx)(O,{exact:!0,path:"/",component:Re}),Object(p.jsx)(O,{path:"/attendance",component:Mr}),Object(p.jsx)(O,{path:"/reclamation",component:ar}),Object(p.jsx)(O,{path:"/settings",component:ur}),Object(p.jsx)(O,{path:"/orders/:id",component:Qn}),Object(p.jsx)(m.a,{to:"/"})]})},Ar=function(e){return Object(p.jsxs)("div",{className:"base-container",children:[Object(p.jsx)(Tr,{}),e.children]})},Fr=(n(276),n(371)),$r=n(370),Lr=n(383),Ur=function(e){var t=e.icon,n=e.children,r=e.width,a=void 0===r?400:r,i=e.state,c=e.toggleDrawer;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{onClick:c(!0),children:t}),Object(p.jsx)(Lr.a,{open:i,PaperProps:{sx:{backgroundColor:"var(--L0-glass)",backdropFilter:"var(--blurFilter)"}},onClose:c(!1),children:Object(p.jsx)($.a,{sx:{width:a},role:"presentation",onKeyDown:c(!1),children:n})})]})},Pr=n(379),Er=n(366),Hr=Object(k.a)(wr||(wr=Object(w.a)(["\nsubscription MyQuery($_eq: Int!, $limit: Int) {\n  erp_Notifications(where: {MentionedUser: {_eq: $_eq}}, limit: $limit, order_by: {ID: desc} ) {\n    ID\n    Viewed\n    Comment {\n      CommentID\n      Text\n      Timestamp\n      User {\n        UserID\n        FirstName\n        LastName\n      }\n    }\n    Order {\n      OrderID\n      City\n      Entity\n    }\n  }\n}\n"]))),Rr=Object(k.a)(kr||(kr=Object(w.a)(["\nmutation($ID: Int!, $Viewed: Boolean!) {\n  update_erp_Notifications_by_pk(pk_columns: {ID: $ID}, _set: {Viewed: $Viewed}){\n    ID\n    Viewed\n  }\n}\n"]))),qr=n(78),Br=n.n(qr),Yr=function(e){var t=Object(c.useContext)(ba).store,n=Object(c.useState)(),r=Object(u.a)(n,2),a=r[0],i=r[1],s=Object(C.useMutation)(Rr),o=Object(u.a)(s,1)[0];var d=Object(C.useSubscription)(Hr,{onSubscriptionData:function(e){var t=e.subscriptionData.data.erp_Notifications;i({unviewed:t.filter((function(e){return!e.Viewed})),viewed:t.filter((function(e){return e.Viewed}))})},variables:{_eq:t.user.UserID,limit:100}}),l=d.data,m=d.loading,b=Object(c.useState)(!1),j=Object(u.a)(b,2),O=j[0],h=j[1];var f=function(e){return Object(p.jsxs)($.a,{className:Br.a.notificationUnit,children:[Object(p.jsxs)("div",{className:Br.a.notificationHeader,children:[Object(p.jsxs)(he.a,{className:Br.a.item1,children:[e.Comment.User.FirstName," ",e.Comment.User.LastName," ",Object(p.jsx)("span",{className:Br.a.normal,children:"\u0443\u043f\u043e\u043c\u044f\u043d\u0443\u043b \u0432\u0430\u0441"})]}),Object(p.jsx)(he.a,{variant:"subtitle2",className:Br.a.item2,children:R()(e.Comment.Timestamp).format("DD MMM H:mm")}),Object(p.jsx)(E.b,{to:"/orders/".concat(e.Order.OrderID),onClick:function(){return t=e.ID,h(!1),void o({variables:{ID:t,Viewed:!0}});var t},className:Br.a.item3,children:Object(p.jsxs)(he.a,{variant:"subtitle2",children:[e.Order.Entity,"__",e.Order.City]})})]}),Object(p.jsx)("div",{className:Br.a.commentContent,dangerouslySetInnerHTML:{__html:e.Comment.Text}})]},e.ID)};return Object(p.jsx)(Ur,{icon:Object(p.jsx)(Pr.a,{badgeContent:function(){var e,t=0;return null===l||void 0===l||null===(e=l.erp_Notifications)||void 0===e||e.forEach((function(e){e.Viewed||(t+=1)})),t}(),color:"secondary",children:Object(p.jsx)(Er.a,{})}),width:500,state:O,toggleDrawer:function(e){return function(t){h(e)}},children:Object(p.jsxs)($.a,{className:Br.a.wrapper,children:[Object(p.jsx)(he.a,{variant:"subtitle3",children:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),(null===a||void 0===a?void 0:a.unviewed.length)?Object(p.jsxs)($.a,{className:Br.a.unreadedWrapper,children:[Object(p.jsx)(he.a,{variant:"subtitle3",children:"\u041d\u0435\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u043d\u044b\u0435 "}),!m&&(null===a||void 0===a?void 0:a.unviewed.map((function(e){return f(e)})))]}):null,!m&&(null===a||void 0===a?void 0:a.viewed.map((function(e){return f(e)})))]})})},Wr=(n(387),n(377),n(367),n(368),n(369),n(386));n(400),n(138),Object(L.a)(Wr.a)((function(e){e.theme;return{"& .MuiToggleButtonGroup-grouped":{border:"var(--border)",padding:8,textTransform:"none","&:not(:first-of-type)":{},"&:first-of-type":{borderTopLeftRadius:"var(--br)",borderBottomLeftRadius:"var(--br)"},"&:last-of-type":{borderTopRightRadius:"var(--br)",borderBottomRightRadius:"var(--br)"}}}}));var zr=function(){function e(e){return Object(p.jsx)("div",{className:"iconWrapper",children:e})}return Object(p.jsxs)("div",{className:"Sidebar",children:[Object(p.jsx)(E.c,{exact:!0,to:"/",activeClassName:"sidebar-active",className:"link",children:e(Object(p.jsx)(Fr.a,{}))}),Object(p.jsx)(E.c,{to:"/reclamation",activeClassName:"sidebar-active",className:"link",children:e(Object(p.jsx)(Jn.a,{}))}),Object(p.jsx)(E.c,{to:"/attendance",activeClassName:"sidebar-active",className:"link",children:e(Object(p.jsx)(Nr.a,{}))}),Object(p.jsx)("div",{className:"link marginTopAuto",children:e(Object(p.jsx)(Yr,{}))}),Object(p.jsxs)(E.c,{to:"/settings",activeClassName:"sidebar-active",className:"link",children:[" ",e(Object(p.jsx)($r.a,{}))]})]})},Vr=n(158),Qr=n(380);var Kr=Object(l.a)((function(){var e=Object(c.useContext)(ba).store,t=Object(c.useState)((function(){return function(e){var t="; ".concat(document.cookie).split("; ".concat(e,"="));return 2===t.length?t.pop().split(";").shift():"light"}("theme")})),n=Object(u.a)(t,2),r=n[0],a=n[1];e.setUItheme(r,a);var i=sr(r,a).mode,s=Object(c.useMemo)((function(){return Object(Vr.a)(function(e){return{palette:Object(d.a)({mode:e},"light"===e?{primary:{main:"#3763FE",light:"#E7E9FB"},secondary:{main:"#e5534b"}}:{primary:{main:"#99affc",light:"#43435c"},secondary:{main:"#e5534b"}}),typography:{fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',sans-serif",subtitle1:{fontSize:".7rem",textTransform:"uppercase",fontWeight:600,letterSpacing:".5px",color:"var(--accent) !important"},subtitle2:{fontWeight:600,textTransform:"uppercase",fontSize:".65rem"},subtitle3:{fontSize:".7rem",color:"var(--lowContrast) !important",textTransform:"uppercase"}}}}(i))}),[i]);return s=Object(Vr.a)(s,function(e){return{components:{MuiDialog:{styleOverrides:{paper:{background:"var(--LI) !important",borderRadius:"var(--br) !important",border:"var(--border)"}}},MuiDialogTitle:{styleOverrides:{root:{color:e.palette.text.primary,background:"var(--L2)",borderBottom:"var(--border)",padding:"11px 1rem",fontSize:".9rem"}}},MuiDialogContent:{styleOverrides:{root:{background:"var(--L1)",padding:"1rem 1rem .5rem !important"}}},MuiDialogActions:{styleOverrides:{root:{background:"var(--L2)",borderTop:"var(--border)",padding:"5px 1rem !important"}}},MuiMenu:{styleOverrides:{paper:{border:"var(--border)",boxShadow:"0 10px 50px 0 var(--shadow-color) !important",borderRadius:"var(--br)"}}},MuiMenuItem:{styleOverrides:{root:{fontSize:".8rem",padding:"4px 15px !important"}},defaultProps:{disableRipple:!0}},MuiListItemText:{styleOverrides:{primary:{fontSize:".8rem"}}},MuiListItemIcon:{styleOverrides:{root:{minWidth:"25px !important",svg:{width:"17px"}}}},MuiButton:{styleOverrides:{root:{fontSize:".8rem",textTransform:"none !important",borderRadius:"var(--br10)"},textInfo:{color:"var(--lowContrast) !important"},iconic:{minWidth:"10px",minHeight:"10px",padding:"4px 6px",svg:{width:20},path:{color:e.palette.text.secondary,strokeWidth:.2,stroke:"var(--L0)"},"&:hover":{background:"var(--accentLight)"}}},defaultProps:{disableElevation:!0,disableRipple:!0}},MuiToggleButton:{defaultProps:{disableRipple:!0}},MuiTextField:{defaultProps:{variant:"standard",autoComplete:"off"}},MuiAutocomplete:{styleOverrides:{root:{borderRadius:"var(--br) !important"},paper:{background:"var(--L0) !important",fontSize:"13px"}}},MuiInputLabel:{styleOverrides:{root:{color:"var(--lowContrast) !important"},filter:{fontSize:".8rem",transform:"none",position:"relative"}},defaultProps:{shrink:!0}},MuiFilledInput:{defaultProps:{disableUnderline:"true",size:"small"},styleOverrides:{root:{background:"var(--L1)",border:"1px solid var(--border-colorLight)",borderRadius:"10px",":hover":{background:"var(--L1)"}}}},MuiInput:{defaultProps:{disableUnderline:"true"}},MuiInputBase:{styleOverrides:{root:{color:"var(--highContrast) !important"}}},MuiOutlinedInput:{styleOverrides:{notchedOutline:{border:"none"}}},MuiPopover:{styleOverrides:{paper:{background:"var(--L0)",borderRadius:"var(--br) !important"}}},MuiSelect:{styleOverrides:{select:{fontSize:".8rem",boxSizing:"border-box",border:"none !important",outline:"none !important",boxShadow:"none !important",padding:0}}},MuiTab:{defaultProps:{disableRipple:!0}},MuiCheckbox:{defaultProps:{disableRipple:!0}},MuiDrawer:{styleOverrides:{paper:{background:"var(--L0-glass)"}}}}}}(s)),Object(p.jsx)(Qr.a,{theme:s,children:Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)(Vn.a,{className:"reactTooltips",delayShow:300}),Object(p.jsx)(v.ReactNotifications,{}),e.inMemoryToken&&Object(p.jsx)(zr,{}),Object(p.jsx)(Ar,{})]})})})),Gr=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,401)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))},Jr=n(42),Zr=function(){function e(){Object(we.a)(this,e)}return Object(Bt.a)(e,null,[{key:"login",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qt.post("/login",{email:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qt.post("/logout"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Xr=function(){function e(){Object(we.a)(this,e),this.user={},this.isLoading=!1,this.UItheme={state:null,dispatch:null},this.inMemoryToken=void 0,this.selectedTab=1,this.cachedOrders=[],this.cachedPreOrders=[],this.orderListLastSearckKeyword="",this.pageParams=[{url:"/reclamation",icon:Object(p.jsx)(Jn.a,{}),title:"\u0420\u0435\u043a\u043b\u0430\u043c\u0430\u0446\u0438\u044f"},{url:"/attendance",icon:Object(p.jsx)(Nr.a,{}),title:"\u0420\u0430\u0431\u043e\u0447\u0435\u0435 \u0432\u0440\u0435\u043c\u044f"}],Object(Jr.d)(this)}return Object(Bt.a)(e,[{key:"setAuth",value:function(e){this.isAuth=e}},{key:"setUser",value:function(e){this.user=e}},{key:"setLoading",value:function(e){this.isLoading=e}},{key:"setInMemoryToken",value:function(e){this.inMemoryToken=e}},{key:"setCachedOrders",value:function(e){this.cachedOrders=e}},{key:"setCachedPreOrders",value:function(e){this.cachedPreOrders=e}},{key:"setUItheme",value:function(e,t){this.UItheme={state:e,dispatch:t}}},{key:"login",value:function(){var e=Object(i.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Zr.login(t,n);case 3:if(200!==(r=e.sent).status){e.next=8;break}return this.setInMemoryToken(r.data.accessToken),this.setUser(r.data.user),e.abrupt("return",r);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Zr.logout();case 3:this.setInMemoryToken(null),this.setUser({}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(null===(t=e.t0.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNewToken",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wt.a.get("".concat(zt,"/refresh"),{withCredentials:!0}).then((function(e){return 200!==e.status&&new Error("Invalid response while trying to get new access token"),t.setInMemoryToken(e.data.accessToken),e.data.accessToken}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"checkAuth",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setLoading(!0),e.prev=1,e.next=4,Wt.a.get("".concat(zt,"/refresh"),{withCredentials:!0}).then((function(e){200===e.status&&(t.setUser(e.data.user),t.setInMemoryToken(e.data.accessToken))}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:return e.prev=9,this.setLoading(!1),e.abrupt("return",this.inMemoryToken);case 13:case"end":return e.stop()}}),e,this,[[1,6,9,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"getPageParams",value:function(e){return this.pageParams.find((function(t){return t.url===e}))}}]),e}(),ea=(n(277),n(278),n(7)),ta=n(134),na=n(195),ra=new(n(201).a)({delay:{initial:300,max:1/0,jitter:!0},attempts:{max:100,retryIf:function(e,t){return!!e}}}),aa=Object(ta.a)((function(e){var t=e.graphQLErrors,n=e.networkError;e.operation,e.forward;n&&console.log("[Network error]: ",n),t&&t.forEach((function(e){var t=e.message,n=e.locations,r=e.path;return console.log("[GraphQL error]: Message: ".concat(t,", Location: ").concat(n,", Path: ").concat(r))}))})),ia=new na.a({uri:"wss://hasura.piek.ru/v1/graphql",options:{reconnect:!0,lazy:!0,connectionParams:function(){return{headers:{authorization:"Bearer ".concat(pa())}}}}});ia.subscriptionClient.onReconnecting((function(){ja().then((function(e){!function(e){ia.subscriptionClient.connectionParams.headers={authorization:"Bearer ".concat(e)},ia.subscriptionClient.close(!0),ia.subscriptionClient.connect()}(e),console.log("Reiniting websocket connection, probably, because jwt token was expired")}))}));var ca=n(197),sa=Object(ta.a)((function(e){e.graphQLErrors,e.networkError;var t=e.operation,n=e.forward;return new C.Observable((function(e){ja().then((function(e){t.setContext((function(t){var n=t.headers,r=void 0===n?{}:n;return{headers:Object(d.a)(Object(d.a)({},r),{},{Authorization:"Bearer ".concat(e)||!1})}}))})).then((function(){var r={next:e.next.bind(e),error:e.error.bind(e),complete:e.complete.bind(e)};n(t).subscribe(r)})).catch((function(t){e.error(t)}))}))})),oa=Object(ca.a)((function(e,t){var n=t.headers;return{headers:Object(d.a)(Object(d.a)({},n),{},{Authorization:pa()?"Bearer ".concat(pa()):""})}})),da=new C.HttpLink({uri:"https://hasura.piek.ru/v1/graphql"}),ua=Object(C.split)((function(e){var t=e.query,n=Object(ea.q)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),Object(C.from)([ra,aa,ia]),Object(C.from)([sa,oa,da])),la=new C.ApolloClient({link:ua,cache:new C.InMemoryCache({typePolicies:{erp_Orders:{keyFields:["OrderID"]},erp_CheckListUnits:{keyFields:["CheckListUnitID"]},erp_Comments:{keyFields:["CommentID"]}}})}),ma=new Xr,ba=Object(c.createContext)({store:ma});function pa(){return ma.inMemoryToken}function ja(){return Oa.apply(this,arguments)}function Oa(){return(Oa=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ma.getNewToken();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ha=document.getElementById("root");o.a.render(Object(p.jsx)(C.ApolloProvider,{client:la,children:Object(p.jsx)(E.a,{children:Object(p.jsx)(Kr,{sessionData:ha.dataset.session,children:Object(p.jsx)(ba.Provider,{value:ma})})})}),ha),Gr()},36:function(e,t,n){e.exports={commentsListWrapper:"Comments_commentsListWrapper___fcsl",commentListThread:"Comments_commentListThread__ozjGX",commentInputForm:"Comments_commentInputForm__3qC1P",checklistUnit:"Comments_checklistUnit__3VLqy",checklistUnit_complited:"Comments_checklistUnit_complited__UDryM",mentionedUserHiglight:"Comments_mentionedUserHiglight__AMXFd",saveButton:"Comments_saveButton__GUyFK",commentUnit:"Comments_commentUnit__2eN-_",actions:"Comments_actions__2WDkW",commentContent:"Comments_commentContent__2OMBI",commentHeader:"Comments_commentHeader__3WbIm",sender:"Comments_sender__30aSP",time:"Comments_time__H8FXy"}},43:function(e,t,n){e.exports={tableRow:"main_tableRow__34eUf",table:"main_table__1Lnqg",tbody:"main_tbody__3DmaN",thead:"main_thead__1lihm",tr:"main_tr__yR31n",td:"main_td__36uim",th:"main_th__1f9Q3",tableWrapper:"main_tableWrapper__2q39A",tableFooter:"main_tableFooter__3GsWH",tableMain:"main_tableMain__1OLyv",awaitingDispatch:"main_awaitingDispatch__3bf2F",needAttention:"main_needAttention__39jvV",unpaidOrder:"main_unpaidOrder__2WrWl",customerTableInfo:"main_customerTableInfo__hxkEZ"}},64:function(e,t,n){e.exports={reclatationLayout:"ReclamationPage_reclatationLayout__2EuZy",columnWrapper:"ReclamationPage_columnWrapper__tE0Iu",reclColumn:"ReclamationPage_reclColumn__1e4nR",draggableWrapper:"ReclamationPage_draggableWrapper__3wM-n",heading:"ReclamationPage_heading__SzCEM",item:"ReclamationPage_item__di9JO",orderItem:"ReclamationPage_orderItem__2r6K-",customerInfo:"ReclamationPage_customerInfo__1muzb",needAttention:"ReclamationPage_needAttention__1dYOo",awaitingDispatch:"ReclamationPage_awaitingDispatch__2ncPB"}},69:function(e,t,n){e.exports={sectionHead:"docs_sectionHead__oPl0G",expandBtn:"docs_expandBtn__okpby",docsItemOnUpload:"docs_docsItemOnUpload__2T2t4",docsItem:"docs_docsItem__31c5u",svg:"docs_svg__1W2uj",name:"docs_name__10m-T",date:"docs_date__1LDzY",deleteBtn:"docs_deleteBtn__CcMjo"}},78:function(e,t,n){e.exports={wrapper:"NotificationCenter_wrapper__2ZNFd",notificationUnit:"NotificationCenter_notificationUnit__Wu0MX",unreadedWrapper:"NotificationCenter_unreadedWrapper__GTWeM",notificationHeader:"NotificationCenter_notificationHeader__1deII",item1:"NotificationCenter_item1__3mfID",normal:"NotificationCenter_normal__19zme",item3:"NotificationCenter_item3__gCbUg",item2:"NotificationCenter_item2__2wKoS",commentContent:"NotificationCenter_commentContent__1bz-4"}},85:function(e,t,n){e.exports={name:"composition_name__-v-ZG",quantity:"composition_quantity__EOCyz",unitName:"composition_unitName__1L5Ob",addOrderItem:"composition_addOrderItem__3cgdF",quantityInput:"composition_quantityInput__qHusO",Unit:"composition_Unit__3Sk0C",index:"composition_index__33I6t",fullName:"composition_fullName__2218_"}},90:function(e,t,n){e.exports={tableWrapper:"attendance_tableWrapper__2rE3D",attendanceTable:"attendance_attendanceTable__18B6I",interval:"attendance_interval__VjfAk",intervalred:"attendance_intervalred__TS5pn",intervalgrid:"attendance_intervalgrid__Yc4D0"}}},[[288,1,2]]]);
//# sourceMappingURL=main.25b90f4f.chunk.js.map